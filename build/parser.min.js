!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.FormulaParser=e():t.FormulaParser=e()}("undefined"!=typeof self?self:this,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=15)}([function(t,e,n){"use strict";function r(t){return t&&0===t.length}function o(t){return null==t?[]:Object.keys(t)}function i(t){for(var e=[],n=Object.keys(t),r=0;r<n.length;r++)e.push(t[n[r]]);return e}function a(t,e){for(var n=[],r=o(t),i=0;i<r.length;i++){var a=r[i];n.push(e.call(null,t[a],a))}return n}function c(t,e){for(var n=[],r=0;r<t.length;r++)n.push(e.call(null,t[r],r));return n}function s(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];Array.isArray(r)?e=e.concat(s(r)):e.push(r)}return e}function u(t){return r(t)?void 0:t[0]}function l(t){var e=t&&t.length;return e?t[e-1]:void 0}function f(t,e){if(Array.isArray(t))for(var n=0;n<t.length;n++)e.call(null,t[n],n);else{if(!L(t))throw Error("non exhaustive match");var r=o(t);for(n=0;n<r.length;n++){var i=r[n],a=t[i];e.call(null,a,i)}}}function h(t){return"string"==typeof t}function p(t){return void 0===t}function d(t){return t instanceof Function}function m(t,e){return void 0===e&&(e=1),t.slice(e,t.length)}function E(t,e){return void 0===e&&(e=1),t.slice(0,t.length-e)}function g(t,e){var n=[];if(Array.isArray(t))for(var r=0;r<t.length;r++){var o=t[r];e.call(null,o)&&n.push(o)}return n}function N(t,e){return g(t,(function(t){return!e(t)}))}function v(t,e){for(var n=Object.keys(t),r={},o=0;o<n.length;o++){var i=n[o],a=t[i];e(a)&&(r[i]=a)}return r}function O(t,e){return!!L(t)&&t.hasOwnProperty(e)}function R(t,e){return void 0!==T(t,(function(t){return t===e}))}function A(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n]);return e}function y(t){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function T(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(e.call(null,r))return r}}function M(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];e.call(null,o)&&n.push(o)}return n}function b(t,e,n){for(var r=Array.isArray(t),a=r?t:i(t),c=r?[]:o(t),s=n,u=0;u<a.length;u++)s=e.call(null,s,a[u],r?u:c[u]);return s}function I(t){return N(t,(function(t){return null==t}))}function C(t,e){void 0===e&&(e=function(t){return t});var n=[];return b(t,(function(t,r){var o=e(r);return R(n,o)?t:(n.push(o),t.concat(r))}),[])}function S(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=[null],o=r.concat(e);return Function.bind.apply(t,o)}function w(t){return Array.isArray(t)}function U(t){return t instanceof RegExp}function L(t){return t instanceof Object}function _(t,e){for(var n=0;n<t.length;n++)if(!e(t[n],n))return!1;return!0}function x(t,e){return N(t,(function(t){return R(e,t)}))}function k(t,e){for(var n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function P(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}function j(t,e){var n=A(t);return n.sort((function(t,n){return e(t)-e(n)})),n}function B(t,e){if(t.length!==e.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<t.length;r++)n[t[r]]=e[r];return n}function F(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++)for(var i=e[r],a=o(i),c=0;c<a.length;c++){var s=a[c];t[s]=i[s]}return t}function D(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0;r<e.length;r++){var i=e[r];if(!p(i))for(var a=o(i),c=0;c<a.length;c++){var s=a[c];O(t,s)||(t[s]=i[s])}}return t}function V(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return D.apply(null,[{}].concat(t))}function G(t,e){var n={};return f(t,(function(t){var r=e(t),o=n[r];o?o.push(t):n[r]=[t]})),n}function H(t,e){for(var n=y(t),r=o(e),i=0;i<r.length;i++){var a=r[i],c=e[a];n[a]=c}return n}function K(){}function Y(t){return t}function W(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];e.push(void 0!==r?r:void 0)}return e}function $(t){console&&console.error&&console.error("Error: "+t)}function q(t){console&&console.warn&&console.warn("Warning: "+t)}function X(){return"function"==typeof Map}function z(t,e){e.forEach((function(e){var n=e.prototype;Object.getOwnPropertyNames(n).forEach((function(r){if("constructor"!==r){var o=Object.getOwnPropertyDescriptor(n,r);o&&(o.get||o.set)?Object.defineProperty(t.prototype,r,o):t.prototype[r]=e.prototype[r]}}))}))}function Q(t){function e(){}e.prototype=t;var n=new e;function r(){return typeof n.bar}return r(),r(),t}function Z(t){return t[t.length-1]}function J(t){var e=(new Date).getTime(),n=t();return{time:(new Date).getTime()-e,value:n}}n.d(e,"A",(function(){return r})),n.d(e,"G",(function(){return o})),n.d(e,"U",(function(){return i})),n.d(e,"J",(function(){return a})),n.d(e,"I",(function(){return c})),n.d(e,"t",(function(){return s})),n.d(e,"s",(function(){return u})),n.d(e,"H",(function(){return l})),n.d(e,"u",(function(){return f})),n.d(e,"E",(function(){return h})),n.d(e,"F",(function(){return p})),n.d(e,"B",(function(){return d})),n.d(e,"m",(function(){return m})),n.d(e,"n",(function(){return E})),n.d(e,"p",(function(){return g})),n.d(e,"P",(function(){return N})),n.d(e,"N",(function(){return v})),n.d(e,"w",(function(){return O})),n.d(e,"j",(function(){return R})),n.d(e,"g",(function(){return A})),n.d(e,"h",(function(){return y})),n.d(e,"q",(function(){return T})),n.d(e,"r",(function(){return M})),n.d(e,"O",(function(){return b})),n.d(e,"i",(function(){return I})),n.d(e,"T",(function(){return C})),n.d(e,"y",(function(){return w})),n.d(e,"D",(function(){return U})),n.d(e,"C",(function(){return L})),n.d(e,"o",(function(){return _})),n.d(e,"l",(function(){return x})),n.d(e,"Q",(function(){return k})),n.d(e,"x",(function(){return P})),n.d(e,"f",(function(){return F})),n.d(e,"k",(function(){return V})),n.d(e,"v",(function(){return G})),n.d(e,"K",(function(){return H})),n.d(e,"b",(function(){return K})),n.d(e,"a",(function(){return Y})),n.d(e,"L",(function(){return W})),n.d(e,"c",(function(){return $})),n.d(e,"d",(function(){return q})),n.d(e,"z",(function(){return X})),n.d(e,"e",(function(){return z})),n.d(e,"S",(function(){return Q})),n.d(e,"M",(function(){return Z})),n.d(e,"R",(function(){return J}))},function(t,e){class n{constructor(t,e){if(null==e&&n.errorMap.has(t))return n.errorMap.get(t);null==e?(this._error=t,n.errorMap.set(t,this)):(this._error=t,this._msg=e)}get message(){return this._msg}set message(t){this._msg=t}get error(){return this._error}equals(t){return t instanceof n&&t._error===this._error}toString(){return this._error}}n.errorMap=new Map,n.DIV0=new n("#DIV/0!"),n.NA=new n("#N/A"),n.NAME=new n("#NAME?"),n.NULL=new n("#NULL!"),n.NUM=new n("#NUM!"),n.REF=new n("#REF!"),n.VALUE=new n("#VALUE!"),n.NOT_IMPLEMENTED=t=>new Error(`Function ${t} is not implemented.`),n.TOO_MANY_ARGS=t=>new Error(`Function ${t} has too many arguments.`),n.ARG_MISSING=t=>new Error(`Argument type ${t.join(", ")} is missing.`),t.exports=n},function(t,e,n){const r=n(1),o=n(5),i={NUMBER:0,ARRAY:1,BOOLEAN:2,STRING:3,RANGE_REF:4,CELL_REF:5,COLLECTIONS:6,NUMBER_NO_BOOLEAN:10},a={};Object.keys(i).forEach(t=>{a[i[t]]=t});const c=new class{constructor(){this.Types=i,this.type2Number={number:i.NUMBER,boolean:i.BOOLEAN,string:i.STRING,object:-1}}checkFunctionResult(t){if("number"===typeof t){if(isNaN(t))return r.VALUE;if(!isFinite(t))return r.NUM}return null==t?r.NULL:t}flattenDeep(t){return t.reduce((t,e)=>Array.isArray(e)?t.concat(this.flattenDeep(e)):t.concat(e),[])}acceptNumber(t,e=!0,n=!0){if(t instanceof r)return t;let o;if("number"==typeof t)o=t;else if("boolean"==typeof t){if(!n)throw r.VALUE;o=Number(t)}else if("string"==typeof t){if(0===t.length)throw r.VALUE;if(o=Number(t),o!=o)throw r.VALUE}else{if(!Array.isArray(t))throw Error("Unknown type in FormulaHelpers.acceptNumber");if(e)o=this.acceptNumber(t[0][0]);else{if(1!==t[0].length)throw r.VALUE;o=this.acceptNumber(t[0][0])}}return o}flattenParams(t,e,n,a,c=null,s=1){if(t.length<s)throw r.ARG_MISSING([e]);null==c&&(c=e===i.NUMBER?0:null==e?null:""),t.forEach(t=>{const{isCellRef:i,isRangeRef:s,isArray:u}=t,l=t.value instanceof o,f=!(i||s||u||l),h={isLiteral:f,isCellRef:i,isRangeRef:s,isArray:u,isUnion:l};if(f)t=t.omitted?c:this.accept(t,e,c),a(t,h);else if(i)a(t.value,h);else if(l){if(!n)throw r.VALUE;t=t.value.data,(t=this.flattenDeep(t)).forEach(t=>{a(t,h)})}else(s||u)&&(t=this.flattenDeep(t.value)).forEach(t=>{a(t,h)})})}accept(t,e=null,n,a=!0,c=!1){if(Array.isArray(e)&&(e=e[0]),null==t&&void 0===n)throw r.ARG_MISSING([e]);if(null==t)return n;if("object"!=typeof t||Array.isArray(t))return t;const s=t.isArray;if(null!=t.value&&(t=t.value),null==e)return t;if(t instanceof r)throw t;if(e===i.ARRAY){if(Array.isArray(t))return a?this.flattenDeep(t):t;if(t instanceof o)throw r.VALUE;if(c)return a?[t]:[[t]];throw r.VALUE}if(e===i.COLLECTIONS)return t;s&&(t=t[0][0]);const u=this.type(t);if(e===i.STRING)t=u===i.BOOLEAN?t?"TRUE":"FALSE":`${t}`;else if(e===i.BOOLEAN){if(u===i.STRING)throw r.VALUE;u===i.NUMBER&&(t=Boolean(t))}else if(e===i.NUMBER)t=this.acceptNumber(t,!1);else{if(e!==i.NUMBER_NO_BOOLEAN)throw r.VALUE;t=this.acceptNumber(t,!1,!1)}return t}type(t){let e=this.type2Number[typeof t];return-1===e&&(Array.isArray(t)?e=i.ARRAY:t.ref?e=t.ref.from?i.RANGE_REF:i.CELL_REF:t instanceof o&&(e=i.COLLECTIONS)),e}isRangeRef(t){return t.ref&&t.ref.from}isCellRef(t){return t.ref&&!t.ref.from}retrieveRanges(t,e,n){return n=l.extend(e,n),e=this.retrieveArg(t,e),n!==(e=c.accept(e,i.ARRAY,void 0,!1,!0))?(n=this.retrieveArg(t,n),n=c.accept(n,i.ARRAY,void 0,!1,!0)):n=e,[e,n]}retrieveArg(t,e){if(null===e)return{value:0,isArray:!1,omitted:!0};const n=t.utils.extractRefValue(e);return{value:n.val,isArray:n.isArray,ref:e.ref}}},s={isWildCard:t=>"string"==typeof t&&/[*?]/.test(t),toRegex:(t,e)=>RegExp(t.replace(/[.+^${}()|[\]\\]/g,"\\$&").replace(/([^~]??)[?]/g,"$1.").replace(/([^~]??)[*]/g,"$1.*").replace(/~([?*])/g,"$1"),e)},u={parse:t=>{const e=typeof t;if("string"===e){const e=t.toUpperCase();if("TRUE"===e||"FALSE"===e)return{op:"=",value:"TRUE"===e};const n=t.match(/(<>|>=|<=|>|<|=)(.*)/);if(n){let t,e=n[1];if(isNaN(n[2])){const o=n[2].toUpperCase();if("TRUE"===o||"FALSE"===o)t="TRUE"===o;else if(/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A|#REF!/.test(n[2]))t=new r(n[2]);else if(t=n[2],s.isWildCard(t))return{op:"wc",value:s.toRegex(t),match:"="===e}}else t=Number(n[2]);return{op:e,value:t}}return s.isWildCard(t)?{op:"wc",value:s.toRegex(t),match:!0}:{op:"=",value:t}}if("boolean"===e||"number"===e||Array.isArray(t)||t instanceof r)return{op:"=",value:t};throw Error(`Criteria.parse: type ${typeof t} not support`)}},l={columnNumberToName:t=>{let e=t,n="",r=0;for(;e>0;)r=(e-1)%26,n=String.fromCharCode("A".charCodeAt(0)+r)+n,e=Math.floor((e-r)/26);return n},columnNameToNumber:t=>{const e=(t=t.toUpperCase()).length;let n=0;for(let r=0;r<e;r++){const o=t.charCodeAt(r);isNaN(o)||(n+=(o-64)*26**(e-r-1))}return n},extend:(t,e)=>{if(null==e)return t;let n,r;if(c.isCellRef(t))n=0,r=0;else{if(!c.isRangeRef(t))throw Error("Address.extend should not reach here.");n=t.ref.to.row-t.ref.from.row,r=t.ref.to.col-t.ref.from.col}return c.isCellRef(e)?(n>0||r>0)&&(e={ref:{from:{col:e.ref.col,row:e.ref.row},to:{row:e.ref.row+n,col:e.ref.col+r}}}):(e.ref.to.row=e.ref.from.row+n,e.ref.to.col=e.ref.from.col+r),e}};t.exports={FormulaHelpers:c,Types:i,ReversedTypes:a,Factorials:[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142],WildCard:s,Criteria:u,Address:l}},function(t,e,n){var r,o,i;"undefined"!=typeof self&&self,o=[],void 0===(i="function"==typeof(r=function(){function t(){}t.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},t.prototype.restoreState=function(t){this.idx=t.idx,this.input=t.input,this.groupIdx=t.groupIdx},t.prototype.pattern=function(t){this.idx=0,this.input=t,this.groupIdx=0,this.consumeChar("/");var e=this.disjunction();this.consumeChar("/");for(var n={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":c(n,"global");break;case"i":c(n,"ignoreCase");break;case"m":c(n,"multiLine");break;case"u":c(n,"unicode");break;case"y":c(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:e}},t.prototype.disjunction=function(){var t=[];for(t.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),t.push(this.alternative());return{type:"Disjunction",value:t}},t.prototype.alternative=function(){for(var t=[];this.isTerm();)t.push(this.term());return{type:"Alternative",value:t}},t.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},t.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var t;switch(this.consumeChar("?"),this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead"}s(t);var e=this.disjunction();return this.consumeChar(")"),{type:t,value:e}}!function(){throw Error("Internal Error - Should never get here!")}()},t.prototype.quantifier=function(t){var e;switch(this.popChar()){case"*":e={atLeast:0,atMost:1/0};break;case"+":e={atLeast:1,atMost:1/0};break;case"?":e={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":e={atLeast:n,atMost:n};break;case",":e=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===t&&void 0===e)return;s(e)}if(!0!==t||void 0!==e)return s(e),"?"===this.peekChar(0)?(this.consumeChar("?"),e.greedy=!1):e.greedy=!0,e.type="Quantifier",e},t.prototype.atom=function(){var t;switch(this.peekChar()){case".":t=this.dotAll();break;case"\\":t=this.atomEscape();break;case"[":t=this.characterClass();break;case"(":t=this.group()}return void 0===t&&this.isPatternCharacter()&&(t=this.patternCharacter()),s(t),this.isQuantifier()&&(t.quantifier=this.quantifier()),t},t.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i("\n"),i("\r"),i("\u2028"),i("\u2029")]}},t.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},t.prototype.characterClassEscape=function(){var t,e=!1;switch(this.popChar()){case"d":t=u;break;case"D":t=u,e=!0;break;case"s":t=f;break;case"S":t=f,e=!0;break;case"w":t=l;break;case"W":t=l,e=!0}return s(t),{type:"Set",value:t,complement:e}},t.prototype.controlEscapeAtom=function(){var t;switch(this.popChar()){case"f":t=i("\f");break;case"n":t=i("\n");break;case"r":t=i("\r");break;case"t":t=i("\t");break;case"v":t=i("\v")}return s(t),{type:"Character",value:t}},t.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var t=this.popChar();if(!1===/[a-zA-Z]/.test(t))throw Error("Invalid ");return{type:"Character",value:t.toUpperCase().charCodeAt(0)-64}},t.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},t.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},t.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},t.prototype.identityEscapeAtom=function(){return{type:"Character",value:i(this.popChar())}},t.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:i(this.popChar())}}},t.prototype.characterClass=function(){var t=[],e=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),e=!0);this.isClassAtom();){var n=this.classAtom();if("Character"===n.type&&this.isRangeDash()){this.consumeChar("-");var r=this.classAtom();if("Character"===r.type){if(r.value<n.value)throw Error("Range out of order in character class");t.push({from:n.value,to:r.value})}else a(n.value,t),t.push(i("-")),a(r.value,t)}else a(n.value,t)}return this.consumeChar("]"),{type:"Set",complement:e,value:t}},t.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},t.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},t.prototype.group=function(){var t=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),t=!1;break;default:this.groupIdx++}var e=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:t,value:e};return t&&(n.idx=this.groupIdx),n},t.prototype.positiveInteger=function(){var t=this.popChar();if(!1===o.test(t))throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.integerIncludingZero=function(){var t=this.popChar();if(!1===r.test(t))throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)t+=this.popChar();return parseInt(t,10)},t.prototype.patternCharacter=function(){var t=this.popChar();switch(t){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(t)}}},t.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},t.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},t.prototype.isDigit=function(){return r.test(this.peekChar(0))},t.prototype.isClassAtom=function(t){switch(void 0===t&&(t=0),this.peekChar(t)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},t.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},t.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},t.prototype.isQuantifier=function(){var t=this.saveState();try{return void 0!==this.quantifier(!0)}catch(t){return!1}finally{this.restoreState(t)}},t.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},t.prototype.parseHexDigits=function(t){for(var e="",r=0;r<t;r++){var o=this.popChar();if(!1===n.test(o))throw Error("Expecting a HexDecimal digits");e+=o}return{type:"Character",value:parseInt(e,16)}},t.prototype.peekChar=function(t){return void 0===t&&(t=0),this.input[this.idx+t]},t.prototype.popChar=function(){var t=this.peekChar(0);return this.consumeChar(),t},t.prototype.consumeChar=function(t){if(void 0!==t&&this.input[this.idx]!==t)throw Error("Expected: '"+t+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var e,n=/[0-9a-fA-F]/,r=/[0-9]/,o=/[1-9]/;function i(t){return t.charCodeAt(0)}function a(t,e){void 0!==t.length?t.forEach((function(t){e.push(t)})):e.push(t)}function c(t,e){if(!0===t[e])throw"duplicate flag "+e;t[e]=!0}function s(t){if(void 0===t)throw Error("Internal Error - Should never get here!")}var u=[];for(e=i("0");e<=i("9");e++)u.push(e);var l=[i("_")].concat(u);for(e=i("a");e<=i("z");e++)l.push(e);for(e=i("A");e<=i("Z");e++)l.push(e);var f=[i(" "),i("\f"),i("\n"),i("\r"),i("\t"),i("\v"),i("\t"),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i("\u2028"),i("\u2029"),i(" "),i(" "),i("　"),i("\ufeff")];function h(){}return h.prototype.visitChildren=function(t){for(var e in t){var n=t[e];t.hasOwnProperty(e)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((function(t){this.visit(t)}),this))}},h.prototype.visit=function(t){switch(t.type){case"Pattern":this.visitPattern(t);break;case"Flags":this.visitFlags(t);break;case"Disjunction":this.visitDisjunction(t);break;case"Alternative":this.visitAlternative(t);break;case"StartAnchor":this.visitStartAnchor(t);break;case"EndAnchor":this.visitEndAnchor(t);break;case"WordBoundary":this.visitWordBoundary(t);break;case"NonWordBoundary":this.visitNonWordBoundary(t);break;case"Lookahead":this.visitLookahead(t);break;case"NegativeLookahead":this.visitNegativeLookahead(t);break;case"Character":this.visitCharacter(t);break;case"Set":this.visitSet(t);break;case"Group":this.visitGroup(t);break;case"GroupBackReference":this.visitGroupBackReference(t);break;case"Quantifier":this.visitQuantifier(t)}this.visitChildren(t)},h.prototype.visitPattern=function(t){},h.prototype.visitFlags=function(t){},h.prototype.visitDisjunction=function(t){},h.prototype.visitAlternative=function(t){},h.prototype.visitStartAnchor=function(t){},h.prototype.visitEndAnchor=function(t){},h.prototype.visitWordBoundary=function(t){},h.prototype.visitNonWordBoundary=function(t){},h.prototype.visitLookahead=function(t){},h.prototype.visitNegativeLookahead=function(t){},h.prototype.visitCharacter=function(t){},h.prototype.visitSet=function(t){},h.prototype.visitGroup=function(t){},h.prototype.visitGroupBackReference=function(t){},h.prototype.visitQuantifier=function(t){},{RegExpParser:t,BaseRegExpVisitor:h,VERSION:"0.4.0"}})?r.apply(e,o):r)||(t.exports=i)},function(t,e,n){const r=n(1),{FormulaHelpers:o}=n(2),i={unaryOp:(t,e,n)=>{let i=1;if(t.forEach(t=>{if("+"===t);else{if("-"!==t)throw new Error(`Unrecognized prefix: ${t}`);i=-i}}),null==e&&(e=0),1===i)return e;try{e=o.acceptNumber(e,n)}catch(t){if(!(t instanceof r))throw t;Array.isArray(e)&&(e=e[0][0])}return"number"==typeof e&&isNaN(e)?r.VALUE:-e}},a={percentOp:(t,e,n)=>{try{t=o.acceptNumber(t,n)}catch(t){if(t instanceof r)return t;throw t}if("%"===e)return t/100;throw new Error(`Unrecognized postfix: ${e}`)}},c={boolean:3,string:2,number:1},s={compareOp:(t,e,n,r,o)=>{null==t&&(t=0),null==n&&(n=0),r&&(t=t[0][0]),o&&(n=n[0][0]);const i=typeof t,a=typeof n;if(i===a)switch(e){case"=":return t===n;case">":return t>n;case"<":return t<n;case"<>":return t!==n;case"<=":return t<=n;case">=":return t>=n}else switch(e){case"=":return!1;case">":return c[i]>c[a];case"<":return c[i]<c[a];case"<>":return!0;case"<=":return c[i]<=c[a];case">=":return c[i]>=c[a]}throw Error("Infix.compareOp: Should not reach here.")},concatOp:(t,e,n,r,o)=>(null==t&&(t=""),null==n&&(n=""),r&&(t=t[0][0]),o&&(n=n[0][0]),"boolean"===typeof t&&(t=t?"TRUE":"FALSE"),"boolean"===typeof n&&(n=n?"TRUE":"FALSE"),""+t+n),mathOp:(t,e,n,i,a)=>{null==t&&(t=0),null==n&&(n=0);try{t=o.acceptNumber(t,i),n=o.acceptNumber(n,a)}catch(t){if(t instanceof r)return t;throw t}switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return 0===n?r.DIV0:t/n;case"^":return t**n}throw Error("Infix.mathOp: Should not reach here.")}};t.exports={Prefix:i,Postfix:a,Infix:s,Operators:{compareOp:["<",">","=","<>","<=",">="],concatOp:["&"],mathOp:["+","-","*","/","^"]}}},function(t,e){t.exports=class{constructor(t,e){if(null==t&&null==e)this._data=[],this._refs=[];else{if(t.length!==e.length)throw Error("Collection: data length should match references length.");this._data=t,this._refs=e}}get data(){return this._data}get refs(){return this._refs}get length(){return this._data.length}add(t,e){this._data.push(t),this._refs.push(e)}}},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,WildCard:a,Address:c}=n(2),s=n(5),u=o,l={ADDRESS:(t,e,n,o,a)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER,1),o=u.accept(o,i.BOOLEAN,!0),a=u.accept(a,i.STRING,""),t<1||e<1||n<1||n>4)throw r.VALUE;let s="";return a.length>0&&(/[^A-Za-z_.\d\u007F-\uFFFF]/.test(a)?s+=`'${a}'!`:s+=a+"!"),o?(s+=1===n||3===n?"$":"",s+=c.columnNumberToName(e),s+=1===n||2===n?"$":"",s+=t):(s+="R",s+=4===n||3===n?`[${t}]`:t,s+="C",s+=4===n||2===n?`[${e}]`:e),s},AREAS:t=>(t=u.accept(t))instanceof s?t.length:1,CHOOSE:(t,...e)=>{},COLUMN:(t,e)=>{if(null==e){if(null!=t.position.col)return t.position.col;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return e.ref.col;if(u.isRangeRef(e))return e.ref.from.col;throw Error("ReferenceFunctions.COLUMN should not reach here.")},COLUMNS:(t,e)=>{if(null==e)throw Error("COLUMNS requires one argument");if("object"!=typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return 1;if(u.isRangeRef(e))return Math.abs(e.ref.from.col-e.ref.to.col)+1;throw Error("ReferenceFunctions.COLUMNS should not reach here.")},HLOOKUP:(t,e,n,o)=>{t=u.accept(t);try{e=u.accept(e,i.ARRAY,void 0,!1)}catch(t){if(t instanceof r)throw r.NA;throw t}if(n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN,!0),n<1)throw r.VALUE;if(void 0===e[n-1])throw r.REF;const c=typeof t;if(o){let o=c===typeof e[0][0]?e[0][0]:null;for(let i=1;i<e[0].length;i++){const a=e[0][i];if(typeof a===c){if(o>t&&a>t)throw r.NA;if(a===t)return e[n-1][i];if(null!=o&&a>t&&o<=t)return e[n-1][i-1];o=a}}if(null==o)throw r.NA;return o}{let o=-1;if(o=a.isWildCard(t)?e[0].findIndex(e=>a.toRegex(t,"i").test(e)):e[0].findIndex(e=>e===t),-1===o)throw r.NA;return e[n-1][o]}},INDEX:(t,e,n,o,a)=>{n={value:(n=t.utils.extractRefValue(n)).val,isArray:n.isArray},n=u.accept(n,i.NUMBER),n=Math.trunc(n),null==o?o=1:(o={value:(o=t.utils.extractRefValue(o)).val,isArray:o.isArray},o=u.accept(o,i.NUMBER,1),o=Math.trunc(o)),null==a?a=1:(a={value:(a=t.utils.extractRefValue(a)).val,isArray:a.isArray},a=u.accept(a,i.NUMBER,1),a=Math.trunc(a));let c=e;if(e instanceof s)c=e.refs[a-1];else if(a>1)throw r.REF;if(0===n&&0===o)return c;if(0===n){if(u.isRangeRef(c)){if(c.ref.to.col-c.ref.from.col<o-1)throw r.REF;return c.ref.from.col+=o-1,c.ref.to.col=c.ref.from.col,c}if(Array.isArray(c)){const t=[];return c.forEach(e=>t.push([e[o-1]])),t}}if(0===o){if(u.isRangeRef(c)){if(c.ref.to.row-c.ref.from.row<n-1)throw r.REF;return c.ref.from.row+=n-1,c.ref.to.row=c.ref.from.row,c}if(Array.isArray(c))return c[o-1]}if(0!==n&&0!==o){if(u.isRangeRef(c)){if(c=c.ref,c.to.row-c.from.row<n-1||c.to.col-c.from.col<o-1)throw r.REF;return{ref:{row:c.from.row+n-1,col:c.from.col+o-1}}}if(u.isCellRef(c)){if(c=c.ref,n>1||o>1)throw r.REF;return{ref:{row:c.row+n-1,col:c.col+o-1}}}if(Array.isArray(c)){if(c.length<n||c[0].length<o)throw r.REF;return c[n-1][o-1]}}},MATCH:()=>{},ROW:(t,e)=>{if(null==e){if(null!=t.position.row)return t.position.row;throw Error("FormulaParser.parse is called without position parameter.")}if("object"!=typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return e.ref.row;if(u.isRangeRef(e))return e.ref.from.row;throw Error("ReferenceFunctions.ROW should not reach here.")},ROWS:(t,e)=>{if(null==e)throw Error("ROWS requires one argument");if("object"!=typeof e||Array.isArray(e))throw r.VALUE;if(u.isCellRef(e))return 1;if(u.isRangeRef(e))return Math.abs(e.ref.from.row-e.ref.to.row)+1;throw Error("ReferenceFunctions.ROWS should not reach here.")},TRANSPOSE:t=>{t=u.accept(t,i.ARRAY,void 0,!1);const e=[];for(let n=0;n<t[0].length;n++){e[n]=[];for(let r=0;r<t.length;r++)e[n][r]=t[r][n]}return e},VLOOKUP:(t,e,n,o)=>{t=u.accept(t);try{e=u.accept(e,i.ARRAY,void 0,!1)}catch(t){if(t instanceof r)throw r.NA;throw t}if(n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN,!0),n<1)throw r.VALUE;if(void 0===e[0][n-1])throw r.REF;const c=typeof t;if(o){let o=c===typeof e[0][0]?e[0][0]:null;for(let i=1;i<e.length;i++){const a=e[i],s=e[i][0];if(typeof s===c){if(o>t&&s>t)throw r.NA;if(s===t)return a[n-1];if(null!=o&&s>t&&o<=t)return e[i-1][n-1];o=s}}if(null==o)throw r.NA;return o}{let o=-1;if(o=a.isWildCard(t)?e.findIndex(e=>a.toRegex(t,"i").test(e[0])):e.findIndex(e=>e[0]===t),-1===o)throw r.NA;return e[o][n-1]}}};t.exports=l},function(t,e,n){const{createToken:r,Lexer:o}=n(8),i={},WhiteSpace=r({name:"WhiteSpace",pattern:/\s+/,group:o.SKIPPED}),String=r({name:"String",pattern:/"(""|[^"])*"/}),SingleQuotedString=r({name:"SingleQuotedString",pattern:/'(''|[^'])*'/}),SheetQuoted=r({name:"SheetQuoted",pattern:/'((?![\\\/\[\]*?:]).)+?'!/}),Function=r({name:"Function",pattern:/[A-Za-z_]+[A-Za-z_0-9.]*\(/}),ExcelRefFunction=r({name:"ExcelRefFunction",pattern:/(INDEX|OFFSET|INDIRECT)\(/i}),ExcelConditionalRefFunction=r({name:"ExcelConditionalRefFunction",pattern:/(IF|CHOOSE)\(/i}),FormulaErrorT=r({name:"FormulaErrorT",pattern:/#NULL!|#DIV\/0!|#VALUE!|#NAME\?|#NUM!|#N\/A/}),RefError=r({name:"RefError",pattern:/#REF!/}),Name=r({name:"Name",pattern:/[a-zA-Z_][a-zA-Z0-9_.?]*/}),Sheet=r({name:"Sheet",pattern:/[A-Za-z_.\d\u007F-\uFFFF]+!/}),Cell=r({name:"Cell",pattern:/[$]?[A-Za-z]{1,3}[$]?[1-9][0-9]*/,longer_alt:Name}),ReservedName=r({name:"ReservedName",pattern:/_xlnm\.[a-zA-Z_]+/}),Number=r({name:"Number",pattern:/[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?/}),Boolean=r({name:"Boolean",pattern:/TRUE|FALSE/i}),Column=r({name:"Column",pattern:/[$]?[A-Za-z]{1,3}/,longer_alt:Name}),At=r({name:"At",pattern:/@/}),Comma=r({name:"Comma",pattern:/,/}),Colon=r({name:"Colon",pattern:/:/}),Semicolon=r({name:"Semicolon",pattern:/;/}),OpenParen=r({name:"OpenParen",pattern:/\(/}),CloseParen=r({name:"CloseParen",pattern:/\)/}),OpenSquareParen=r({name:"OpenSquareParen",pattern:/\[/}),CloseSquareParen=r({name:"CloseSquareParen",pattern:/]/}),OpenCurlyParen=(r({name:"exclamationMark",pattern:/!/}),r({name:"OpenCurlyParen",pattern:/{/})),CloseCurlyParen=r({name:"CloseCurlyParen",pattern:/}/}),QuoteS=r({name:"QuoteS",pattern:/'/}),MulOp=r({name:"MulOp",pattern:/\*/}),PlusOp=r({name:"PlusOp",pattern:/\+/}),DivOp=r({name:"DivOp",pattern:/\//}),MinOp=r({name:"MinOp",pattern:/-/}),ConcatOp=r({name:"ConcatOp",pattern:/&/}),ExOp=r({name:"ExOp",pattern:/\^/}),PercentOp=r({name:"PercentOp",pattern:/%/}),GtOp=r({name:"GtOp",pattern:/>/}),EqOp=r({name:"EqOp",pattern:/=/}),LtOp=r({name:"LtOp",pattern:/</}),a=[WhiteSpace,String,SheetQuoted,SingleQuotedString,ExcelRefFunction,ExcelConditionalRefFunction,Function,FormulaErrorT,RefError,Sheet,Cell,Boolean,Column,Name,ReservedName,Number,At,Comma,Colon,Semicolon,OpenParen,CloseParen,OpenSquareParen,CloseSquareParen,OpenCurlyParen,CloseCurlyParen,QuoteS,MulOp,PlusOp,DivOp,MinOp,ConcatOp,ExOp,MulOp,PercentOp,r({name:"NeqOp",pattern:/<>/}),r({name:"GteOp",pattern:/>=/}),r({name:"LteOp",pattern:/<=/}),GtOp,EqOp,LtOp],c=new o(a,{ensureOptimizations:!0});a.forEach(t=>{i[t.name]=t}),t.exports={tokenVocabulary:i,lex:function(t){const e=c.tokenize(t);if(e.errors.length>0){const n=e.errors[0],r=n.line,o=n.column;let i="\n"+t.split("\n")[r-1]+"\n";throw i+=Array(o-1).fill(" ").join("")+"^\n",n.message=i+`Error at position ${r}:${o}\n`+n.message,Error(n.message)}return e}}},function(t,e,n){"use strict";n.r(e);var r=n(0),o=n(3),i={},a=new o.RegExpParser;function c(t){var e=t.toString();if(i.hasOwnProperty(e))return i[e];var n=a.pattern(e);return i[e]=n,n}var s,u=(s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),l='Unable to use "first char" lexer optimizations:\n';function f(t,e){void 0===e&&(e=!1);try{var n=c(t);return function t(e,n,o){switch(e.type){case"Disjunction":for(var i=0;i<e.value.length;i++)t(e.value[i],n,o);break;case"Alternative":var a=e.value;for(i=0;i<a.length;i++){var c=a[i];switch(c.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var s=c;switch(s.type){case"Character":h(s.value,n,o);break;case"Set":if(!0===s.complement)throw Error("Complement Sets are not supported for first char optimization");Object(r.u)(s.value,(function(t){if("number"==typeof t)h(t,n,o);else{var e=t;if(!0===o)for(var r=e.from;r<=e.to;r++)h(r,n,o);else{for(r=e.from;r<=e.to&&r<_;r++)h(r,n,o);if(e.to>=_)for(var i=e.from>=_?e.from:_,a=e.to,c=x(i),s=x(a),u=c;u<=s;u++)n[u]=u}}}));break;case"Group":t(s.value,n,o);break;default:throw Error("Non Exhaustive Match")}var u=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===d(s)||"Group"!==s.type&&!1===u)break}break;default:throw Error("non exhaustive match!")}return Object(r.U)(n)}(n.value,{},n.flags.ignoreCase)}catch(n){if("Complement Sets are not supported for first char optimization"===n.message)e&&Object(r.d)(l+"\tUnable to optimize: < "+t.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var i="";e&&(i="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Object(r.c)(l+"\n\tFailed parsing: < "+t.toString()+" >\n\tUsing the regexp-to-ast library version: "+o.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+i)}}return[]}function h(t,e,n){var r=x(t);e[r]=r,!0===n&&function(t,e){var n=String.fromCharCode(t),r=n.toUpperCase();if(r!==n){var o=x(r.charCodeAt(0));e[o]=o}else{var i=n.toLowerCase();if(i!==n){o=x(i.charCodeAt(0));e[o]=o}}}(t,e)}function p(t,e){return Object(r.q)(t.value,(function(t){if("number"==typeof t)return Object(r.j)(e,t);var n=t;return void 0!==Object(r.q)(e,(function(t){return n.from<=t&&t<=n.to}))}))}function d(t){return!(!t.quantifier||0!==t.quantifier.atLeast)||!!t.value&&(Object(r.y)(t.value)?Object(r.o)(t.value,d):d(t.value))}var m=function(t){function e(e){var n=t.call(this)||this;return n.targetCharCodes=e,n.found=!1,n}return u(e,t),e.prototype.visitChildren=function(e){if(!0!==this.found){switch(e.type){case"Lookahead":return void this.visitLookahead(e);case"NegativeLookahead":return void this.visitNegativeLookahead(e)}t.prototype.visitChildren.call(this,e)}},e.prototype.visitCharacter=function(t){Object(r.j)(this.targetCharCodes,t.value)&&(this.found=!0)},e.prototype.visitSet=function(t){t.complement?void 0===p(t,this.targetCharCodes)&&(this.found=!0):void 0!==p(t,this.targetCharCodes)&&(this.found=!0)},e}(o.BaseRegExpVisitor);function E(t,e){if(e instanceof RegExp){var n=c(e),o=new m(t);return o.visit(n),o.found}return void 0!==Object(r.q)(e,(function(e){return Object(r.j)(t,e.charCodeAt(0))}))}var g=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),N="PATTERN",v="boolean"==typeof new RegExp("(?:)").sticky;function O(t,e){var n,o=(e=Object(r.k)(e,{useSticky:v,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(t,e){return e()}})).tracer;o("initCharCodeToOptimizedIndexMap",(function(){!function(){if(Object(r.A)(k)){k=new Array(65536);for(var t=0;t<65536;t++)k[t]=t>255?255+~~(t/255):t}}()})),o("Reject Lexer.NA",(function(){n=Object(r.P)(t,(function(t){return t.PATTERN===$.NA}))}));var i,a,c,s,u,h,p,d,m,g,N,O=!1;o("Transform Patterns",(function(){O=!1,i=Object(r.I)(n,(function(t){var n=t.PATTERN;if(Object(r.D)(n)){var o=n.source;return 1===o.length&&"^"!==o&&"$"!==o&&"."!==o?o:2!==o.length||"\\"!==o[0]||Object(r.j)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],o[1])?e.useSticky?M(n):T(n):o[1]}if(Object(r.B)(n))return O=!0,{exec:n};if(Object(r.w)(n,"exec"))return O=!0,n;if("string"==typeof n){if(1===n.length)return n;var i=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=new RegExp(i);return e.useSticky?M(a):T(a)}throw Error("non exhaustive match")}))})),o("misc mapping",(function(){a=Object(r.I)(n,(function(t){return t.tokenTypeIdx})),c=Object(r.I)(n,(function(t){var e=t.GROUP;if(e!==$.SKIPPED){if(Object(r.E)(e))return e;if(Object(r.F)(e))return!1;throw Error("non exhaustive match")}})),s=Object(r.I)(n,(function(t){var e=t.LONGER_ALT;if(e)return Object(r.x)(n,e)})),u=Object(r.I)(n,(function(t){return t.PUSH_MODE})),h=Object(r.I)(n,(function(t){return Object(r.w)(t,"POP_MODE")}))})),o("Line Terminator Handling",(function(){var t=U(e.lineTerminatorCharacters);p=Object(r.I)(n,(function(t){return!1})),"onlyOffset"!==e.positionTracking&&(p=Object(r.I)(n,(function(e){return Object(r.w)(e,"LINE_BREAKS")?e.LINE_BREAKS:!1===w(e,t)?E(t,e.PATTERN):void 0})))})),o("Misc Mapping #2",(function(){d=Object(r.I)(n,I),m=Object(r.I)(i,C),g=Object(r.O)(n,(function(t,e){var n=e.GROUP;return Object(r.E)(n)&&n!==$.SKIPPED&&(t[n]=[]),t}),{}),N=Object(r.I)(i,(function(t,e){return{pattern:i[e],longerAlt:s[e],canLineTerminator:p[e],isCustom:d[e],short:m[e],group:c[e],push:u[e],pop:h[e],tokenTypeIdx:a[e],tokenType:n[e]}}))}));var R=!0,A=[];return e.safeMode||o("First Char Optimization",(function(){A=Object(r.O)(n,(function(t,n,o){if("string"==typeof n.PATTERN){var i=x(n.PATTERN.charCodeAt(0));L(t,i,N[o])}else if(Object(r.y)(n.START_CHARS_HINT)){var a;Object(r.u)(n.START_CHARS_HINT,(function(e){var n=x("string"==typeof e?e.charCodeAt(0):e);a!==n&&(a=n,L(t,n,N[o]))}))}else if(Object(r.D)(n.PATTERN))if(n.PATTERN.unicode)R=!1,e.ensureOptimizations&&Object(r.c)(l+"\tUnable to analyze < "+n.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var c=f(n.PATTERN,e.ensureOptimizations);Object(r.A)(c)&&(R=!1),Object(r.u)(c,(function(e){L(t,e,N[o])}))}else e.ensureOptimizations&&Object(r.c)(l+"\tTokenType: <"+n.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),R=!1;return t}),[])})),o("ArrayPacking",(function(){A=Object(r.L)(A)})),{emptyGroups:g,patternIdxToConfig:N,charCodeToPatternIdxToConfig:A,hasCustom:O,canBeOptimized:R}}function R(t,e){var n=[],i=function(t){var e=Object(r.p)(t,(function(t){return!Object(r.w)(t,N)})),n=Object(r.I)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- missing static 'PATTERN' property",type:K.MISSING_PATTERN,tokenTypes:[t]}})),o=Object(r.l)(t,e);return{errors:n,valid:o}}(t);n=n.concat(i.errors);var a=function(t){var e=Object(r.p)(t,(function(t){var e=t.PATTERN;return!(Object(r.D)(e)||Object(r.B)(e)||Object(r.w)(e,"exec")||Object(r.E)(e))})),n=Object(r.I)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:K.INVALID_PATTERN,tokenTypes:[t]}})),o=Object(r.l)(t,e);return{errors:n,valid:o}}(i.valid),s=a.valid;return n=(n=(n=(n=(n=n.concat(a.errors)).concat(function(t){var e=[],n=Object(r.p)(t,(function(t){return Object(r.D)(t.PATTERN)}));return e=(e=(e=(e=(e=e.concat(function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return g(e,t),e.prototype.visitEndAnchor=function(t){this.found=!0},e}(o.BaseRegExpVisitor),n=Object(r.p)(t,(function(t){var n=t.PATTERN;try{var r=c(n),o=new e;return o.visit(r),o.found}catch(t){return A.test(n.source)}}));return Object(r.I)(n,(function(t){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:K.EOI_ANCHOR_FOUND,tokenTypes:[t]}}))}(n))).concat(function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.found=!1,e}return g(e,t),e.prototype.visitStartAnchor=function(t){this.found=!0},e}(o.BaseRegExpVisitor),n=Object(r.p)(t,(function(t){var n=t.PATTERN;try{var r=c(n),o=new e;return o.visit(r),o.found}catch(t){return y.test(n.source)}}));return Object(r.I)(n,(function(t){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+t.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:K.SOI_ANCHOR_FOUND,tokenTypes:[t]}}))}(n))).concat(function(t){var e=Object(r.p)(t,(function(t){var e=t.PATTERN;return e instanceof RegExp&&(e.multiline||e.global)}));return Object(r.I)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:K.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[t]}}))}(n))).concat(function(t){var e=[],n=Object(r.I)(t,(function(n){return Object(r.O)(t,(function(t,o){return n.PATTERN.source!==o.PATTERN.source||Object(r.j)(e,o)||o.PATTERN===$.NA?t:(e.push(o),t.push(o),t)}),[])}));n=Object(r.i)(n);var o=Object(r.p)(n,(function(t){return t.length>1}));return Object(r.I)(o,(function(t){var e=Object(r.I)(t,(function(t){return t.name}));return{message:"The same RegExp pattern ->"+Object(r.s)(t).PATTERN+"<-has been used in all of the following Token Types: "+e.join(", ")+" <-",type:K.DUPLICATE_PATTERNS_FOUND,tokenTypes:t}}))}(n))).concat(function(t){var e=Object(r.p)(t,(function(t){return t.PATTERN.test("")}));return Object(r.I)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PATTERN' must not match an empty string",type:K.EMPTY_MATCH_PATTERN,tokenTypes:[t]}}))}(n))}(s))).concat(function(t){var e=Object(r.p)(t,(function(t){if(!Object(r.w)(t,"GROUP"))return!1;var e=t.GROUP;return e!==$.SKIPPED&&e!==$.NA&&!Object(r.E)(e)}));return Object(r.I)(e,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:K.INVALID_GROUP_TYPE_FOUND,tokenTypes:[t]}}))}(s))).concat(function(t,e){var n=Object(r.p)(t,(function(t){return void 0!==t.PUSH_MODE&&!Object(r.j)(e,t.PUSH_MODE)}));return Object(r.I)(n,(function(t){return{message:"Token Type: ->"+t.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+t.PUSH_MODE+"<-which does not exist",type:K.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[t]}}))}(s,e))).concat(function(t){var e=[],n=Object(r.O)(t,(function(t,e,n){var o,i=e.PATTERN;return i===$.NA?t:(Object(r.E)(i)?t.push({str:i,idx:n,tokenType:e}):Object(r.D)(i)&&(o=i,void 0===Object(r.q)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(t){return-1!==o.source.indexOf(t)})))&&t.push({str:i.source,idx:n,tokenType:e}),t)}),[]);return Object(r.u)(t,(function(t,o){Object(r.u)(n,(function(n){var i=n.str,a=n.idx,c=n.tokenType;if(o<a&&function(t,e){if(Object(r.D)(e)){var n=e.exec(t);return null!==n&&0===n.index}if(Object(r.B)(e))return e(t,0,[],{});if(Object(r.w)(e,"exec"))return e.exec(t,0,[],{});if("string"==typeof e)return e===t;throw Error("non exhaustive match")}(i,t.PATTERN)){var s="Token: ->"+c.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+t.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";e.push({message:s,type:K.UNREACHABLE_PATTERN,tokenTypes:[t,c]})}}))})),e}(s))}var A=/[^\\][\$]/;var y=/[^\\[][\^]|^\^/;function T(t){var e=t.ignoreCase?"i":"";return new RegExp("^(?:"+t.source+")",e)}function M(t){var e=t.ignoreCase?"iy":"y";return new RegExp(""+t.source,e)}function b(t,e,n){var o=[],i=!1,a=Object(r.i)(Object(r.t)(Object(r.J)(t.modes,(function(t){return t})))),c=Object(r.P)(a,(function(t){return t.PATTERN===$.NA})),s=U(n);return e&&Object(r.u)(c,(function(t){var e=w(t,s);if(!1!==e){var n={message:function(t,e){if(e.issue===K.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+t.name+"> Token Type\n\t Root cause: "+e.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(e.issue===K.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+t.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(t,e),type:e.issue,tokenType:t};o.push(n)}else Object(r.w)(t,"LINE_BREAKS")?!0===t.LINE_BREAKS&&(i=!0):E(s,t.PATTERN)&&(i=!0)})),e&&!i&&o.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:K.NO_LINE_BREAKS_FLAGS}),o}function I(t){var e=t.PATTERN;if(Object(r.D)(e))return!1;if(Object(r.B)(e))return!0;if(Object(r.w)(e,"exec"))return!0;if(Object(r.E)(e))return!1;throw Error("non exhaustive match")}function C(t){return!(!Object(r.E)(t)||1!==t.length)&&t.charCodeAt(0)}var S={test:function(t){for(var e=t.length,n=this.lastIndex;n<e;n++){var r=t.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===t.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function w(t,e){if(Object(r.w)(t,"LINE_BREAKS"))return!1;if(Object(r.D)(t.PATTERN)){try{E(e,t.PATTERN)}catch(t){return{issue:K.IDENTIFY_TERMINATOR,errMsg:t.message}}return!1}if(Object(r.E)(t.PATTERN))return!1;if(I(t))return{issue:K.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function U(t){return Object(r.I)(t,(function(t){return Object(r.E)(t)&&t.length>0?t.charCodeAt(0):t}))}function L(t,e,n){void 0===t[e]?t[e]=[n]:t[e].push(n)}var _=256;function x(t){return t<_?t:k[t]}var k=[];function P(t,e){var n=t.tokenTypeIdx;return n===e.tokenTypeIdx||!0===e.isParent&&!0===e.categoryMatchesMap[n]}function j(t,e){return t.tokenTypeIdx===e.tokenTypeIdx}var B=1,F={};function D(t){var e=function(t){var e=Object(r.g)(t),n=t,o=!0;for(;o;){n=Object(r.i)(Object(r.t)(Object(r.I)(n,(function(t){return t.CATEGORIES}))));var i=Object(r.l)(n,e);e=e.concat(i),Object(r.A)(i)?o=!1:n=i}return e}(t);!function(t){Object(r.u)(t,(function(t){var e;V(t)||(F[B]=t,t.tokenTypeIdx=B++),G(t)&&!Object(r.y)(t.CATEGORIES)&&(t.CATEGORIES=[t.CATEGORIES]),G(t)||(t.CATEGORIES=[]),e=t,Object(r.w)(e,"categoryMatches")||(t.categoryMatches=[]),function(t){return Object(r.w)(t,"categoryMatchesMap")}(t)||(t.categoryMatchesMap={})}))}(e),function(t){Object(r.u)(t,(function(t){!function t(e,n){Object(r.u)(e,(function(t){n.categoryMatchesMap[t.tokenTypeIdx]=!0})),Object(r.u)(n.CATEGORIES,(function(o){var i=e.concat(n);Object(r.j)(i,o)||t(i,o)}))}([],t)}))}(e),function(t){Object(r.u)(t,(function(t){t.categoryMatches=[],Object(r.u)(t.categoryMatchesMap,(function(e,n){t.categoryMatches.push(F[n].tokenTypeIdx)}))}))}(e),Object(r.u)(e,(function(t){t.isParent=t.categoryMatches.length>0}))}function V(t){return Object(r.w)(t,"tokenTypeIdx")}function G(t){return Object(r.w)(t,"CATEGORIES")}function H(t){return Object(r.w)(t,"tokenTypeIdx")}var K,Y={buildUnableToPopLexerModeMessage:function(t){return"Unable to pop Lexer Mode after encountering Token ->"+t.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(t,e,n,r,o){return"unexpected character: ->"+t.charAt(e)+"<- at offset: "+e+", skipped "+n+" characters."}};!function(t){t[t.MISSING_PATTERN=0]="MISSING_PATTERN",t[t.INVALID_PATTERN=1]="INVALID_PATTERN",t[t.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",t[t.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",t[t.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",t[t.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",t[t.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",t[t.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",t[t.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",t[t.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",t[t.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",t[t.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",t[t.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",t[t.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",t[t.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",t[t.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",t[t.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(K||(K={}));var W={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:Y,traceInitPerf:!1,skipValidations:!1};Object.freeze(W);var $=function(){function t(t,e){var n=this;if(void 0===e&&(e=W),this.lexerDefinition=t,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof e)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Object(r.K)(W,e);var o=this.config.traceInitPerf;!0===o?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof o&&(this.traceInitMaxIdent=o,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var o,a=!0;n.TRACE_INIT("Lexer Config handling",(function(){if(n.config.lineTerminatorsPattern===W.lineTerminatorsPattern)n.config.lineTerminatorsPattern=S;else if(n.config.lineTerminatorCharacters===W.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(e.safeMode&&e.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),Object(r.y)(t)?((o={modes:{}}).modes.defaultMode=Object(r.g)(t),o.defaultMode="defaultMode"):(a=!1,o=Object(r.h)(t))})),!1===n.config.skipValidations&&(n.TRACE_INIT("performRuntimeChecks",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(function(t,e,n){var o=[];return Object(r.w)(t,"defaultMode")||o.push({message:"A MultiMode Lexer cannot be initialized without a <defaultMode> property in its definition\n",type:K.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Object(r.w)(t,"modes")||o.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:K.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Object(r.w)(t,"modes")&&Object(r.w)(t,"defaultMode")&&!Object(r.w)(t.modes,t.defaultMode)&&o.push({message:"A MultiMode Lexer cannot be initialized with a defaultMode: <"+t.defaultMode+">which does not exist\n",type:K.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Object(r.w)(t,"modes")&&Object(r.u)(t.modes,(function(t,e){Object(r.u)(t,(function(t,n){Object(r.F)(t)&&o.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+e+"> at index: <"+n+">\n",type:K.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),o}(o,n.trackStartLines,n.config.lineTerminatorCharacters))})),n.TRACE_INIT("performWarningRuntimeChecks",(function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(b(o,n.trackStartLines,n.config.lineTerminatorCharacters))}))),o.modes=o.modes?o.modes:{},Object(r.u)(o.modes,(function(t,e){o.modes[e]=Object(r.P)(t,(function(t){return Object(r.F)(t)}))}));var c=Object(r.G)(o.modes);if(Object(r.u)(o.modes,(function(t,o){n.TRACE_INIT("Mode: <"+o+"> processing",(function(){var i;(n.modes.push(o),!1===n.config.skipValidations&&n.TRACE_INIT("validatePatterns",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(R(t,c))})),Object(r.A)(n.lexerDefinitionErrors))&&(D(t),n.TRACE_INIT("analyzeTokenTypes",(function(){i=O(t,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:e.positionTracking,ensureOptimizations:e.ensureOptimizations,safeMode:e.safeMode,tracer:n.TRACE_INIT.bind(n)})})),n.patternIdxToConfig[o]=i.patternIdxToConfig,n.charCodeToPatternIdxToConfig[o]=i.charCodeToPatternIdxToConfig,n.emptyGroups=Object(r.K)(n.emptyGroups,i.emptyGroups),n.hasCustom=i.hasCustom||n.hasCustom,n.canModeBeOptimized[o]=i.canBeOptimized)}))})),n.defaultMode=o.defaultMode,!Object(r.A)(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var s=Object(r.I)(n.lexerDefinitionErrors,(function(t){return t.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+s)}Object(r.u)(n.lexerDefinitionWarning,(function(t){Object(r.d)(t.message)})),n.TRACE_INIT("Choosing sub-methods implementations",(function(){if(v?(n.chopInput=r.a,n.match=n.matchWithTest):(n.updateLastIndex=r.b,n.match=n.matchWithExec),a&&(n.handleModes=r.b),!1===n.trackStartLines&&(n.computeNewColumn=r.a),!1===n.trackEndLines&&(n.updateTokenEndLineColumnLocation=r.b),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else{if(!/onlyOffset/i.test(n.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.createTokenInstance=n.createOffsetOnlyToken}n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)})),n.TRACE_INIT("Failed Optimization Warnings",(function(){var t=Object(r.O)(n.canModeBeOptimized,(function(t,e,n){return!1===e&&t.push(n),t}),[]);if(e.ensureOptimizations&&!Object(r.A)(t))throw Error("Lexer Modes: < "+t.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),n.TRACE_INIT("clearRegExpParserCache",(function(){i={}})),n.TRACE_INIT("toFastProperties",(function(){Object(r.S)(n)}))}))}return t.prototype.tokenize=function(t,e){if(void 0===e&&(e=this.defaultMode),!Object(r.A)(this.lexerDefinitionErrors)){var n=Object(r.I)(this.lexerDefinitionErrors,(function(t){return t.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+n)}return this.tokenizeInternal(t,e)},t.prototype.tokenizeInternal=function(t,e){var n,o,i,a,c,s,u,l,f,h,p,d,m,E,g,N,v,O=this,R=t,A=R.length,y=0,T=0,M=this.hasCustom?0:Math.floor(t.length/10),b=new Array(M),I=[],C=this.trackStartLines?1:void 0,S=this.trackStartLines?1:void 0,w=(g=this.emptyGroups,N={},v=Object(r.G)(g),Object(r.u)(v,(function(t){var e=g[t];if(!Object(r.y)(e))throw Error("non exhaustive match");N[t]=[]})),N),U=this.trackStartLines,L=this.config.lineTerminatorsPattern,_=0,k=[],P=[],j=[],B=[];Object.freeze(B);var F=void 0;function D(){return k}function V(t){var e=x(t),n=P[e];return void 0===n?B:n}var G,H=function(t){if(1===j.length&&void 0===t.tokenType.PUSH_MODE){var e=O.config.errorMessageProvider.buildUnableToPopLexerModeMessage(t);I.push({offset:t.startOffset,line:void 0!==t.startLine?t.startLine:void 0,column:void 0!==t.startColumn?t.startColumn:void 0,length:t.image.length,message:e})}else{j.pop();var n=Object(r.H)(j);k=O.patternIdxToConfig[n],P=O.charCodeToPatternIdxToConfig[n],_=k.length;var o=O.canModeBeOptimized[n]&&!1===O.config.safeMode;F=P&&o?V:D}};function K(t){j.push(t),P=this.charCodeToPatternIdxToConfig[t],k=this.patternIdxToConfig[t],_=k.length,_=k.length;var e=this.canModeBeOptimized[t]&&!1===this.config.safeMode;F=P&&e?V:D}for(K.call(this,e);y<A;){c=null;var Y=R.charCodeAt(y),W=F(Y),$=W.length;for(n=0;n<$;n++){var q=(G=W[n]).pattern;if(s=null,!1!==(ot=G.short)?Y===ot&&(c=q):!0===G.isCustom?null!==(E=q.exec(R,y,b,w))?(c=E[0],void 0!==E.payload&&(s=E.payload)):c=null:(this.updateLastIndex(q,y),c=this.match(q,t,y)),null!==c){if(void 0!==(a=G.longerAlt)){var X=k[a],z=X.pattern;u=null,!0===X.isCustom?null!==(E=z.exec(R,y,b,w))?(i=E[0],void 0!==E.payload&&(u=E.payload)):i=null:(this.updateLastIndex(z,y),i=this.match(z,t,y)),i&&i.length>c.length&&(c=i,s=u,G=X)}break}}if(null!==c){if(l=c.length,void 0!==(f=G.group)&&(h=G.tokenTypeIdx,p=this.createTokenInstance(c,y,h,G.tokenType,C,S,l),this.handlePayload(p,s),!1===f?T=this.addToken(b,T,p):w[f].push(p)),t=this.chopInput(t,l),y+=l,S=this.computeNewColumn(S,l),!0===U&&!0===G.canLineTerminator){var Q=0,Z=void 0,J=void 0;L.lastIndex=0;do{!0===(Z=L.test(c))&&(J=L.lastIndex-1,Q++)}while(!0===Z);0!==Q&&(C+=Q,S=l-J,this.updateTokenEndLineColumnLocation(p,f,J,Q,C,S,l))}this.handleModes(G,H,K,p)}else{for(var tt=y,et=C,nt=S,rt=!1;!rt&&y<A;)for(R.charCodeAt(y),t=this.chopInput(t,1),y++,o=0;o<_;o++){var ot,it=k[o];q=it.pattern;if(!1!==(ot=it.short)?R.charCodeAt(y)===ot&&(rt=!0):!0===it.isCustom?rt=null!==q.exec(R,y,b,w):(this.updateLastIndex(q,y),rt=null!==q.exec(t)),!0===rt)break}d=y-tt,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(R,tt,d,et,nt),I.push({offset:tt,line:et,column:nt,length:d,message:m})}}return this.hasCustom||(b.length=T),{tokens:b,groups:w,errors:I}},t.prototype.handleModes=function(t,e,n,r){if(!0===t.pop){var o=t.push;e(r),void 0!==o&&n.call(this,o)}else void 0!==t.push&&n.call(this,t.push)},t.prototype.chopInput=function(t,e){return t.substring(e)},t.prototype.updateLastIndex=function(t,e){t.lastIndex=e},t.prototype.updateTokenEndLineColumnLocation=function(t,e,n,r,o,i,a){var c,s;void 0!==e&&(s=(c=n===a-1)?-1:0,1===r&&!0===c||(t.endLine=o+s,t.endColumn=i-1-s))},t.prototype.computeNewColumn=function(t,e){return t+e},t.prototype.createTokenInstance=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return null},t.prototype.createOffsetOnlyToken=function(t,e,n,r){return{image:t,startOffset:e,tokenTypeIdx:n,tokenType:r}},t.prototype.createStartOnlyToken=function(t,e,n,r,o,i){return{image:t,startOffset:e,startLine:o,startColumn:i,tokenTypeIdx:n,tokenType:r}},t.prototype.createFullToken=function(t,e,n,r,o,i,a){return{image:t,startOffset:e,endOffset:e+a-1,startLine:o,endLine:o,startColumn:i,endColumn:i+a-1,tokenTypeIdx:n,tokenType:r}},t.prototype.addToken=function(t,e,n){return 666},t.prototype.addTokenUsingPush=function(t,e,n){return t.push(n),e},t.prototype.addTokenUsingMemberAccess=function(t,e,n){return t[e]=n,++e},t.prototype.handlePayload=function(t,e){},t.prototype.handlePayloadNoCustom=function(t,e){},t.prototype.handlePayloadWithCustom=function(t,e){null!==e&&(t.payload=e)},t.prototype.match=function(t,e,n){return null},t.prototype.matchWithTest=function(t,e,n){return!0===t.test(e)?e.substring(n,t.lastIndex):null},t.prototype.matchWithExec=function(t,e){var n=t.exec(e);return null!==n?n[0]:n},t.prototype.TRACE_INIT=function(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+t+">");var o=Object(r.R)(e),i=o.time,a=o.value,c=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(n+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,a}return e()},t.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",t.NA=/NOT_APPLICABLE/,t}();function q(t){return z(t)?t.LABEL:t.name}function X(t){return t.name}function z(t){return Object(r.E)(t.LABEL)&&""!==t.LABEL}function Q(t){return function(t){var e=t.pattern,n={};n.name=t.name,Object(r.F)(e)||(n.PATTERN=e);if(Object(r.w)(t,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";Object(r.w)(t,"categories")&&(n.CATEGORIES=t.categories);D([n]),Object(r.w)(t,"label")&&(n.LABEL=t.label);Object(r.w)(t,"group")&&(n.GROUP=t.group);Object(r.w)(t,"pop_mode")&&(n.POP_MODE=t.pop_mode);Object(r.w)(t,"push_mode")&&(n.PUSH_MODE=t.push_mode);Object(r.w)(t,"longer_alt")&&(n.LONGER_ALT=t.longer_alt);Object(r.w)(t,"line_breaks")&&(n.LINE_BREAKS=t.line_breaks);Object(r.w)(t,"start_chars_hint")&&(n.START_CHARS_HINT=t.start_chars_hint);return n}(t)}var Z=Q({name:"EOF",pattern:$.NA});function J(t,e,n,r,o,i,a,c){return{image:e,startOffset:n,endOffset:r,startLine:o,endLine:i,startColumn:a,endColumn:c,tokenTypeIdx:t.tokenTypeIdx,tokenType:t}}function tt(t,e){return P(t,e)}D([Z]);var et=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt=function(){function t(t){this.definition=t}return t.prototype.accept=function(t){t.visit(this),Object(r.u)(this.definition,(function(e){e.accept(t)}))},t}(),rt=function(t){function e(e){var n=t.call(this,[])||this;return n.idx=1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),Object.defineProperty(e.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.accept=function(t){t.visit(this)},e}(nt),ot=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.orgText="",Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),it=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.ignoreAmbiguities=!1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),at=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),ct=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),st=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),ut=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),lt=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),ft=function(t){function e(e){var n=t.call(this,e.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,Object(r.f)(n,Object(r.N)(e,(function(t){return void 0!==t}))),n}return et(e,t),e}(nt),ht=function(){function t(t){this.idx=1,Object(r.f)(this,Object(r.N)(t,(function(t){return void 0!==t})))}return t.prototype.accept=function(t){t.visit(this)},t}();function pt(t){return Object(r.I)(t,dt)}function dt(t){function e(t){return Object(r.I)(t,dt)}if(t instanceof rt)return{type:"NonTerminal",name:t.nonTerminalName,idx:t.idx};if(t instanceof it)return{type:"Flat",definition:e(t.definition)};if(t instanceof at)return{type:"Option",idx:t.idx,definition:e(t.definition)};if(t instanceof ct)return{type:"RepetitionMandatory",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof st)return{type:"RepetitionMandatoryWithSeparator",name:t.name,idx:t.idx,separator:dt(new ht({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof lt)return{type:"RepetitionWithSeparator",name:t.name,idx:t.idx,separator:dt(new ht({terminalType:t.separator})),definition:e(t.definition)};if(t instanceof ut)return{type:"Repetition",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof ft)return{type:"Alternation",name:t.name,idx:t.idx,definition:e(t.definition)};if(t instanceof ht){var n={type:"Terminal",name:t.terminalType.name,label:q(t.terminalType),idx:t.idx},o=t.terminalType.PATTERN;return t.terminalType.PATTERN&&(n.pattern=Object(r.D)(o)?o.source:o),n}if(t instanceof ot)return{type:"Rule",name:t.name,orgText:t.orgText,definition:e(t.definition)};throw Error("non exhaustive match")}var mt=function(){function t(){}return t.prototype.walk=function(t,e){var n=this;void 0===e&&(e=[]),Object(r.u)(t.definition,(function(o,i){var a=Object(r.m)(t.definition,i+1);if(o instanceof rt)n.walkProdRef(o,a,e);else if(o instanceof ht)n.walkTerminal(o,a,e);else if(o instanceof it)n.walkFlat(o,a,e);else if(o instanceof at)n.walkOption(o,a,e);else if(o instanceof ct)n.walkAtLeastOne(o,a,e);else if(o instanceof st)n.walkAtLeastOneSep(o,a,e);else if(o instanceof lt)n.walkManySep(o,a,e);else if(o instanceof ut)n.walkMany(o,a,e);else{if(!(o instanceof ft))throw Error("non exhaustive match");n.walkOr(o,a,e)}}))},t.prototype.walkTerminal=function(t,e,n){},t.prototype.walkProdRef=function(t,e,n){},t.prototype.walkFlat=function(t,e,n){var r=e.concat(n);this.walk(t,r)},t.prototype.walkOption=function(t,e,n){var r=e.concat(n);this.walk(t,r)},t.prototype.walkAtLeastOne=function(t,e,n){var r=[new at({definition:t.definition})].concat(e,n);this.walk(t,r)},t.prototype.walkAtLeastOneSep=function(t,e,n){var r=Et(t,e,n);this.walk(t,r)},t.prototype.walkMany=function(t,e,n){var r=[new at({definition:t.definition})].concat(e,n);this.walk(t,r)},t.prototype.walkManySep=function(t,e,n){var r=Et(t,e,n);this.walk(t,r)},t.prototype.walkOr=function(t,e,n){var o=this,i=e.concat(n);Object(r.u)(t.definition,(function(t){var e=new it({definition:[t]});o.walk(e,i)}))},t}();function Et(t,e,n){return[new at({definition:[new ht({terminalType:t.separator})].concat(t.definition)})].concat(e,n)}var gt=function(){function t(){}return t.prototype.visit=function(t){var e=t;switch(e.constructor){case rt:return this.visitNonTerminal(e);case it:return this.visitFlat(e);case at:return this.visitOption(e);case ct:return this.visitRepetitionMandatory(e);case st:return this.visitRepetitionMandatoryWithSeparator(e);case lt:return this.visitRepetitionWithSeparator(e);case ut:return this.visitRepetition(e);case ft:return this.visitAlternation(e);case ht:return this.visitTerminal(e);case ot:return this.visitRule(e);default:throw Error("non exhaustive match")}},t.prototype.visitNonTerminal=function(t){},t.prototype.visitFlat=function(t){},t.prototype.visitOption=function(t){},t.prototype.visitRepetition=function(t){},t.prototype.visitRepetitionMandatory=function(t){},t.prototype.visitRepetitionMandatoryWithSeparator=function(t){},t.prototype.visitRepetitionWithSeparator=function(t){},t.prototype.visitAlternation=function(t){},t.prototype.visitTerminal=function(t){},t.prototype.visitRule=function(t){},t}(),Nt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function vt(t,e){return void 0===e&&(e=[]),!!(t instanceof at||t instanceof ut||t instanceof lt)||(t instanceof ft?Object(r.Q)(t.definition,(function(t){return vt(t,e)})):!(t instanceof rt&&Object(r.j)(e,t))&&(t instanceof nt&&(t instanceof rt&&e.push(t),Object(r.o)(t.definition,(function(t){return vt(t,e)})))))}function Ot(t){if(t instanceof rt)return"SUBRULE";if(t instanceof at)return"OPTION";if(t instanceof ft)return"OR";if(t instanceof ct)return"AT_LEAST_ONE";if(t instanceof st)return"AT_LEAST_ONE_SEP";if(t instanceof lt)return"MANY_SEP";if(t instanceof ut)return"MANY";if(t instanceof ht)return"CONSUME";throw Error("non exhaustive match")}var Rt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.separator="-",e.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},e}return Nt(e,t),e.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},e.prototype.visitTerminal=function(t){var e=t.terminalType.name+this.separator+"Terminal";Object(r.w)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitNonTerminal=function(t){var e=t.nonTerminalName+this.separator+"Terminal";Object(r.w)(this.dslMethods,e)||(this.dslMethods[e]=[]),this.dslMethods[e].push(t)},e.prototype.visitOption=function(t){this.dslMethods.option.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.dslMethods.repetitionWithSeparator.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.dslMethods.repetitionMandatory.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.dslMethods.repetitionMandatoryWithSeparator.push(t)},e.prototype.visitRepetition=function(t){this.dslMethods.repetition.push(t)},e.prototype.visitAlternation=function(t){this.dslMethods.alternation.push(t)},e}(gt),yt=new Rt;function Tt(t){if(t instanceof rt)return Tt(t.referencedRule);if(t instanceof ht)return[t.terminalType];if(function(t){return t instanceof it||t instanceof at||t instanceof ut||t instanceof ct||t instanceof st||t instanceof lt||t instanceof ht||t instanceof ot}(t))return function(t){var e,n=[],o=t.definition,i=0,a=o.length>i,c=!0;for(;a&&c;)e=o[i],c=vt(e),n=n.concat(Tt(e)),i+=1,a=o.length>i;return Object(r.T)(n)}(t);if(function(t){return t instanceof ft}(t))return function(t){var e=Object(r.I)(t.definition,(function(t){return Tt(t)}));return Object(r.T)(Object(r.t)(e))}(t);throw Error("non exhaustive match")}var Mt="_~IN~_",bt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),It=function(t){function e(e){var n=t.call(this)||this;return n.topProd=e,n.follows={},n}return bt(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},e.prototype.walkTerminal=function(t,e,n){},e.prototype.walkProdRef=function(t,e,n){var r,o,i=(r=t.referencedRule,o=t.idx,r.name+o+Mt+this.topProd.name),a=e.concat(n),c=Tt(new it({definition:a}));this.follows[i]=c},e}(mt);function Ct(t,e,n){return n|e|t}function St(t,e,n,r){var o=r+1<<24;return Ct(t,e,n)|o}var wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function Ut(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.endOffset=e.endOffset):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset)}function Lt(t,e){!0===isNaN(t.startOffset)?(t.startOffset=e.startOffset,t.startColumn=e.startColumn,t.startLine=e.startLine,t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine):t.endOffset<e.endOffset==!0&&(t.endOffset=e.endOffset,t.endColumn=e.endColumn,t.endLine=e.endLine)}function _t(t,e,n){void 0===t.children[e]?t.children[e]=[n]:t.children[e].push(n)}var xt=function(t){function e(e){var n=t.call(this)||this;return n.result=[],n.ruleIdx=e,n}return wt(e,t),e.prototype.collectNamedDSLMethod=function(t,e,n){if(!Object(r.F)(t.name)){var o=void 0;if(t instanceof at||t instanceof ut||t instanceof ct||t instanceof ft)o=new e({definition:t.definition,idx:t.idx});else{if(!(t instanceof st||t instanceof lt))throw Error("non exhaustive match");o=new e({definition:t.definition,idx:t.idx,separator:t.separator})}var i=[o],a=Ct(this.ruleIdx,n,t.idx);this.result.push({def:i,key:a,name:t.name,orgProd:t})}},e.prototype.visitOption=function(t){this.collectNamedDSLMethod(t,at,512)},e.prototype.visitRepetition=function(t){this.collectNamedDSLMethod(t,ut,768)},e.prototype.visitRepetitionMandatory=function(t){this.collectNamedDSLMethod(t,ct,1024)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.collectNamedDSLMethod(t,st,1536)},e.prototype.visitRepetitionWithSeparator=function(t){this.collectNamedDSLMethod(t,lt,1280)},e.prototype.visitAlternation=function(t){var e=this;this.collectNamedDSLMethod(t,ft,256);var n=t.definition.length>1;Object(r.u)(t.definition,(function(o,i){if(!Object(r.F)(o.name)){var a=o.definition;a=n?[new at({definition:o.definition})]:o.definition;var c=St(e.ruleIdx,256,t.idx,i);e.result.push({def:a,key:c,name:o.name,orgProd:o})}}))},e}(gt);var kt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pt=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.path=n,r.nextTerminalName="",r.nextTerminalOccurrence=0,r.nextTerminalName=r.path.lastTok.name,r.nextTerminalOccurrence=r.path.lastTokOccurrence,r}return kt(e,t),e.prototype.walkTerminal=function(t,e,n){if(this.isAtEndOfPath&&t.terminalType.name===this.nextTerminalName&&t.idx===this.nextTerminalOccurrence&&!this.found){var r=e.concat(n),o=new it({definition:r});this.possibleTokTypes=Tt(o),this.found=!0}},e}(function(t){function e(e,n){var r=t.call(this)||this;return r.topProd=e,r.path=n,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}return kt(e,t),e.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Object(r.g)(this.path.ruleStack).reverse(),this.occurrenceStack=Object(r.g)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},e.prototype.walk=function(e,n){void 0===n&&(n=[]),this.found||t.prototype.walk.call(this,e,n)},e.prototype.walkProdRef=function(t,e,n){if(t.referencedRule.name===this.nextProductionName&&t.idx===this.nextProductionOccurrence){var r=e.concat(n);this.updateExpectedNext(),this.walk(t.referencedRule,r)}},e.prototype.updateExpectedNext=function(){Object(r.A)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},e}(mt)),jt=function(t){function e(e,n){var r=t.call(this)||this;return r.topRule=e,r.occurrence=n,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}return kt(e,t),e.prototype.startWalking=function(){return this.walk(this.topRule),this.result},e}(mt),Bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.walkMany=function(e,n,o){if(e.idx===this.occurrence){var i=Object(r.s)(n.concat(o));this.result.isEndOfRule=void 0===i,i instanceof ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkMany.call(this,e,n,o)},e}(jt),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.walkManySep=function(e,n,o){if(e.idx===this.occurrence){var i=Object(r.s)(n.concat(o));this.result.isEndOfRule=void 0===i,i instanceof ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkManySep.call(this,e,n,o)},e}(jt),Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.walkAtLeastOne=function(e,n,o){if(e.idx===this.occurrence){var i=Object(r.s)(n.concat(o));this.result.isEndOfRule=void 0===i,i instanceof ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkAtLeastOne.call(this,e,n,o)},e}(jt),Vt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return kt(e,t),e.prototype.walkAtLeastOneSep=function(e,n,o){if(e.idx===this.occurrence){var i=Object(r.s)(n.concat(o));this.result.isEndOfRule=void 0===i,i instanceof ht&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else t.prototype.walkAtLeastOneSep.call(this,e,n,o)},e}(jt);function Gt(t,e,n){void 0===n&&(n=[]),n=Object(r.g)(n);var o=[],i=0;function a(a){var c=Gt(a.concat(Object(r.m)(t,i+1)),e,n);return o.concat(c)}for(;n.length<e&&i<t.length;){var c=t[i];if(c instanceof it)return a(c.definition);if(c instanceof rt)return a(c.definition);if(c instanceof at)o=a(c.definition);else{if(c instanceof ct)return a(s=c.definition.concat([new ut({definition:c.definition})]));if(c instanceof st)return a(s=[new it({definition:c.definition}),new ut({definition:[new ht({terminalType:c.separator})].concat(c.definition)})]);if(c instanceof lt){var s=c.definition.concat([new ut({definition:[new ht({terminalType:c.separator})].concat(c.definition)})]);o=a(s)}else if(c instanceof ut){s=c.definition.concat([new ut({definition:c.definition})]);o=a(s)}else{if(c instanceof ft)return Object(r.u)(c.definition,(function(t){o=a(t.definition)})),o;if(!(c instanceof ht))throw Error("non exhaustive match");n.push(c.terminalType)}}i++}return o.push({partialPath:n,suffixDef:Object(r.m)(t,i)}),o}function Ht(t,e,n,o){var i=["EXIT_NONE_TERMINAL"],a=!1,c=e.length,s=c-o-1,u=[],l=[];for(l.push({idx:-1,def:t,ruleStack:[],occurrenceStack:[]});!Object(r.A)(l);){var f=l.pop();if("EXIT_ALTERNATIVE"!==f){var h=f.def,p=f.idx,d=f.ruleStack,m=f.occurrenceStack;if(!Object(r.A)(h)){var E=h[0];if("EXIT_NONE_TERMINAL"===E){var g={idx:p,def:Object(r.m)(h),ruleStack:Object(r.n)(d),occurrenceStack:Object(r.n)(m)};l.push(g)}else if(E instanceof ht)if(p<c-1){var N=p+1;if(n(e[N],E.terminalType)){g={idx:N,def:Object(r.m)(h),ruleStack:d,occurrenceStack:m};l.push(g)}}else{if(p!==c-1)throw Error("non exhaustive match");u.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:d,occurrenceStack:m}),a=!0}else if(E instanceof rt){var v=Object(r.g)(d);v.push(E.nonTerminalName);var O=Object(r.g)(m);O.push(E.idx);g={idx:p,def:E.definition.concat(i,Object(r.m)(h)),ruleStack:v,occurrenceStack:O};l.push(g)}else if(E instanceof at){var R={idx:p,def:Object(r.m)(h),ruleStack:d,occurrenceStack:m};l.push(R),l.push("EXIT_ALTERNATIVE");var A={idx:p,def:E.definition.concat(Object(r.m)(h)),ruleStack:d,occurrenceStack:m};l.push(A)}else if(E instanceof ct){var y=new ut({definition:E.definition,idx:E.idx});g={idx:p,def:E.definition.concat([y],Object(r.m)(h)),ruleStack:d,occurrenceStack:m};l.push(g)}else if(E instanceof st){var T=new ht({terminalType:E.separator});y=new ut({definition:[T].concat(E.definition),idx:E.idx}),g={idx:p,def:E.definition.concat([y],Object(r.m)(h)),ruleStack:d,occurrenceStack:m};l.push(g)}else if(E instanceof lt){R={idx:p,def:Object(r.m)(h),ruleStack:d,occurrenceStack:m};l.push(R),l.push("EXIT_ALTERNATIVE");T=new ht({terminalType:E.separator});var M=new ut({definition:[T].concat(E.definition),idx:E.idx});A={idx:p,def:E.definition.concat([M],Object(r.m)(h)),ruleStack:d,occurrenceStack:m};l.push(A)}else if(E instanceof ut){R={idx:p,def:Object(r.m)(h),ruleStack:d,occurrenceStack:m};l.push(R),l.push("EXIT_ALTERNATIVE");M=new ut({definition:E.definition,idx:E.idx}),A={idx:p,def:E.definition.concat([M],Object(r.m)(h)),ruleStack:d,occurrenceStack:m};l.push(A)}else if(E instanceof ft)for(var b=E.definition.length-1;b>=0;b--){var I={idx:p,def:E.definition[b].definition.concat(Object(r.m)(h)),ruleStack:d,occurrenceStack:m};l.push(I),l.push("EXIT_ALTERNATIVE")}else if(E instanceof it)l.push({idx:p,def:E.definition.concat(Object(r.m)(h)),ruleStack:d,occurrenceStack:m});else{if(!(E instanceof ot))throw Error("non exhaustive match");l.push(Kt(E,p,d,m))}}}else a&&Object(r.H)(l).idx<=s&&l.pop()}return u}function Kt(t,e,n,o){var i=Object(r.g)(n);i.push(t.name);var a=Object(r.g)(o);return a.push(1),{idx:e,def:t.definition,ruleStack:i,occurrenceStack:a}}var Yt,Wt=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(t){t[t.OPTION=0]="OPTION",t[t.REPETITION=1]="REPETITION",t[t.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",t[t.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",t[t.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",t[t.ALTERNATION=5]="ALTERNATION"}(Yt||(Yt={}));var $t=function(t){function e(e,n,r){var o=t.call(this)||this;return o.topProd=e,o.targetOccurrence=n,o.targetProdType=r,o}return Wt(e,t),e.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},e.prototype.checkIsTarget=function(t,e,n,r){return t.idx===this.targetOccurrence&&this.targetProdType===e&&(this.restDef=n.concat(r),!0)},e.prototype.walkOption=function(e,n,r){this.checkIsTarget(e,Yt.OPTION,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkAtLeastOne=function(e,n,r){this.checkIsTarget(e,Yt.REPETITION_MANDATORY,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkAtLeastOneSep=function(e,n,r){this.checkIsTarget(e,Yt.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkMany=function(e,n,r){this.checkIsTarget(e,Yt.REPETITION,n,r)||t.prototype.walkOption.call(this,e,n,r)},e.prototype.walkManySep=function(e,n,r){this.checkIsTarget(e,Yt.REPETITION_WITH_SEPARATOR,n,r)||t.prototype.walkOption.call(this,e,n,r)},e}(mt),qt=function(t){function e(e,n,r){var o=t.call(this)||this;return o.targetOccurrence=e,o.targetProdType=n,o.targetRef=r,o.result=[],o}return Wt(e,t),e.prototype.checkIsTarget=function(t,e){t.idx!==this.targetOccurrence||this.targetProdType!==e||void 0!==this.targetRef&&t!==this.targetRef||(this.result=t.definition)},e.prototype.visitOption=function(t){this.checkIsTarget(t,Yt.OPTION)},e.prototype.visitRepetition=function(t){this.checkIsTarget(t,Yt.REPETITION)},e.prototype.visitRepetitionMandatory=function(t){this.checkIsTarget(t,Yt.REPETITION_MANDATORY)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.checkIsTarget(t,Yt.REPETITION_MANDATORY_WITH_SEPARATOR)},e.prototype.visitRepetitionWithSeparator=function(t){this.checkIsTarget(t,Yt.REPETITION_WITH_SEPARATOR)},e.prototype.visitAlternation=function(t){this.checkIsTarget(t,Yt.ALTERNATION)},e}(gt);function Xt(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=[];return e}function zt(t){for(var e=[""],n=0;n<t.length;n++){for(var r=t[n],o=[],i=0;i<e.length;i++){var a=e[i];o.push(a+"_"+r.tokenTypeIdx);for(var c=0;c<r.categoryMatches.length;c++){var s="_"+r.categoryMatches[c];o.push(a+s)}}e=o}return e}function Qt(t,e,n){for(var r=0;r<t.length;r++)if(r!==n)for(var o=t[r],i=0;i<e.length;i++){if(!0===o[e[i]])return!1}return!0}function Zt(t,e){for(var n=Object(r.I)(t,(function(t){return Gt([t],1)})),o=Xt(n.length),i=Object(r.I)(n,(function(t){var e={};return Object(r.u)(t,(function(t){var n=zt(t.partialPath);Object(r.u)(n,(function(t){e[t]=!0}))})),e})),a=n,c=1;c<=e;c++){var s=a;a=Xt(s.length);for(var u=function(t){for(var n=s[t],u=0;u<n.length;u++){var l=n[u].partialPath,f=n[u].suffixDef,h=zt(l);if(Qt(i,h,t)||Object(r.A)(f)||l.length===e){var p=o[t];if(!1===ee(p,l)){p.push(l);for(var d=0;d<h.length;d++){var m=h[d];i[t][m]=!0}}}else{var E=Gt(f,c+1,l);a[t]=a[t].concat(E),Object(r.u)(E,(function(e){var n=zt(e.partialPath);Object(r.u)(n,(function(e){i[t][e]=!0}))}))}}},l=0;l<s.length;l++)u(l)}return o}function Jt(t,e,n,r){var o=new qt(t,Yt.ALTERNATION,r);return e.accept(o),Zt(o.result,n)}function te(t,e,n,r){var o=new qt(t,n);e.accept(o);var i=o.result,a=new $t(e,t,n).startWalking();return Zt([new it({definition:i}),new it({definition:a})],r)}function ee(t,e){t:for(var n=0;n<t.length;n++){var r=t[n];if(r.length===e.length){for(var o=0;o<r.length;o++){var i=e[o],a=r[o];if(!1===(i===a||void 0!==a.categoryMatchesMap[i.tokenTypeIdx]))continue t}return!0}}return!1}function ne(t){return Object(r.o)(t,(function(t){return Object(r.o)(t,(function(t){return Object(r.o)(t,(function(t){return Object(r.A)(t.categoryMatches)}))}))}))}var re=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function oe(t,e,n,o,i,a){var c=r.I(t,(function(t){return function(t,e){var n=new ce;t.accept(n);var o=n.allProductions,i=r.v(o,ie),a=r.N(i,(function(t){return t.length>1}));return r.I(r.U(a),(function(n){var o=r.s(n),i=e.buildDuplicateFoundError(t,n),a=Ot(o),c={message:i,type:rn.DUPLICATE_PRODUCTIONS,ruleName:t.name,dslName:a,occurrence:o.idx},s=ae(o);return s&&(c.parameter=s),c}))}(t,i)})),s=r.I(t,(function(t){return function t(e,n,o,i){void 0===i&&(i=[]);var a=[],c=function t(e){var n=[];if(r.A(e))return n;var o=r.s(e);if(o instanceof rt)n.push(o.referencedRule);else if(o instanceof it||o instanceof at||o instanceof ct||o instanceof st||o instanceof lt||o instanceof ut)n=n.concat(t(o.definition));else if(o instanceof ft)n=r.t(r.I(o.definition,(function(e){return t(e.definition)})));else if(!(o instanceof ht))throw Error("non exhaustive match");var i=vt(o),a=e.length>1;if(i&&a){var c=r.m(e);return n.concat(t(c))}return n}(n.definition);if(r.A(c))return[];var s=e.name;r.j(c,e)&&a.push({message:o.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:i}),type:rn.LEFT_RECURSION,ruleName:s});var u=r.l(c,i.concat([e])),l=r.I(u,(function(n){var a=r.g(i);return a.push(n),t(e,n,o,a)}));return a.concat(r.t(l))}(t,t,i)})),u=[],l=[],f=[];Object(r.o)(s,r.A)&&(u=Object(r.I)(t,(function(t){return function(t,e){var n=new le;t.accept(n);var o=n.alternations;return r.O(o,(function(n,o){var i=r.n(o.definition),a=r.I(i,(function(n,i){var a=Ht([n],[],null,1);return r.A(a)?{message:e.buildEmptyAlternationError({topLevelRule:t,alternation:o,emptyChoiceIdx:i}),type:rn.NONE_LAST_EMPTY_ALT,ruleName:t.name,occurrence:o.idx,alternative:i+1}:null}));return n.concat(r.i(a))}),[])}(t,i)})),l=Object(r.I)(t,(function(t){return function(t,e,n,o){var i=new le;t.accept(i);var a=i.alternations,c=n[t.name];c&&(a=Object(r.P)(a,(function(t){return c[Ot(t)+(0===t.idx?"":t.idx)]})));return a=Object(r.P)(a,(function(t){return!0===t.ignoreAmbiguities})),r.O(a,(function(n,i){var a=i.idx,c=i.maxLookahead||e,s=Jt(a,t,c,i),u=function(t,e,n,o){var i=[],a=Object(r.O)(t,(function(n,o,a){return!0===e.definition[a].ignoreAmbiguities?n:(Object(r.u)(o,(function(o){var c=[a];Object(r.u)(t,(function(t,n){a!==n&&ee(t,o)&&!0!==e.definition[n].ignoreAmbiguities&&c.push(n)})),c.length>1&&!ee(i,o)&&(i.push(o),n.push({alts:c,path:o}))})),n)}),[]);return r.I(a,(function(t){var i=Object(r.I)(t.alts,(function(t){return t+1}));return{message:o.buildAlternationAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:i,prefixPath:t.path}),type:rn.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:e.idx,alternatives:[t.alts]}}))}(s,i,t,o),l=function(t,e,n,o){var i=[],a=Object(r.O)(t,(function(t,e,n){var o=Object(r.I)(e,(function(t){return{idx:n,path:t}}));return t.concat(o)}),[]);return Object(r.u)(a,(function(t){if(!0!==e.definition[t.idx].ignoreAmbiguities){var c=t.idx,s=t.path,u=Object(r.r)(a,(function(t){return!0!==e.definition[t.idx].ignoreAmbiguities&&t.idx<c&&(n=t.path,o=s,n.length<o.length&&Object(r.o)(n,(function(t,e){var n=o[e];return t===n||n.categoryMatchesMap[t.tokenTypeIdx]})));var n,o})),l=Object(r.I)(u,(function(t){var r=[t.idx+1,c+1],i=0===e.idx?"":e.idx;return{message:o.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:e,ambiguityIndices:r,prefixPath:t.path}),type:rn.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:i,alternatives:r}}));i=i.concat(l)}})),i}(s,i,t,o);return n.concat(u,l)}),[])}(t,e,o,i)})),f=function(t,e,n){var o=[];return Object(r.u)(t,(function(t){var i=new fe;t.accept(i);var a=i.allProductions;Object(r.u)(a,(function(i){var a=function(t){if(t instanceof at)return Yt.OPTION;if(t instanceof ut)return Yt.REPETITION;if(t instanceof ct)return Yt.REPETITION_MANDATORY;if(t instanceof st)return Yt.REPETITION_MANDATORY_WITH_SEPARATOR;if(t instanceof lt)return Yt.REPETITION_WITH_SEPARATOR;if(t instanceof ft)return Yt.ALTERNATION;throw Error("non exhaustive match")}(i),c=i.maxLookahead||e,s=te(i.idx,t,a,c)[0];if(Object(r.A)(Object(r.t)(s))){var u=n.buildEmptyRepetitionError({topLevelRule:t,repetition:i});o.push({message:u,type:rn.NO_NON_EMPTY_LOOKAHEAD,ruleName:t.name})}}))})),o}(t,e,i));var h=function(t,e,n){var o=[],i=Object(r.I)(e,(function(t){return t.name}));return Object(r.u)(t,(function(t){var e=t.name;if(Object(r.j)(i,e)){var a=n.buildNamespaceConflictError(t);o.push({message:a,type:rn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:e})}})),o}(t,n,i),p=r.I(n,(function(t){return function(t,e){var n=[];t.name.match(se)||n.push({message:e.buildTokenNameError({tokenType:t,expectedPattern:se}),type:rn.INVALID_TOKEN_NAME});return n}(t,i)})),d=function(t,e){var n=[];return Object(r.u)(t,(function(t){var o=new xt("");t.accept(o);var i=Object(r.I)(o.result,(function(t){return t.orgProd}));n.push(Object(r.I)(i,(function(n){return function(t,e,n){var r,o=[];e.name.match(ue)||(r=n.buildInvalidNestedRuleNameError(t,e),o.push({message:r,type:rn.INVALID_NESTED_RULE_NAME,ruleName:t.name}));return o}(t,n,e)})))})),Object(r.t)(n)}(t,i),m=function(t,e){var n=[];return Object(r.u)(t,(function(t){var o=new xt("");t.accept(o);var i=Object(r.v)(o.result,(function(t){return t.name})),a=Object(r.N)(i,(function(t){return t.length>1}));Object(r.u)(Object(r.U)(a),(function(o){var i=Object(r.I)(o,(function(t){return t.orgProd})),a=e.buildDuplicateNestedRuleNameError(t,i);n.push({message:a,type:rn.DUPLICATE_NESTED_NAME,ruleName:t.name})}))})),n}(t,i),E=Object(r.I)(t,(function(t){return function(t,e){var n=new le;t.accept(n);var o=n.alternations;return r.O(o,(function(n,r){return r.definition.length>255&&n.push({message:e.buildTooManyAlternativesError({topLevelRule:t,alternation:r}),type:rn.TOO_MANY_ALTS,ruleName:t.name,occurrence:r.idx}),n}),[])}(t,i)})),g=Object(r.I)(t,(function(t){return function(t,e){var n=[],r=t.name;r.match(se)||n.push({message:e.buildInvalidRuleNameError({topLevelRule:t,expectedPattern:se}),type:rn.INVALID_RULE_NAME,ruleName:r});return n}(t,i)})),N=Object(r.I)(t,(function(e){return function(t,e,n,o){var i=[];if(Object(r.O)(e,(function(e,n){return n.name===t.name?e+1:e}),0)>1){var a=o.buildDuplicateRuleNameError({topLevelRule:t,grammarName:n});i.push({message:a,type:rn.DUPLICATE_RULE_NAME,ruleName:t.name})}return i}(e,t,a,i)}));return r.t(c.concat(p,d,m,f,s,u,l,h,E,g,N))}function ie(t){return Ot(t)+"_#_"+t.idx+"_#_"+ae(t)}function ae(t){return t instanceof ht?t.terminalType.name:t instanceof rt?t.nonTerminalName:""}var ce=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return re(e,t),e.prototype.visitNonTerminal=function(t){this.allProductions.push(t)},e.prototype.visitOption=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e.prototype.visitAlternation=function(t){this.allProductions.push(t)},e.prototype.visitTerminal=function(t){this.allProductions.push(t)},e}(gt),se=/^[a-zA-Z_]\w*$/,ue=new RegExp(se.source.replace("^","^\\$"));var le=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.alternations=[],e}return re(e,t),e.prototype.visitAlternation=function(t){this.alternations.push(t)},e}(gt);var fe=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.allProductions=[],e}return re(e,t),e.prototype.visitRepetitionWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatory=function(t){this.allProductions.push(t)},e.prototype.visitRepetitionMandatoryWithSeparator=function(t){this.allProductions.push(t)},e.prototype.visitRepetition=function(t){this.allProductions.push(t)},e}(gt);var he={buildMismatchTokenMessage:function(t){var e=t.expected,n=t.actual;t.previous,t.ruleName;return"Expecting "+(z(e)?"--\x3e "+q(e)+" <--":"token of type --\x3e "+e.name+" <--")+" but found --\x3e '"+n.image+"' <--"},buildNotAllInputParsedMessage:function(t){var e=t.firstRedundant;t.ruleName;return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage:function(t){var e=t.expectedPathsPerAlt,n=t.actual,o=(t.previous,t.customUserDescription),i=(t.ruleName,"\nbut found: '"+Object(r.s)(n).image+"'");if(o)return"Expecting: "+o+i;var a=Object(r.O)(e,(function(t,e){return t.concat(e)}),[]),c=Object(r.I)(a,(function(t){return"["+Object(r.I)(t,(function(t){return q(t)})).join(", ")+"]"}));return"Expecting: "+("one of these possible Token sequences:\n"+Object(r.I)(c,(function(t,e){return"  "+(e+1)+". "+t})).join("\n"))+i},buildEarlyExitMessage:function(t){var e=t.expectedIterationPaths,n=t.actual,o=t.customUserDescription,i=(t.ruleName,"\nbut found: '"+Object(r.s)(n).image+"'");return o?"Expecting: "+o+i:"Expecting: "+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+Object(r.I)(e,(function(t){return"["+Object(r.I)(t,(function(t){return q(t)})).join(",")+"]"})).join(" ,")+">")+i}};Object.freeze(he);var pe={buildRuleNotFoundError:function(t,e){return"Invalid grammar, reference to a rule which is not defined: ->"+e.nonTerminalName+"<-\ninside top level rule: ->"+t.name+"<-"}},de={buildDuplicateFoundError:function(t,e){var n,o=t.name,i=Object(r.s)(e),a=i.idx,c=Ot(i),s=(n=i)instanceof ht?n.terminalType.name:n instanceof rt?n.nonTerminalName:"",u="->"+c+(a>0?a:"")+"<- "+(s?"with argument: ->"+s+"<-":"")+"\n                  appears more than once ("+e.length+" times) in the top level rule: ->"+o+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return u=(u=u.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(t,e){return"Invalid nested rule name: ->"+e.name+"<- inside rule: ->"+t.name+"<-\nit must match the pattern: ->"+ue.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(t,e){return"Duplicate nested rule name: ->"+Object(r.s)(e).name+"<- inside rule: ->"+t.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(t){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+t.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(t){var e=Object(r.I)(t.prefixPath,(function(t){return q(t)})).join(", "),n=0===t.alternation.idx?"":t.alternation.idx;return"Ambiguous alternatives: <"+t.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(t){var e=Object(r.I)(t.prefixPath,(function(t){return q(t)})).join(", "),n=0===t.alternation.idx?"":t.alternation.idx,o="Ambiguous Alternatives Detected: <"+t.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+t.topLevelRule.name+"> Rule,\n<"+e+"> may appears as a prefix path in all these alternatives.\n";return o+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(t){var e=Ot(t.repetition);return 0!==t.repetition.idx&&(e+=t.repetition.idx),"The repetition <"+e+"> within Rule <"+t.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(t){return"Invalid Grammar Token name: ->"+t.tokenType.name+"<- it must match the pattern: ->"+t.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(t){return"Ambiguous empty alternative: <"+(t.emptyChoiceIdx+1)+"> in <OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(t){return"An Alternation cannot have more than 256 alternatives:\n<OR"+t.alternation.idx+"> inside <"+t.topLevelRule.name+"> Rule.\n has "+(t.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(t){var e=t.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+e+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(e+" --\x3e "+r.I(t.leftRecursionPath,(function(t){return t.name})).concat([e]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(t){return"Invalid grammar rule name: ->"+t.topLevelRule.name+"<- it must match the pattern: ->"+t.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(t){return"Duplicate definition, rule: ->"+(t.topLevelRule instanceof ot?t.topLevelRule.name:t.topLevelRule)+"<- is already defined in the grammar: ->"+t.grammarName+"<-"}},me=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var Ee=function(t){function e(e,n){var r=t.call(this)||this;return r.nameToTopRule=e,r.errMsgProvider=n,r.errors=[],r}return me(e,t),e.prototype.resolveRefs=function(){var t=this;Object(r.u)(Object(r.U)(this.nameToTopRule),(function(e){t.currTopLevel=e,e.accept(t)}))},e.prototype.visitNonTerminal=function(t){var e=this.nameToTopRule[t.nonTerminalName];if(e)t.referencedRule=e;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,t);this.errors.push({message:n,type:rn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:t.nonTerminalName})}},e}(gt);function ge(t){t=Object(r.k)(t,{errMsgProvider:pe});var e,n,o,i={};return Object(r.u)(t.rules,(function(t){i[t.name]=t})),e=i,n=t.errMsgProvider,(o=new Ee(e,n)).resolveRefs(),o.errors}function Ne(t){return oe((t=Object(r.k)(t,{errMsgProvider:de,ignoredIssues:{}})).rules,t.maxLookahead,t.tokenTypes,t.ignoredIssues,t.errMsgProvider,t.grammarName)}function ve(t){Object(r.u)(t.rules,(function(t){var e=new Rt;t.accept(e),Object(r.u)(e.dslMethods,(function(t){Object(r.u)(t,(function(t,e){t.idx=e+1}))}))}))}var Oe=["MismatchedTokenException","NoViableAltException","EarlyExitException","NotAllInputParsedException"];function Re(t){return Object(r.j)(Oe,t.name)}function Ae(t,e,n){this.name="MismatchedTokenException",this.message=t,this.token=e,this.previousToken=n,this.resyncedTokens=[]}function ye(t,e,n){this.name="NoViableAltException",this.message=t,this.token=e,this.previousToken=n,this.resyncedTokens=[]}function Te(t,e){this.name="NotAllInputParsedException",this.message=t,this.token=e,this.resyncedTokens=[]}function Me(t,e,n){this.name="EarlyExitException",this.message=t,this.token=e,this.previousToken=n,this.resyncedTokens=[]}Object.freeze(Oe),Ae.prototype=Error.prototype,ye.prototype=Error.prototype,Te.prototype=Error.prototype,Me.prototype=Error.prototype;var be={};function Ie(t){this.name="InRuleRecoveryException",this.message=t}Ie.prototype=Error.prototype;var Ce=function(){function t(){}return t.prototype.initRecoverable=function(t){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Object(r.w)(t,"recoveryEnabled")?t.recoveryEnabled:on.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Se)},t.prototype.getTokenToInsert=function(t){var e=J(t,"",NaN,NaN,NaN,NaN,NaN,NaN);return e.isInsertedInRecovery=!0,e},t.prototype.canTokenTypeBeInsertedInRecovery=function(t){return!0},t.prototype.tryInRepetitionRecovery=function(t,e,n,o){for(var i=this,a=this.findReSyncTokenType(),c=this.exportLexerState(),s=[],u=!1,l=this.LA(1),f=this.LA(1),h=function(){var t=i.LA(0),e=new Ae(i.errorMessageProvider.buildMismatchTokenMessage({expected:o,actual:l,previous:t,ruleName:i.getCurrRuleFullName()}),l,i.LA(0));e.resyncedTokens=Object(r.n)(s),i.SAVE_ERROR(e)};!u;){if(this.tokenMatcher(f,o))return void h();if(n.call(this))return h(),void t.apply(this,e);this.tokenMatcher(f,a)?u=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,s))}this.importLexerState(c)},t.prototype.shouldInRepetitionRecoveryBeTried=function(t,e,n){return!1!==n&&(void 0!==t&&void 0!==e&&(!this.tokenMatcher(this.LA(1),t)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(t,this.getFollowsForInRuleRecovery(t,e)))))},t.prototype.getFollowsForInRuleRecovery=function(t,e){var n=this.getCurrentGrammarPath(t,e);return this.getNextPossibleTokenTypes(n)},t.prototype.tryInRuleRecovery=function(t,e){if(this.canRecoverWithSingleTokenInsertion(t,e))return this.getTokenToInsert(t);if(this.canRecoverWithSingleTokenDeletion(t)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new Ie("sad sad panda")},t.prototype.canPerformInRuleRecovery=function(t,e){return this.canRecoverWithSingleTokenInsertion(t,e)||this.canRecoverWithSingleTokenDeletion(t)},t.prototype.canRecoverWithSingleTokenInsertion=function(t,e){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(t))return!1;if(Object(r.A)(e))return!1;var o=this.LA(1);return void 0!==Object(r.q)(e,(function(t){return n.tokenMatcher(o,t)}))},t.prototype.canRecoverWithSingleTokenDeletion=function(t){return this.tokenMatcher(this.LA(2),t)},t.prototype.isInCurrentRuleReSyncSet=function(t){var e=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(e);return Object(r.j)(n,t)},t.prototype.findReSyncTokenType=function(){for(var t=this.flattenFollowSet(),e=this.LA(1),n=2;;){var o=e.tokenType;if(Object(r.j)(t,o))return o;e=this.LA(n),n++}},t.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return be;var t=this.getLastExplicitRuleShortName(),e=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(t),idxInCallingRule:e,inRule:this.shortRuleNameToFullName(n)}},t.prototype.buildFullFollowKeyStack=function(){var t=this,e=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Object(r.A)(this.LAST_EXPLICIT_RULE_STACK)||(e=Object(r.I)(this.LAST_EXPLICIT_RULE_STACK,(function(e){return t.RULE_STACK[e]})),n=Object(r.I)(this.LAST_EXPLICIT_RULE_STACK,(function(e){return t.RULE_OCCURRENCE_STACK[e]}))),Object(r.I)(e,(function(r,o){return 0===o?be:{ruleName:t.shortRuleNameToFullName(r),idxInCallingRule:n[o],inRule:t.shortRuleNameToFullName(e[o-1])}}))},t.prototype.flattenFollowSet=function(){var t=this,e=Object(r.I)(this.buildFullFollowKeyStack(),(function(e){return t.getFollowSetFromFollowKey(e)}));return Object(r.t)(e)},t.prototype.getFollowSetFromFollowKey=function(t){if(t===be)return[Z];var e=t.ruleName+t.idxInCallingRule+Mt+t.inRule;return this.resyncFollows[e]},t.prototype.addToResyncTokens=function(t,e){return this.tokenMatcher(t,Z)||e.push(t),e},t.prototype.reSyncTo=function(t){for(var e=[],n=this.LA(1);!1===this.tokenMatcher(n,t);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,e);return Object(r.n)(e)},t.prototype.attemptInRepetitionRecovery=function(t,e,n,r,o,i,a){},t.prototype.getCurrentGrammarPath=function(t,e){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Object(r.g)(this.RULE_OCCURRENCE_STACK),lastTok:t,lastTokOccurrence:e}},t.prototype.getHumanReadableRuleStack=function(){var t=this;return Object(r.A)(this.LAST_EXPLICIT_RULE_STACK)?Object(r.I)(this.RULE_STACK,(function(e){return t.shortRuleNameToFullName(e)})):Object(r.I)(this.LAST_EXPLICIT_RULE_STACK,(function(e){return t.shortRuleNameToFullName(t.RULE_STACK[e])}))},t}();function Se(t,e,n,r,o,i,a){var c=this.getKeyForAutomaticLookahead(r,o),s=this.firstAfterRepMap[c];if(void 0===s){var u=this.getCurrRuleFullName();s=new i(this.getGAstProductions()[u],o).startWalking(),this.firstAfterRepMap[c]=s}var l=s.token,f=s.occurrence,h=s.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=Z,f=1),this.shouldInRepetitionRecoveryBeTried(l,f,a)&&this.tryInRepetitionRecovery(t,e,n,l)}var we=function(){function t(){}return t.prototype.initLooksAhead=function(t){this.dynamicTokensEnabled=Object(r.w)(t,"dynamicTokensEnabled")?t.dynamicTokensEnabled:on.dynamicTokensEnabled,this.maxLookahead=Object(r.w)(t,"maxLookahead")?t.maxLookahead:on.maxLookahead,this.lookAheadFuncsCache=Object(r.z)()?new Map:[],Object(r.z)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},t.prototype.preComputeLookaheadFunctions=function(t){var e=this;Object(r.u)(t,(function(t){e.TRACE_INIT(t.name+" Rule Lookahead",(function(){var n=function(t){yt.reset(),t.accept(yt);var e=yt.dslMethods;return yt.reset(),e}(t),o=n.alternation,i=n.repetition,a=n.option,c=n.repetitionMandatory,s=n.repetitionMandatoryWithSeparator,u=n.repetitionWithSeparator;Object(r.u)(o,(function(n){var r=0===n.idx?"":n.idx;e.TRACE_INIT(""+Ot(n)+r,(function(){var r,o,i,a,c,s,u,l=(r=n.idx,o=t,i=n.maxLookahead||e.maxLookahead,a=n.hasPredicates,c=e.dynamicTokensEnabled,s=e.lookAheadBuilderForAlternatives,u=Jt(r,o,i),s(u,a,ne(u)?j:P,c)),f=Ct(e.fullRuleNameToShort[t.name],256,n.idx);e.setLaFuncCache(f,l)}))})),Object(r.u)(i,(function(n){e.computeLookaheadFunc(t,n.idx,768,Yt.REPETITION,n.maxLookahead,Ot(n))})),Object(r.u)(a,(function(n){e.computeLookaheadFunc(t,n.idx,512,Yt.OPTION,n.maxLookahead,Ot(n))})),Object(r.u)(c,(function(n){e.computeLookaheadFunc(t,n.idx,1024,Yt.REPETITION_MANDATORY,n.maxLookahead,Ot(n))})),Object(r.u)(s,(function(n){e.computeLookaheadFunc(t,n.idx,1536,Yt.REPETITION_MANDATORY_WITH_SEPARATOR,n.maxLookahead,Ot(n))})),Object(r.u)(u,(function(n){e.computeLookaheadFunc(t,n.idx,1280,Yt.REPETITION_WITH_SEPARATOR,n.maxLookahead,Ot(n))}))}))}))},t.prototype.computeLookaheadFunc=function(t,e,n,r,o,i){var a=this;this.TRACE_INIT(""+i+(0===e?"":e),(function(){var i=function(t,e,n,r,o,i){var a=te(t,e,o,n),c=ne(a)?j:P;return i(a[0],c,r)}(e,t,o||a.maxLookahead,a.dynamicTokensEnabled,r,a.lookAheadBuilderForOptional),c=Ct(a.fullRuleNameToShort[t.name],n,e);a.setLaFuncCache(c,i)}))},t.prototype.lookAheadBuilderForOptional=function(t,e,n){return function(t,e,n){var o=Object(r.o)(t,(function(t){return 1===t.length})),i=t.length;if(o&&!n){var a=Object(r.t)(t);if(1===a.length&&Object(r.A)(a[0].categoryMatches)){var c=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===c}}var s=Object(r.O)(a,(function(t,e,n){return t[e.tokenTypeIdx]=!0,Object(r.u)(e.categoryMatches,(function(e){t[e]=!0})),t}),[]);return function(){var t=this.LA(1);return!0===s[t.tokenTypeIdx]}}return function(){t:for(var n=0;n<i;n++){for(var r=t[n],o=r.length,a=0;a<o;a++){var c=this.LA(a+1);if(!1===e(c,r[a]))continue t}return!0}return!1}}(t,e,n)},t.prototype.lookAheadBuilderForAlternatives=function(t,e,n,o){return function(t,e,n,o){var i=t.length,a=Object(r.o)(t,(function(t){return Object(r.o)(t,(function(t){return 1===t.length}))}));if(e)return function(e){for(var o=Object(r.I)(e,(function(t){return t.GATE})),a=0;a<i;a++){var c=t[a],s=c.length,u=o[a];if(void 0===u||!1!==u.call(this))t:for(var l=0;l<s;l++){for(var f=c[l],h=f.length,p=0;p<h;p++){var d=this.LA(p+1);if(!1===n(d,f[p]))continue t}return a}}};if(a&&!o){var c=Object(r.I)(t,(function(t){return Object(r.t)(t)})),s=Object(r.O)(c,(function(t,e,n){return Object(r.u)(e,(function(e){Object(r.w)(t,e.tokenTypeIdx)||(t[e.tokenTypeIdx]=n),Object(r.u)(e.categoryMatches,(function(e){Object(r.w)(t,e)||(t[e]=n)}))})),t}),[]);return function(){var t=this.LA(1);return s[t.tokenTypeIdx]}}return function(){for(var e=0;e<i;e++){var r=t[e],o=r.length;t:for(var a=0;a<o;a++){for(var c=r[a],s=c.length,u=0;u<s;u++){var l=this.LA(u+1);if(!1===n(l,c[u]))continue t}return e}}}}(t,e,n,o)},t.prototype.getKeyForAutomaticLookahead=function(t,e){return Ct(this.getLastExplicitRuleShortName(),t,e)},t.prototype.getLaFuncFromCache=function(t){},t.prototype.getLaFuncFromMap=function(t){return this.lookAheadFuncsCache.get(t)},t.prototype.getLaFuncFromObj=function(t){return this.lookAheadFuncsCache[t]},t.prototype.setLaFuncCache=function(t,e){},t.prototype.setLaFuncCacheUsingMap=function(t,e){this.lookAheadFuncsCache.set(t,e)},t.prototype.setLaFuncUsingObj=function(t,e){this.lookAheadFuncsCache[t]=e},t}();var Ue,Le=/^\s*function\s*(\S*)\s*\(/;function _e(t){var e=t.name;return e||t.toString().match(Le)[1]}function xe(t,e){var n=Object.getOwnPropertyDescriptor(t,"name");return!(!Object(r.F)(n)&&!n.configurable)&&(Object.defineProperty(t,"name",{enumerable:!1,configurable:!0,writable:!1,value:e}),!0)}function ke(t,e){for(var n=Object(r.G)(t),o=n.length,i=0;i<o;i++)for(var a=t[n[i]],c=a.length,s=0;s<c;s++){var u=a[s];void 0===u.tokenTypeIdx&&(void 0!==u.fullName?this[u.fullName](u.children,e):this[u.name](u.children,e))}}function Pe(t,e){var n=function(){};return xe(n,t+"BaseSemantics"),(n.prototype={visit:function(t,e){if(Object(r.y)(t)&&(t=t[0]),!Object(r.F)(t))return void 0!==t.fullName?this[t.fullName](t.children,e):this[t.name](t.children,e)},validateVisitor:function(){var t=function(t,e){var n=function(t,e){var n=Object(r.I)(e,(function(e){if(!Object(r.B)(t[e]))return{msg:"Missing visitor method: <"+e+"> on "+_e(t.constructor)+" CST Visitor.",type:Ue.MISSING_METHOD,methodName:e}}));return Object(r.i)(n)}(t,e),o=function(t,e){var n=[];for(var o in t)se.test(o)&&Object(r.B)(t[o])&&!Object(r.j)(je,o)&&!Object(r.j)(e,o)&&n.push({msg:"Redundant visitor method: <"+o+"> on "+_e(t.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+se.source+"/.",type:Ue.REDUNDANT_METHOD,methodName:o});return n}(t,e);return n.concat(o)}(this,e);if(!Object(r.A)(t)){var n=Object(r.I)(t,(function(t){return t.msg}));throw Error("Errors Detected in CST Visitor <"+_e(this.constructor)+">:\n\t"+n.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=n,n._RULE_NAMES=e,n}!function(t){t[t.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",t[t.MISSING_METHOD=1]="MISSING_METHOD"}(Ue||(Ue={}));var je=["constructor","visit","validateVisitor"];var Be=function(){function t(){}return t.prototype.initTreeBuilder=function(t){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Object(r.w)(t,"outputCst")?t.outputCst:on.outputCst,this.nodeLocationTracking=Object(r.w)(t,"nodeLocationTracking")?t.nodeLocationTracking:on.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Lt,this.setNodeLocationFromNode=Lt,this.cstPostRule=r.b,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=r.b,this.setNodeLocationFromNode=r.b,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ut,this.setNodeLocationFromNode=Ut,this.cstPostRule=r.b,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=r.b,this.setNodeLocationFromNode=r.b,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+t.nodeLocationTracking+'"');this.setNodeLocationFromToken=r.b,this.setNodeLocationFromNode=r.b,this.cstPostRule=r.b,this.setInitialNodeLocation=r.b}else this.cstInvocationStateUpdate=r.b,this.cstFinallyStateUpdate=r.b,this.cstPostTerminal=r.b,this.cstPostNonTerminal=r.b,this.cstPostRule=r.b,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},t.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(t){t.location={startOffset:NaN,endOffset:NaN}},t.prototype.setInitialNodeLocationOnlyOffsetRegular=function(t){t.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},t.prototype.setInitialNodeLocationFullRecovery=function(t){t.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.setInitialNodeLocationFullRegular=function(t){var e=this.LA(1);t.location={startOffset:e.startOffset,startLine:e.startLine,startColumn:e.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},t.prototype.cstNestedInvocationStateUpdate=function(t,e){var n={name:t,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+t,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstInvocationStateUpdate=function(t,e){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:t,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},t.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},t.prototype.cstNestedFinallyStateUpdate=function(){var t=this.CST_STACK.pop();this.cstPostRule(t)},t.prototype.cstPostRuleFull=function(t){var e=this.LA(0),n=t.location;n.startOffset<=e.startOffset==!0?(n.endOffset=e.endOffset,n.endLine=e.endLine,n.endColumn=e.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},t.prototype.cstPostRuleOnlyOffset=function(t){var e=this.LA(0),n=t.location;n.startOffset<=e.startOffset==!0?n.endOffset=e.endOffset:n.startOffset=NaN},t.prototype.cstPostTerminal=function(t,e){var n,r,o,i=this.CST_STACK[this.CST_STACK.length-1];r=e,o=t,void 0===(n=i).children[o]?n.children[o]=[r]:n.children[o].push(r),this.setNodeLocationFromToken(i.location,e)},t.prototype.cstPostNonTerminal=function(t,e){if(!0!==this.isBackTracking()){var n=this.CST_STACK[this.CST_STACK.length-1];_t(n,e,t),this.setNodeLocationFromNode(n.location,t.location)}},t.prototype.getBaseCstVisitorConstructor=function(){if(Object(r.F)(this.baseCstVisitorConstructor)){var t=Pe(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=t,t}return this.baseCstVisitorConstructor},t.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Object(r.F)(this.baseCstVisitorWithDefaultsConstructor)){var t=function(t,e,n){var o=function(){};xe(o,t+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return Object(r.u)(e,(function(t){i[t]=ke})),(o.prototype=i).constructor=o,o}(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=t,t}return this.baseCstVisitorWithDefaultsConstructor},t.prototype.nestedRuleBeforeClause=function(t,e){var n;return void 0!==t.NAME?(n=t.NAME,this.nestedRuleInvocationStateUpdate(n,e),n):void 0},t.prototype.nestedAltBeforeClause=function(t,e,n,r){var o,i=St(this.getLastExplicitRuleShortName(),n,e,r);return void 0!==t.NAME?(o=t.NAME,this.nestedRuleInvocationStateUpdate(o,i),{shortName:i,nestedName:o}):void 0},t.prototype.nestedRuleFinallyClause=function(t,e){var n=this.CST_STACK,r=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];_t(o,e,r),this.setNodeLocationFromNode(o.location,r.location)},t.prototype.getLastExplicitRuleShortName=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[t]},t.prototype.getLastExplicitRuleShortNameNoCst=function(){var t=this.RULE_STACK;return t[t.length-1]},t.prototype.getPreviousExplicitRuleShortName=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[t]},t.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var t=this.RULE_STACK;return t[t.length-2]},t.prototype.getLastExplicitRuleOccurrenceIndex=function(){var t=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[t]},t.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var t=this.RULE_OCCURRENCE_STACK;return t[t.length-1]},t.prototype.nestedRuleInvocationStateUpdate=function(t,e){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(e),this.cstNestedInvocationStateUpdate(t,e)},t.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},t}(),Fe=function(){function t(){}return t.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(t.prototype,"input",{get:function(){return this.tokVector},set:function(t){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=t,this.tokVectorLength=t.length},enumerable:!0,configurable:!0}),t.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):nn},t.prototype.LA=function(t){var e=this.currIdx+t;return e<0||this.tokVectorLength<=e?nn:this.tokVector[e]},t.prototype.consumeToken=function(){this.currIdx++},t.prototype.exportLexerState=function(){return this.currIdx},t.prototype.importLexerState=function(t){this.currIdx=t},t.prototype.resetLexerState=function(){this.currIdx=-1},t.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},t.prototype.getLexerPosition=function(){return this.exportLexerState()},t}(),De=function(){function t(){}return t.prototype.ACTION=function(t){return t.call(this)},t.prototype.consume=function(t,e,n){return this.consumeInternal(e,t,n)},t.prototype.subrule=function(t,e,n){return this.subruleInternal(e,t,n)},t.prototype.option=function(t,e){return this.optionInternal(e,t)},t.prototype.or=function(t,e){return this.orInternal(e,t)},t.prototype.many=function(t,e){return this.manyInternal(t,e)},t.prototype.atLeastOne=function(t,e){return this.atLeastOneInternal(t,e)},t.prototype.CONSUME=function(t,e){return this.consumeInternal(t,0,e)},t.prototype.CONSUME1=function(t,e){return this.consumeInternal(t,1,e)},t.prototype.CONSUME2=function(t,e){return this.consumeInternal(t,2,e)},t.prototype.CONSUME3=function(t,e){return this.consumeInternal(t,3,e)},t.prototype.CONSUME4=function(t,e){return this.consumeInternal(t,4,e)},t.prototype.CONSUME5=function(t,e){return this.consumeInternal(t,5,e)},t.prototype.CONSUME6=function(t,e){return this.consumeInternal(t,6,e)},t.prototype.CONSUME7=function(t,e){return this.consumeInternal(t,7,e)},t.prototype.CONSUME8=function(t,e){return this.consumeInternal(t,8,e)},t.prototype.CONSUME9=function(t,e){return this.consumeInternal(t,9,e)},t.prototype.SUBRULE=function(t,e){return this.subruleInternal(t,0,e)},t.prototype.SUBRULE1=function(t,e){return this.subruleInternal(t,1,e)},t.prototype.SUBRULE2=function(t,e){return this.subruleInternal(t,2,e)},t.prototype.SUBRULE3=function(t,e){return this.subruleInternal(t,3,e)},t.prototype.SUBRULE4=function(t,e){return this.subruleInternal(t,4,e)},t.prototype.SUBRULE5=function(t,e){return this.subruleInternal(t,5,e)},t.prototype.SUBRULE6=function(t,e){return this.subruleInternal(t,6,e)},t.prototype.SUBRULE7=function(t,e){return this.subruleInternal(t,7,e)},t.prototype.SUBRULE8=function(t,e){return this.subruleInternal(t,8,e)},t.prototype.SUBRULE9=function(t,e){return this.subruleInternal(t,9,e)},t.prototype.OPTION=function(t){return this.optionInternal(t,0)},t.prototype.OPTION1=function(t){return this.optionInternal(t,1)},t.prototype.OPTION2=function(t){return this.optionInternal(t,2)},t.prototype.OPTION3=function(t){return this.optionInternal(t,3)},t.prototype.OPTION4=function(t){return this.optionInternal(t,4)},t.prototype.OPTION5=function(t){return this.optionInternal(t,5)},t.prototype.OPTION6=function(t){return this.optionInternal(t,6)},t.prototype.OPTION7=function(t){return this.optionInternal(t,7)},t.prototype.OPTION8=function(t){return this.optionInternal(t,8)},t.prototype.OPTION9=function(t){return this.optionInternal(t,9)},t.prototype.OR=function(t){return this.orInternal(t,0)},t.prototype.OR1=function(t){return this.orInternal(t,1)},t.prototype.OR2=function(t){return this.orInternal(t,2)},t.prototype.OR3=function(t){return this.orInternal(t,3)},t.prototype.OR4=function(t){return this.orInternal(t,4)},t.prototype.OR5=function(t){return this.orInternal(t,5)},t.prototype.OR6=function(t){return this.orInternal(t,6)},t.prototype.OR7=function(t){return this.orInternal(t,7)},t.prototype.OR8=function(t){return this.orInternal(t,8)},t.prototype.OR9=function(t){return this.orInternal(t,9)},t.prototype.MANY=function(t){this.manyInternal(0,t)},t.prototype.MANY1=function(t){this.manyInternal(1,t)},t.prototype.MANY2=function(t){this.manyInternal(2,t)},t.prototype.MANY3=function(t){this.manyInternal(3,t)},t.prototype.MANY4=function(t){this.manyInternal(4,t)},t.prototype.MANY5=function(t){this.manyInternal(5,t)},t.prototype.MANY6=function(t){this.manyInternal(6,t)},t.prototype.MANY7=function(t){this.manyInternal(7,t)},t.prototype.MANY8=function(t){this.manyInternal(8,t)},t.prototype.MANY9=function(t){this.manyInternal(9,t)},t.prototype.MANY_SEP=function(t){this.manySepFirstInternal(0,t)},t.prototype.MANY_SEP1=function(t){this.manySepFirstInternal(1,t)},t.prototype.MANY_SEP2=function(t){this.manySepFirstInternal(2,t)},t.prototype.MANY_SEP3=function(t){this.manySepFirstInternal(3,t)},t.prototype.MANY_SEP4=function(t){this.manySepFirstInternal(4,t)},t.prototype.MANY_SEP5=function(t){this.manySepFirstInternal(5,t)},t.prototype.MANY_SEP6=function(t){this.manySepFirstInternal(6,t)},t.prototype.MANY_SEP7=function(t){this.manySepFirstInternal(7,t)},t.prototype.MANY_SEP8=function(t){this.manySepFirstInternal(8,t)},t.prototype.MANY_SEP9=function(t){this.manySepFirstInternal(9,t)},t.prototype.AT_LEAST_ONE=function(t){this.atLeastOneInternal(0,t)},t.prototype.AT_LEAST_ONE1=function(t){return this.atLeastOneInternal(1,t)},t.prototype.AT_LEAST_ONE2=function(t){this.atLeastOneInternal(2,t)},t.prototype.AT_LEAST_ONE3=function(t){this.atLeastOneInternal(3,t)},t.prototype.AT_LEAST_ONE4=function(t){this.atLeastOneInternal(4,t)},t.prototype.AT_LEAST_ONE5=function(t){this.atLeastOneInternal(5,t)},t.prototype.AT_LEAST_ONE6=function(t){this.atLeastOneInternal(6,t)},t.prototype.AT_LEAST_ONE7=function(t){this.atLeastOneInternal(7,t)},t.prototype.AT_LEAST_ONE8=function(t){this.atLeastOneInternal(8,t)},t.prototype.AT_LEAST_ONE9=function(t){this.atLeastOneInternal(9,t)},t.prototype.AT_LEAST_ONE_SEP=function(t){this.atLeastOneSepFirstInternal(0,t)},t.prototype.AT_LEAST_ONE_SEP1=function(t){this.atLeastOneSepFirstInternal(1,t)},t.prototype.AT_LEAST_ONE_SEP2=function(t){this.atLeastOneSepFirstInternal(2,t)},t.prototype.AT_LEAST_ONE_SEP3=function(t){this.atLeastOneSepFirstInternal(3,t)},t.prototype.AT_LEAST_ONE_SEP4=function(t){this.atLeastOneSepFirstInternal(4,t)},t.prototype.AT_LEAST_ONE_SEP5=function(t){this.atLeastOneSepFirstInternal(5,t)},t.prototype.AT_LEAST_ONE_SEP6=function(t){this.atLeastOneSepFirstInternal(6,t)},t.prototype.AT_LEAST_ONE_SEP7=function(t){this.atLeastOneSepFirstInternal(7,t)},t.prototype.AT_LEAST_ONE_SEP8=function(t){this.atLeastOneSepFirstInternal(8,t)},t.prototype.AT_LEAST_ONE_SEP9=function(t){this.atLeastOneSepFirstInternal(9,t)},t.prototype.RULE=function(t,e,n){if(void 0===n&&(n=an),Object(r.j)(this.definedRulesNames,t)){var o={message:de.buildDuplicateRuleNameError({topLevelRule:t,grammarName:this.className}),type:rn.DUPLICATE_RULE_NAME,ruleName:t};this.definitionErrors.push(o)}this.definedRulesNames.push(t);var i=this.defineRule(t,e,n);return this[t]=i,i},t.prototype.OVERRIDE_RULE=function(t,e,n){void 0===n&&(n=an);var o,i,a,c,s,u=[];u=u.concat((o=t,i=this.definedRulesNames,a=this.className,s=[],r.j(i,o)||(c="Invalid rule override, rule: ->"+o+"<- cannot be overridden in the grammar: ->"+a+"<-as it is not defined in any of the super grammars ",s.push({message:c,type:rn.INVALID_RULE_OVERRIDE,ruleName:o})),s)),this.definitionErrors.push.apply(this.definitionErrors,u);var l=this.defineRule(t,e,n);return this[t]=l,l},t.prototype.BACKTRACK=function(t,e){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return t.apply(this,e),!0}catch(t){if(Re(t))return!1;throw t}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},t.prototype.getGAstProductions=function(){return this.gastProductionsCache},t.prototype.getSerializedGastProductions=function(){return pt(Object(r.U)(this.gastProductionsCache))},t}(),Ve=function(){function t(){}return t.prototype.initRecognizerEngine=function(t,e){if(this.className=_e(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=j,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Object(r.w)(e,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(Object(r.y)(t)){if(Object(r.A)(t))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof t[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(Object(r.y)(t))this.tokensMap=Object(r.O)(t,(function(t,e){return t[e.name]=e,t}),{});else if(Object(r.w)(t,"modes")&&Object(r.o)(Object(r.t)(Object(r.U)(t.modes)),H)){var n=Object(r.t)(Object(r.U)(t.modes)),o=Object(r.T)(n);this.tokensMap=Object(r.O)(o,(function(t,e){return t[e.name]=e,t}),{})}else{if(!Object(r.C)(t))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Object(r.h)(t)}this.tokensMap.EOF=Z;var i=Object(r.o)(Object(r.U)(t),(function(t){return Object(r.A)(t.categoryMatches)}));this.tokenMatcher=i?j:P,D(Object(r.U)(this.tokensMap))},t.prototype.defineRule=function(t,e,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+t+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var o,i=Object(r.w)(n,"resyncEnabled")?n.resyncEnabled:an.resyncEnabled,a=Object(r.w)(n,"recoveryValueFunc")?n.recoveryValueFunc:an.recoveryValueFunc,c=this.ruleShortNameIdx<<12;function s(t){try{if(!0===this.outputCst){e.apply(this,t);var n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}return e.apply(this,t)}catch(t){return this.invokeRuleCatch(t,i,a)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[c]=t,this.fullRuleNameToShort[t]=c;return(o=function(e,n){return void 0===e&&(e=0),this.ruleInvocationStateUpdate(c,t,e),s.call(this,n)}).ruleName=t,o.originalGrammarAction=e,o},t.prototype.invokeRuleCatch=function(t,e,n){var r=1===this.RULE_STACK.length,o=e&&!this.isBackTracking()&&this.recoveryEnabled;if(Re(t)){var i=t;if(o){var a,c=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(c))return i.resyncedTokens=this.reSyncTo(c),this.outputCst?((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,a):n();throw this.outputCst&&((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=a),i}if(r)return this.moveToTerminatedState(),n();throw i}throw t},t.prototype.optionInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(512,e),r=this.nestedRuleBeforeClause(t,n);try{return this.optionInternalLogic(t,e,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},t.prototype.optionInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(512,e);return this.optionInternalLogic(t,e,n)},t.prototype.optionInternalLogic=function(t,e,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(o=t.GATE)){var c=a;a=function(){return o.call(i)&&c.call(i)}}}else r=t;if(!0===a.call(this))return r.call(this)},t.prototype.atLeastOneInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(1024,t),r=this.nestedRuleBeforeClause(e,n);try{return this.atLeastOneInternalLogic(t,e,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},t.prototype.atLeastOneInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(1024,t);this.atLeastOneInternalLogic(t,e,n)},t.prototype.atLeastOneInternalLogic=function(t,e,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,void 0!==(o=e.GATE)){var c=a;a=function(){return o.call(i)&&c.call(i)}}}else r=e;if(!0!==a.call(this))throw this.raiseEarlyExitException(t,Yt.REPETITION_MANDATORY,e.ERR_MSG);for(var s=this.doSingleRepetition(r);!0===a.call(this)&&!0===s;)s=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[t,e],a,1024,t,Dt)},t.prototype.atLeastOneSepFirstInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(1536,t),r=this.nestedRuleBeforeClause(e,n);try{this.atLeastOneSepFirstInternalLogic(t,e,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},t.prototype.atLeastOneSepFirstInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(1536,t);this.atLeastOneSepFirstInternalLogic(t,e,n)},t.prototype.atLeastOneSepFirstInternalLogic=function(t,e,n){var r=this,o=e.DEF,i=e.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(t,Yt.REPETITION_MANDATORY_WITH_SEPARATOR,e.ERR_MSG);o.call(this);for(var a=function(){return r.tokenMatcher(r.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,a,o,Vt],a,1536,t,Vt)},t.prototype.manyInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(768,t),r=this.nestedRuleBeforeClause(e,n);try{return this.manyInternalLogic(t,e,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},t.prototype.manyInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(768,t);return this.manyInternalLogic(t,e,n)},t.prototype.manyInternalLogic=function(t,e,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,void 0!==(o=e.GATE)){var c=a;a=function(){return o.call(i)&&c.call(i)}}}else r=e;for(var s=!0;!0===a.call(this)&&!0===s;)s=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[t,e],a,768,t,Bt,s)},t.prototype.manySepFirstInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(1280,t),r=this.nestedRuleBeforeClause(e,n);try{this.manySepFirstInternalLogic(t,e,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},t.prototype.manySepFirstInternalNoCst=function(t,e){var n=this.getKeyForAutomaticLookahead(1280,t);this.manySepFirstInternalLogic(t,e,n)},t.prototype.manySepFirstInternalLogic=function(t,e,n){var r=this,o=e.DEF,i=e.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){o.call(this);for(var a=function(){return r.tokenMatcher(r.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,i,a,o,Ft],a,1280,t,Ft)}},t.prototype.repetitionSepSecondInternal=function(t,e,n,r,o){for(;n();)this.CONSUME(e),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[t,e,n,r,o],n,1536,t,o)},t.prototype.doSingleRepetition=function(t){var e=this.getLexerPosition();return t.call(this),this.getLexerPosition()>e},t.prototype.orInternalNoCst=function(t,e){var n=Object(r.y)(t)?t:t.DEF,o=this.getKeyForAutomaticLookahead(256,e),i=this.getLaFuncFromCache(o).call(this,n);if(void 0!==i)return n[i].ALT.call(this);this.raiseNoAltException(e,t.ERR_MSG)},t.prototype.orInternal=function(t,e){var n=this.getKeyForAutomaticLookahead(256,e),o=this.nestedRuleBeforeClause(t,n);try{var i=Object(r.y)(t)?t:t.DEF,a=this.getLaFuncFromCache(n).call(this,i);if(void 0!==a){var c=i[a],s=this.nestedAltBeforeClause(c,e,256,a);try{return c.ALT.call(this)}finally{void 0!==s&&this.nestedRuleFinallyClause(s.shortName,s.nestedName)}}this.raiseNoAltException(e,t.ERR_MSG)}finally{void 0!==o&&this.nestedRuleFinallyClause(n,o)}},t.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var t=this.LA(1),e=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:t,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Te(e,t))}},t.prototype.subruleInternal=function(t,e,n){var r;try{var o=void 0!==n?n.ARGS:void 0;return r=t.call(this,e,o),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:t.ruleName),r}catch(e){this.subruleInternalError(e,n,t.ruleName)}},t.prototype.subruleInternalError=function(t,e,n){throw Re(t)&&void 0!==t.partialCstResult&&(this.cstPostNonTerminal(t.partialCstResult,void 0!==e&&void 0!==e.LABEL?e.LABEL:n),delete t.partialCstResult),t},t.prototype.consumeInternal=function(t,e,n){var r;try{var o=this.LA(1);!0===this.tokenMatcher(o,t)?(this.consumeToken(),r=o):this.consumeInternalError(t,o,n)}catch(n){r=this.consumeInternalRecovery(t,e,n)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:t.name,r),r},t.prototype.consumeInternalError=function(t,e,n){var r,o=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:t,actual:e,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new Ae(r,e,o))},t.prototype.consumeInternalRecovery=function(t,e,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(t,e);try{return this.tryInRuleRecovery(t,r)}catch(t){throw"InRuleRecoveryException"===t.name?n:t}},t.prototype.saveRecogState=function(){var t=this.errors,e=Object(r.g)(this.RULE_STACK);return{errors:t,lexerState:this.exportLexerState(),RULE_STACK:e,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},t.prototype.reloadRecogState=function(t){this.errors=t.errors,this.importLexerState(t.lexerState),this.RULE_STACK=t.RULE_STACK},t.prototype.ruleInvocationStateUpdate=function(t,e,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(t),this.cstInvocationStateUpdate(e,t)},t.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},t.prototype.getCurrRuleFullName=function(){var t=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[t]},t.prototype.shortRuleNameToFullName=function(t){return this.shortRuleNameToFull[t]},t.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Z)},t.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},t}(),Ge=function(){function t(){}return t.prototype.initErrorHandler=function(t){this._errors=[],this.errorMessageProvider=Object(r.k)(t.errorMessageProvider,on.errorMessageProvider)},t.prototype.SAVE_ERROR=function(t){if(Re(t))return t.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Object(r.g)(this.RULE_OCCURRENCE_STACK)},this._errors.push(t),t;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(t.prototype,"errors",{get:function(){return Object(r.g)(this._errors)},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),t.prototype.raiseEarlyExitException=function(t,e,n){for(var r=this.getCurrRuleFullName(),o=te(t,this.getGAstProductions()[r],e,this.maxLookahead)[0],i=[],a=1;a<=this.maxLookahead;a++)i.push(this.LA(a));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:i,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new Me(c,this.LA(1),this.LA(0)))},t.prototype.raiseNoAltException=function(t,e){for(var n=this.getCurrRuleFullName(),r=Jt(t,this.getGAstProductions()[n],this.maxLookahead),o=[],i=1;i<=this.maxLookahead;i++)o.push(this.LA(i));var a=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:o,previous:a,customUserDescription:e,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new ye(c,this.LA(1),a))},t}(),He=function(){function t(){}return t.prototype.initContentAssist=function(){},t.prototype.computeContentAssist=function(t,e){var n=this.gastProductionsCache[t];if(Object(r.F)(n))throw Error("Rule ->"+t+"<- does not exist in this grammar.");return Ht([n],e,this.tokenMatcher,this.maxLookahead)},t.prototype.getNextPossibleTokenTypes=function(t){var e=Object(r.s)(t.ruleStack),n=this.getGAstProductions()[e];return new Pt(n,t).startWalking()},t}(),Ke={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Ke);var Ye=Math.pow(2,8)-1,We=Q({name:"RECORDING_PHASE_TOKEN",pattern:$.NA});D([We]);var $e=J(We,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze($e);var qe={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},Xe=function(){function t(){}return t.prototype.initGastRecorder=function(t){this.recordingProdStack=[],this.RECORDING_PHASE=!1},t.prototype.enableRecording=function(){var t=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var e=function(e){var n=e>0?e:"";t["CONSUME"+n]=function(t,n){return this.consumeInternalRecord(t,e,n)},t["SUBRULE"+n]=function(t,n){return this.subruleInternalRecord(t,e,n)},t["OPTION"+n]=function(t){return this.optionInternalRecord(t,e)},t["OR"+n]=function(t){return this.orInternalRecord(t,e)},t["MANY"+n]=function(t){this.manyInternalRecord(e,t)},t["MANY_SEP"+n]=function(t){this.manySepFirstInternalRecord(e,t)},t["AT_LEAST_ONE"+n]=function(t){this.atLeastOneInternalRecord(e,t)},t["AT_LEAST_ONE_SEP"+n]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}},n=0;n<10;n++)e(n);t.consume=function(t,e,n){return this.consumeInternalRecord(e,t,n)},t.subrule=function(t,e,n){return this.subruleInternalRecord(e,t,n)},t.option=function(t,e){return this.optionInternalRecord(e,t)},t.or=function(t,e){return this.orInternalRecord(e,t)},t.many=function(t,e){this.manyInternalRecord(t,e)},t.atLeastOne=function(t,e){this.atLeastOneInternalRecord(t,e)},t.ACTION=t.ACTION_RECORD,t.BACKTRACK=t.BACKTRACK_RECORD,t.LA=t.LA_RECORD}))},t.prototype.disableRecording=function(){var t=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var e=0;e<10;e++){var n=e>0?e:"";delete t["CONSUME"+n],delete t["SUBRULE"+n],delete t["OPTION"+n],delete t["OR"+n],delete t["MANY"+n],delete t["MANY_SEP"+n],delete t["AT_LEAST_ONE"+n],delete t["AT_LEAST_ONE_SEP"+n]}delete t.consume,delete t.subrule,delete t.option,delete t.or,delete t.many,delete t.atLeastOne,delete t.ACTION,delete t.BACKTRACK,delete t.LA}))},t.prototype.ACTION_RECORD=function(t){},t.prototype.BACKTRACK_RECORD=function(t,e){return function(){return!0}},t.prototype.LA_RECORD=function(t){return nn},t.prototype.topLevelRuleRecord=function(t,e){try{var n=new ot({definition:[],name:t});return n.name=t,this.recordingProdStack.push(n),e.call(this),this.recordingProdStack.pop(),n}catch(t){if(!0!==t.KNOWN_RECORDER_ERROR)try{t.message=t.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(e){throw t}throw t}},t.prototype.optionInternalRecord=function(t,e){return ze.call(this,at,t,e)},t.prototype.atLeastOneInternalRecord=function(t,e){ze.call(this,ct,e,t)},t.prototype.atLeastOneSepFirstInternalRecord=function(t,e){ze.call(this,st,e,t,!0)},t.prototype.manyInternalRecord=function(t,e){ze.call(this,ut,e,t)},t.prototype.manySepFirstInternalRecord=function(t,e){ze.call(this,lt,e,t,!0)},t.prototype.orInternalRecord=function(t,e){return Qe.call(this,t,e)},t.prototype.subruleInternalRecord=function(t,e,n){if(Je(e),!t||!1===Object(r.w)(t,"ruleName")){var o=new Error("<SUBRULE"+Ze(e)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw o.KNOWN_RECORDER_ERROR=!0,o}var i=Object(r.M)(this.recordingProdStack),a=t.ruleName,c=new rt({idx:e,nonTerminalName:a,referencedRule:void 0});return i.definition.push(c),this.outputCst?qe:Ke},t.prototype.consumeInternalRecord=function(t,e,n){if(Je(e),!V(t)){var o=new Error("<CONSUME"+Ze(e)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(t)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw o.KNOWN_RECORDER_ERROR=!0,o}var i=Object(r.M)(this.recordingProdStack),a=new ht({idx:e,terminalType:t});return i.definition.push(a),$e},t}();function ze(t,e,n,o){void 0===o&&(o=!1),Je(n);var i=Object(r.M)(this.recordingProdStack),a=Object(r.B)(e)?e:e.DEF,c=new t({definition:[],idx:n});return Object(r.w)(e,"NAME")&&(c.name=e.NAME),o&&(c.separator=e.SEP),Object(r.w)(e,"MAX_LOOKAHEAD")&&(c.maxLookahead=e.MAX_LOOKAHEAD),this.recordingProdStack.push(c),a.call(this),i.definition.push(c),this.recordingProdStack.pop(),Ke}function Qe(t,e){var n=this;Je(e);var o=Object(r.M)(this.recordingProdStack),i=!1===Object(r.y)(t),a=!1===i?t:t.DEF,c=new ft({definition:[],idx:e,ignoreAmbiguities:i&&!0===t.IGNORE_AMBIGUITIES});Object(r.w)(t,"NAME")&&(c.name=t.NAME),Object(r.w)(t,"MAX_LOOKAHEAD")&&(c.maxLookahead=t.MAX_LOOKAHEAD);var s=Object(r.Q)(a,(function(t){return Object(r.B)(t.GATE)}));return c.hasPredicates=s,o.definition.push(c),Object(r.u)(a,(function(t){var e=new it({definition:[]});c.definition.push(e),Object(r.w)(t,"NAME")&&(e.name=t.NAME),Object(r.w)(t,"IGNORE_AMBIGUITIES")?e.ignoreAmbiguities=t.IGNORE_AMBIGUITIES:Object(r.w)(t,"GATE")&&(e.ignoreAmbiguities=!0),n.recordingProdStack.push(e),t.ALT.call(n),n.recordingProdStack.pop()})),Ke}function Ze(t){return 0===t?"":""+t}function Je(t){if(t<0||t>Ye){var e=new Error("Invalid DSL Method idx value: <"+t+">\n\tIdx value must be a none negative value smaller than "+(Ye+1));throw e.KNOWN_RECORDER_ERROR=!0,e}}var tn=function(){function t(){}return t.prototype.initPerformanceTracer=function(t){if(Object(r.w)(t,"traceInitPerf")){var e=t.traceInitPerf,n="number"==typeof e;this.traceInitMaxIdent=n?e:1/0,this.traceInitPerf=n?e>0:e}else this.traceInitMaxIdent=0,this.traceInitPerf=on.traceInitPerf;this.traceInitIndent=-1},t.prototype.TRACE_INIT=function(t,e){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+t+">");var o=Object(r.R)(e),i=o.time,a=o.value,c=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&c(n+"<-- <"+t+"> time: "+i+"ms"),this.traceInitIndent--,a}return e()},t}(),en=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nn=J(Z,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(nn);var rn,on=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:he,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),an=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function cn(t){return void 0===t&&(t=void 0),function(){return t}}!function(t){t[t.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",t[t.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",t[t.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",t[t.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",t[t.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",t[t.LEFT_RECURSION=5]="LEFT_RECURSION",t[t.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",t[t.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",t[t.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",t[t.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",t[t.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",t[t.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",t[t.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",t[t.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",t[t.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(rn||(rn={}));var sn=function(){function t(t,e){void 0===e&&(e=on),this.ignoredIssues=on.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;this.initErrorHandler(e),this.initLexerAdapter(),this.initLooksAhead(e),this.initRecognizerEngine(t,e),this.initRecoverable(e),this.initTreeBuilder(e),this.initContentAssist(),this.initGastRecorder(e),this.initPerformanceTracer(e),Object(r.w)(e,"ignoredIssues")&&e.ignoredIssues!==on.ignoredIssues&&Object(r.d)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=Object(r.w)(e,"ignoredIssues")?e.ignoredIssues:on.ignoredIssues,this.skipValidations=Object(r.w)(e,"skipValidations")?e.skipValidations:on.skipValidations}return t.performSelfAnalysis=function(t){t.performSelfAnalysis()},t.prototype.performSelfAnalysis=function(){var e=this;this.TRACE_INIT("performSelfAnalysis",(function(){var n;e.selfAnalysisDone=!0;var o=e.className;e.TRACE_INIT("toFastProps",(function(){Object(r.S)(e)})),e.TRACE_INIT("Grammar Recording",(function(){try{e.enableRecording(),Object(r.u)(e.definedRulesNames,(function(t){var n=e[t].originalGrammarAction,r=void 0;e.TRACE_INIT(t+" Rule",(function(){r=e.topLevelRuleRecord(t,n)})),e.gastProductionsCache[t]=r}))}finally{e.disableRecording()}}));var i=[];if(e.TRACE_INIT("Grammar Resolving",(function(){i=ge({rules:Object(r.U)(e.gastProductionsCache)}),e.definitionErrors.push.apply(e.definitionErrors,i)})),e.TRACE_INIT("Grammar Validations",(function(){if(Object(r.A)(i)&&!1===e.skipValidations){var t=Ne({rules:Object(r.U)(e.gastProductionsCache),maxLookahead:e.maxLookahead,tokenTypes:Object(r.U)(e.tokensMap),ignoredIssues:e.ignoredIssues,errMsgProvider:de,grammarName:o});e.definitionErrors.push.apply(e.definitionErrors,t)}})),Object(r.A)(e.definitionErrors)&&(e.recoveryEnabled&&e.TRACE_INIT("computeAllProdsFollows",(function(){var t,n,o=(t=Object(r.U)(e.gastProductionsCache),n={},Object(r.u)(t,(function(t){var e=new It(t).startWalking();Object(r.f)(n,e)})),n);e.resyncFollows=o})),e.TRACE_INIT("ComputeLookaheadFunctions",(function(){e.preComputeLookaheadFunctions(Object(r.U)(e.gastProductionsCache))}))),e.TRACE_INIT("expandAllNestedRuleNames",(function(){var t,n,o,i=(t=Object(r.U)(e.gastProductionsCache),n=e.fullRuleNameToShort,o={allRuleNames:[]},Object(r.u)(t,(function(t){var e=n[t.name];o.allRuleNames.push(t.name);var i=new xt(e);t.accept(i),Object(r.u)(i.result,(function(e){e.def,e.key;var n=e.name;o.allRuleNames.push(t.name+n)}))})),o);e.allRuleNames=i.allRuleNames})),!t.DEFER_DEFINITION_ERRORS_HANDLING&&!Object(r.A)(e.definitionErrors))throw n=Object(r.I)(e.definitionErrors,(function(t){return t.message})),new Error("Parser Definition Errors detected:\n "+n.join("\n-------------------------------\n"))}))},t.DEFER_DEFINITION_ERRORS_HANDLING=!1,t}();Object(r.e)(sn,[Ce,we,Be,Fe,Ve,De,Ge,He,Xe,tn]);var un=function(t){function e(e,n){void 0===n&&(n=on);var o=Object(r.h)(n);return o.outputCst=!0,t.call(this,e,o)||this}return en(e,t),e}(sn),ln=function(t){function e(e,n){void 0===n&&(n=on);var o=Object(r.h)(n);return o.outputCst=!1,t.call(this,e,o)||this}return en(e,t),e}(sn);function fn(t,e){var n=void 0===e?{}:e,r=n.resourceBase,o=void 0===r?"https://unpkg.com/chevrotain@6.5.0/diagrams/":r,i=n.css;return'\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n'+("\n<link rel='stylesheet' href='"+(void 0===i?"https://unpkg.com/chevrotain@6.5.0/diagrams/diagrams.css":i)+"'>\n")+("\n<script src='"+o+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+o+"src/diagrams_builder.js'><\/script>\n<script src='"+o+"src/diagrams_behavior.js'><\/script>\n<script src='"+o+"src/main.js'><\/script>\n")+'\n<div id="diagrams" align="center"></div>    \n'+("\n<script>\n    window.serializedGrammar = "+JSON.stringify(t,null,"  ")+";\n<\/script>\n")+'\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}var hn="\n";function pn(t){var e;return"\nfunction "+t.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(e=t.rules,Object(r.I)(e,(function(t){return r=vn(n=1,'$.RULE("'+(e=t).name+'", function() {')+hn,r+=Nn(e.definition,n+1),r+=vn(n+1,"})")+hn;var e,n,r})).join("\n"))+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+t.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+t.name+".prototype.constructor = "+t.name+"    \n    "}function dn(t,e){var n=vn(e,"$.OR"+t.idx+"([")+hn,o=Object(r.I)(t.definition,(function(t){return function(t,e){var n=vn(e,"{")+hn;t.name&&(n+=vn(e+1,'NAME: "'+t.name+'",')+hn);return n+=vn(e+1,"ALT: function() {")+hn,n+=Nn(t.definition,e+1),n+=vn(e+1,"}")+hn,n+=vn(e,"}")}(t,e+1)}));return n+=o.join(",\n"),n+=hn+vn(e,"])\n")}function mn(t,e){if(t instanceof rt)return function(t,e){return vn(e,"$.SUBRULE"+t.idx+"($."+t.nonTerminalName+")"+hn)}(t,e);if(t instanceof at)return En("OPTION",t,e);if(t instanceof ct)return En("AT_LEAST_ONE",t,e);if(t instanceof st)return En("AT_LEAST_ONE_SEP",t,e);if(t instanceof lt)return En("MANY_SEP",t,e);if(t instanceof ut)return En("MANY",t,e);if(t instanceof ft)return dn(t,e);if(t instanceof ht)return function(t,e){var n=t.terminalType.name;return vn(e,"$.CONSUME"+t.idx+"(this.tokensMap."+n+")"+hn)}(t,e);if(t instanceof it)return Nn(t.definition,e);throw Error("non exhaustive match")}function En(t,e,n){var r=vn(n,"$."+(t+e.idx)+"(");return e.name||e.separator?(r+="{\n",e.name&&(r+=vn(n+1,'NAME: "'+e.name+'"')+","+hn),e.separator&&(r+=vn(n+1,"SEP: this.tokensMap."+e.separator.name)+","+hn),r+="DEF: "+gn(e.definition,n+2)+hn,r+=vn(n,"}")+hn):r+=gn(e.definition,n+1),r+=vn(n,")")+hn}function gn(t,e){var n="function() {\n";return n+=Nn(t,e),n+=vn(e,"}")+hn}function Nn(t,e){var n="";return Object(r.u)(t,(function(t){n+=mn(t,e+1)})),n}function vn(t,e){return Array(4*t+1).join(" ")+e}function On(t){var e=function(t){return"    \n"+pn(t)+"\nreturn new "+t.name+"(tokenVocabulary, config)    \n"}({name:t.name,rules:t.rules}),r=new Function("tokenVocabulary","config","chevrotain",e);return function(e){return r(t.tokenVocabulary,e,n(8))}}function Rn(t){return function(t){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+pn(t)+"\n    \nreturn {\n    "+t.name+": "+t.name+" \n}\n}));\n"}({name:t.name,rules:t.rules})}function An(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}n.d(e,"clearCache",(function(){return An})),n.d(e,"VERSION",(function(){return"6.5.0"})),n.d(e,"Parser",(function(){return sn})),n.d(e,"CstParser",(function(){return un})),n.d(e,"EmbeddedActionsParser",(function(){return ln})),n.d(e,"ParserDefinitionErrorType",(function(){return rn})),n.d(e,"EMPTY_ALT",(function(){return cn})),n.d(e,"Lexer",(function(){return $})),n.d(e,"LexerDefinitionErrorType",(function(){return K})),n.d(e,"createToken",(function(){return Q})),n.d(e,"createTokenInstance",(function(){return J})),n.d(e,"EOF",(function(){return Z})),n.d(e,"tokenLabel",(function(){return q})),n.d(e,"tokenMatcher",(function(){return tt})),n.d(e,"tokenName",(function(){return X})),n.d(e,"defaultGrammarResolverErrorProvider",(function(){return pe})),n.d(e,"defaultGrammarValidatorErrorProvider",(function(){return de})),n.d(e,"defaultParserErrorProvider",(function(){return he})),n.d(e,"EarlyExitException",(function(){return Me})),n.d(e,"isRecognitionException",(function(){return Re})),n.d(e,"MismatchedTokenException",(function(){return Ae})),n.d(e,"NotAllInputParsedException",(function(){return Te})),n.d(e,"NoViableAltException",(function(){return ye})),n.d(e,"defaultLexerErrorProvider",(function(){return Y})),n.d(e,"Alternation",(function(){return ft})),n.d(e,"Flat",(function(){return it})),n.d(e,"NonTerminal",(function(){return rt})),n.d(e,"Option",(function(){return at})),n.d(e,"Repetition",(function(){return ut})),n.d(e,"RepetitionMandatory",(function(){return ct})),n.d(e,"RepetitionMandatoryWithSeparator",(function(){return st})),n.d(e,"RepetitionWithSeparator",(function(){return lt})),n.d(e,"Rule",(function(){return ot})),n.d(e,"Terminal",(function(){return ht})),n.d(e,"serializeGrammar",(function(){return pt})),n.d(e,"serializeProduction",(function(){return dt})),n.d(e,"GAstVisitor",(function(){return gt})),n.d(e,"assignOccurrenceIndices",(function(){return ve})),n.d(e,"resolveGrammar",(function(){return ge})),n.d(e,"validateGrammar",(function(){return Ne})),n.d(e,"createSyntaxDiagramsCode",(function(){return fn})),n.d(e,"generateParserFactory",(function(){return On})),n.d(e,"generateParserModule",(function(){return Rn}))},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,WildCard:a}=n(2),c=o,s=n(10),u=n(17),l={latin:{halfRE:/[!-~]/g,fullRE:/[！-～]/g,delta:65248},hangul1:{halfRE:/[ﾡ-ﾾ]/g,fullRE:/[ᆨ-ᇂ]/g,delta:-60921},hangul2:{halfRE:/[ￂ-ￜ]/g,fullRE:/[ᅡ-ᅵ]/g,delta:-61025},kana:{delta:0,half:"｡｢｣､･ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝﾞﾟ",full:"。「」、・ヲァィゥェォャュョッーアイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワン゛゜"},extras:{delta:0,half:"¢£¬¯¦¥₩ |←↑→↓■°",full:"￠￡￢￣￤￥￦　￨￩￪￫￬￭￮"}},f=(t,e)=>t[e+"RE"]||new RegExp("["+t[e]+"]","g"),h=Object.keys(l).map(t=>l[t]),p=t=>h.reduce((t,e)=>t.replace(f(e,"half"),(t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)+t.delta):[...t.full][[...t.half].indexOf(e)])(e)),t),d=t=>h.reduce((t,e)=>t.replace(f(e,"full"),(t=>e=>t.delta?String.fromCharCode(e.charCodeAt(0)-t.delta):[...t.half][[...t.full].indexOf(e)])(e)),t),m={ASC:t=>(t=c.accept(t,i.STRING),d(t)),BAHTTEXT:t=>{t=c.accept(t,i.NUMBER);try{return u(t)}catch(t){throw Error(`Error in https://github.com/jojoee/bahttext \n${t.toString()}`)}},CHAR:t=>{if((t=c.accept(t,i.NUMBER))>255||t<1)throw r.VALUE;return String.fromCharCode(t)},CLEAN:t=>(t=c.accept(t,i.STRING)).replace(/[\x00-\x1F]/g,""),CODE:t=>{if(0===(t=c.accept(t,i.STRING)).length)throw r.VALUE;return t.charCodeAt(0)},CONCAT:(...t)=>{let e="";return c.flattenParams(t,i.STRING,!1,t=>{t=c.accept(t,i.STRING),e+=t}),e},CONCATENATE:(...t)=>{let e="";if(0===t.length)throw Error("CONCATENATE need at least one argument.");return t.forEach(t=>{t=c.accept(t,i.STRING),e+=t}),e},DBCS:t=>(t=c.accept(t,i.STRING),p(t)),DOLLAR:(t,e)=>{t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,2);const n=Array(e).fill("0").join("");return s.format(`$#,##0.${n}_);($#,##0.${n})`,t).trim()},EXACT:(t,e)=>(t=c.accept(t,[i.STRING]))===(e=c.accept(e,[i.STRING])),FIND:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.STRING),(n=c.accept(n,i.NUMBER,1))<1||n>e.length)throw r.VALUE;const o=e.indexOf(t,n-1);if(-1===o)throw r.VALUE;return o+1},FINDB:(...t)=>m.FIND(...t),FIXED:(t,e,n)=>{t=c.accept(t,i.NUMBER),e=c.accept(e,i.NUMBER,2),n=c.accept(n,i.BOOLEAN,!1);const r=Array(e).fill("0").join(""),o=n?"":"#,";return s.format(`${o}##0.${r}_);(${o}##0.${r})`,t).trim()},LEFT:(t,e)=>{if(t=c.accept(t,i.STRING),(e=c.accept(e,i.NUMBER,1))<0)throw r.VALUE;return e>t.length?t:t.slice(0,e)},LEFTB:(...t)=>m.LEFT(...t),LEN:t=>(t=c.accept(t,i.STRING)).length,LENB:(...t)=>m.LEN(...t),LOWER:t=>(t=c.accept(t,i.STRING)).toLowerCase(),MID:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER),n=c.accept(n,i.NUMBER),e>t.length)return"";if(e<1||n<1)throw r.VALUE;return t.slice(e-1,e+n-1)},MIDB:(...t)=>m.MID(...t),NUMBERVALUE:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.STRING,"."),n=c.accept(n,i.STRING,","),0===t.length)return 0;if(0===e.length||0===n.length)throw r.VALUE;if((e=e[0])===(n=n[0])||t.indexOf(e)<t.lastIndexOf(n))throw r.VALUE;const o=t.replace(n,"").replace(e,".").replace(/[^\-0-9.%()]/g,"").match(/([(-]*)([0-9]*[.]*[0-9]+)([)]?)([%]*)/);if(!o)throw r.VALUE;const a=o[1].length,s=o[3].length,u=o[4].length;let l=Number(o[2]);if(a>1||a&&!s||!a&&s||isNaN(l))throw r.VALUE;return l/=100**u,a?-l:l},PHONETIC:(...t)=>{throw r.NOT_IMPLEMENTED("PHONETIC")},PROPER:t=>(t=(t=(t=c.accept(t,[i.STRING])).toLowerCase()).charAt(0).toUpperCase()+t.slice(1)).replace(/(?:[^a-zA-Z])([a-zA-Z])/g,t=>t.toUpperCase()),REPLACE:(t,e,n,r)=>{t=c.accept(t,[i.STRING]),e=c.accept(e,[i.NUMBER]),n=c.accept(n,[i.NUMBER]),r=c.accept(r,[i.STRING]);let o=t.split("");return o.splice(e-1,n,r),o.join("")},REPLACEB:(...t)=>m.REPLACE(...t),REPT:(t,e)=>{t=c.accept(t,i.STRING),e=c.accept(e,i.NUMBER);let n="";for(let r=0;r<e;r++)n+=t;return n},RIGHT:(t,e)=>{if(t=c.accept(t,i.STRING),(e=c.accept(e,i.NUMBER,1))<0)throw r.VALUE;const n=t.length;return e>n?t:t.slice(n-e)},RIGHTB:(...t)=>m.RIGHT(...t),SEARCH:(t,e,n)=>{if(t=c.accept(t,i.STRING),e=c.accept(e,i.STRING),(n=c.accept(n,i.NUMBER,1))<1||n>e.length)throw r.VALUE;let o=a.isWildCard(t)?a.toRegex(t,"i"):t;const s=e.slice(n-1).search(o);if(-1===s)throw r.VALUE;return s+n},SEARCHB:(...t)=>m.SEARCH(...t),SUBSTITUTE:(...t)=>{},T:t=>"string"==typeof(t=c.accept(t))?t:"",TEXT:(t,e)=>{t=c.accept(t,i.NUMBER),e=c.accept(e,i.STRING);try{return s.format(e,t)}catch(t){throw console.error(t),r.VALUE}},TEXTJOIN:(...t)=>{},TRIM:t=>(t=c.accept(t,[i.STRING])).replace(/^\s+|\s+$/g,""),TEXTJOIN:(...t)=>{},UNICHAR:t=>{if((t=c.accept(t,[i.NUMBER]))<=0)throw r.VALUE;return String.fromCharCode(t)},UNICODE:t=>m.CODE(t)};t.exports=m},function(t,e){class n{}function r(t){let e="",n=t.length-1;for(;n>=0;)e+=t.charAt(n--);return e}function o(t,e){let n="";for(;n.length<e;)n+=t;return n}function i(t,e){let n=""+t;return n.length>=e?n:o("0",e-n.length)+n}function a(t,e){let n=""+t;return n.length>=e?n:o(" ",e-n.length)+n}function c(t,e){let n=""+t;return n.length>=e?n:n+o(" ",e-n.length)}n.version="0.10.3";const s=Math.pow(2,32);function u(t,e){if(t>s||t<-s)return function(t,e){let n=""+Math.round(t);return n.length>=e?n:o("0",e-n.length)+n}(t,e);return function(t,e){let n=""+t;return n.length>=e?n:o("0",e-n.length)+n}(Math.round(t),e)}function l(t,e){return e=e||0,t.length>=7+e&&103==(32|t.charCodeAt(e))&&101==(32|t.charCodeAt(e+1))&&110==(32|t.charCodeAt(e+2))&&101==(32|t.charCodeAt(e+3))&&114==(32|t.charCodeAt(e+4))&&97==(32|t.charCodeAt(e+5))&&108==(32|t.charCodeAt(e+6))}const f=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function p(t){t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t[65535]="General"}const d={};function m(t,e,n){const r=t<0?-1:1;let o=t*r,i=0,a=1,c=0,s=1,u=0,l=0,f=Math.floor(o);for(;u<e&&(f=Math.floor(o),c=f*a+i,l=f*u+s,!(o-f<5e-8));)o=1/(o-f),i=a,a=c,s=u,u=l;if(l>e&&(u>e?(l=s,c=i):(l=u,c=a)),!n)return[0,r*c,l];const h=Math.floor(r*c/l);return[h,r*c-h*l,l]}function E(t,e,n){if(t>2958465||t<0)return null;let r=0|t,o=Math.floor(86400*(t-r)),i=0,a=[];const c={D:r,T:o,u:86400*(t-r)-o,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),e&&e.date1904&&(r+=1462),c.u>.9999&&(c.u=0,86400==++o&&(c.T=o=0,++r,++c.D)),60===r)a=n?[1317,10,29]:[1900,2,29],i=3;else if(0===r)a=n?[1317,8,29]:[1900,1,0],i=6;else{r>60&&--r;const t=new Date(1900,0,1);t.setDate(t.getDate()+r-1),a=[t.getFullYear(),t.getMonth()+1,t.getDate()],i=t.getDay(),r<60&&(i=(i+6)%7),n&&(i=0)}return c.y=a[0],c.m=a[1],c.d=a[2],c.S=o%60,o=Math.floor(o/60),c.M=o%60,o=Math.floor(o/60),c.H=o,c.q=i,c}p(d),n.parse_date_code=E;const g=new Date(1899,11,31,0,0,0),N=g.getTime(),v=new Date(1900,2,1,0,0,0);function O(t,e){let n=t.getTime();return e?n-=1262304e5:t>=v&&(n+=864e5),(n-(N+6e4*(t.getTimezoneOffset()-g.getTimezoneOffset())))/864e5}function R(t){return t.toString(10)}n._general_int=R;const A=function(){const t=/\.(\d*[1-9])0+$/,e=/\.0*$/,n=/\.(\d*[1-9])0+/,r=/\.0*[Ee]/,o=/(E[+-])(\d)$/;function i(n){return n.indexOf(".")>-1?n.replace(e,"").replace(t,".$1"):n}return function(e){let a,c=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return a=c>=-4&&c<=-1?e.toPrecision(10+c):Math.abs(c)<=9?function(t){const e=t<0?12:11;let n=i(t.toFixed(12));return n.length<=e?n:(n=t.toPrecision(10),n.length<=e?n:t.toExponential(5))}(e):10===c?e.toFixed(10).substr(0,12):function(e){let n=e.toFixed(11).replace(t,".$1");return n.length>(e<0?12:11)&&(n=e.toPrecision(6)),n}(e),i(function(t){for(let e=0;e!==t.length;++e)if(101==(32|t.charCodeAt(e)))return t.replace(n,".$1").replace(r,"E").replace("e","E").replace(o,"$10$2");return t}(a))}}();function y(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(0|t)===t?R(t):A(t);case"undefined":return"";case"object":if(null==t)return"";if(t instanceof Date)return x(14,O(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function T(t,e,n,r){let o,a="",c=0,s=0,u=n.y,l=0;switch(t){case 98:u=n.y+543;case 121:switch(e.length){case 1:case 2:o=u%100,l=2;break;default:o=u%1e4,l=4}break;case 109:switch(e.length){case 1:case 2:o=n.m,l=e.length;break;case 3:return h[n.m-1][1];case 5:return h[n.m-1][0];default:return h[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:o=n.d,l=e.length;break;case 3:return f[n.q][0];default:return f[n.q][1]}break;case 104:switch(e.length){case 1:case 2:o=1+(n.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:o=n.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:o=n.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if("s"!==e&&"ss"!==e&&".0"!==e&&".00"!==e&&".000"!==e)throw"bad second format: "+e;return 0!==n.u||"s"!==e&&"ss"!==e?(s=r>=2?3===r?1e3:100:1===r?10:1,c=Math.round(s*(n.S+n.u)),c>=60*s&&(c=0),"s"===e?0===c?"0":""+c/s:(a=i(c,2+r),"ss"===e?a.substr(0,2):"."+a.substr(2,e.length-1))):i(n.S,e.length);case 90:switch(e){case"[h]":case"[hh]":o=24*n.D+n.H;break;case"[m]":case"[mm]":o=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":o=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}l=3===e.length?1:2;break;case 101:o=u,l=1}return l>0?i(o,l):""}function M(t){if(t.length<=3)return t;let e=t.length%3,n=t.substr(0,e);for(;e!==t.length;e+=3)n+=(n.length>0?",":"")+t.substr(e,3);return n}n._general_num=A,n._general=y;const b=function(){const t=/%/g;const e=/# (\?+)( ?)\/( ?)(\d+)/;const n=/^#*0*\.([0#]+)/,s=/\).*[0#]/,l=/\(###\) ###\\?-####/;function f(t){let e,n="";for(let r=0;r!==t.length;++r)switch(e=t.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(e)}return n}function h(t,e){const n=Math.pow(10,e);return""+Math.round(t*n)/n}function p(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?0:Math.round((t-Math.floor(t))*Math.pow(10,e))}function d(E,g,N){if(40===E.charCodeAt(0)&&!g.match(s)){const t=g.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return N>=0?d("n",t,N):"("+d("n",t,-N)+")"}if(44===g.charCodeAt(g.length-1))return function(t,e,n){let r=e.length-1;for(;44===e.charCodeAt(r-1);)--r;return b(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}(E,g,N);if(-1!==g.indexOf("%"))return function(e,n,r){const i=n.replace(t,""),a=n.length-i.length;return b(e,i,r*Math.pow(10,2*a))+o("%",a)}(E,g,N);if(-1!==g.indexOf("E"))return function t(e,n){let r,o=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0===n)return"0.0E+0";if(n<0)return"-"+t(e,-n);let i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));let a=Math.floor(Math.log(n)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(n/Math.pow(10,a)).toPrecision(o+1+(i+a)%i),-1===r.indexOf("e")){const t=Math.floor(Math.log(n)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(t-r.length+a):r+="E+"+(t-a);"0."===r.substr(0,2);)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,n,r){return e+n+r.substr(0,(i+a)%i)+"."+r.substr(a)+"E"}))}else r=n.toExponential(o);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}(g,N);if(36===g.charCodeAt(0))return"$"+d(E,g.substr(" "==g.charAt(1)?2:1),N);let v,O,R,A,y=Math.abs(N),T=N<0?"-":"";if(g.match(/^00+$/))return T+u(y,g.length);if(g.match(/^[#?]+$/))return v=u(N,0),"0"===v&&(v=""),v.length>g.length?v:f(g.substr(0,g.length-v.length))+v;if(O=g.match(e))return function(t,e,n){const r=parseInt(t[4],10),c=Math.round(e*r),s=Math.floor(c/r);let u=c-s*r,l=r;return n+(0===s?"":""+s)+" "+(0===u?o(" ",t[1].length+1+t[4].length):a(u,t[1].length)+t[2]+"/"+t[3]+i(l,t[4].length))}(O,y,T);if(g.match(/^#+0+$/))return T+u(y,g.length-g.indexOf("0"));if(O=g.match(n))return v=h(N,O[1].length).replace(/^([^\.]+)$/,"$1."+f(O[1])).replace(/\.$/,"."+f(O[1])).replace(/\.(\d*)$/,(function(t,e){return"."+e+o("0",f(O[1]).length-e.length)})),-1!==g.indexOf("0.")?v:v.replace(/^0\./,".");if(g=g.replace(/^#+([0.])/,"$1"),O=g.match(/^(0*)\.(#*)$/))return T+h(y,O[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,O[1].length?"0.":".");if(O=g.match(/^#{1,3},##0(\.?)$/))return T+M(u(y,0));if(O=g.match(/^#,##0\.([#0]*0)$/))return N<0?"-"+d(E,g,-N):M(""+(Math.floor(N)+function(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}(N,O[1].length)))+"."+i(p(N,O[1].length),O[1].length);if(O=g.match(/^#,#*,#0/))return d(E,g.replace(/^#,#*,/,""),N);if(O=g.match(/^([0#]+)(\\?-([0#]+))+$/))return v=r(d(E,g.replace(/[\\-]/g,""),N)),R=0,r(r(g.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return R<v.length?v.charAt(R++):"0"===t?"0":""})));if(g.match(l))return v=d(E,"##########",N),"("+v.substr(0,3)+") "+v.substr(3,3)+"-"+v.substr(6);let I="";if(O=g.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return R=Math.min(O[4].length,7),A=m(y,Math.pow(10,R)-1,!1),v=""+T,I=b("n",O[1],A[1])," "===I.charAt(I.length-1)&&(I=I.substr(0,I.length-1)+"0"),v+=I+O[2]+"/"+O[3],I=c(A[2],R),I.length<O[4].length&&(I=f(O[4].substr(O[4].length-I.length))+I),v+=I,v;if(O=g.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return R=Math.min(Math.max(O[1].length,O[4].length),7),A=m(y,Math.pow(10,R)-1,!0),T+(A[0]||(A[1]?"":"0"))+" "+(A[1]?a(A[1],R)+O[2]+"/"+O[3]+c(A[2],R):o(" ",2*R+1+O[2].length+O[3].length));if(O=g.match(/^[#0?]+$/))return v=u(N,0),g.length<=v.length?v:f(g.substr(0,g.length-v.length))+v;if(O=g.match(/^([#0?]+)\.([#0]+)$/)){v=""+N.toFixed(Math.min(O[2].length,10)).replace(/([^0])0+$/,"$1"),R=v.indexOf(".");const t=g.indexOf(".")-R,e=g.length-v.length-t;return f(g.substr(0,t)+v+g.substr(g.length-e))}if(O=g.match(/^00,000\.([#0]*0)$/))return R=p(N,O[1].length),N<0?"-"+d(E,g,-N):M(function(t){return t<2147483647&&t>-2147483648?""+(t>=0?0|t:t-1|0):""+Math.floor(t)}(N)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?i(0,3-t.length):"")+t}))+"."+i(R,O[1].length);switch(g){case"###,##0.00":return d(E,"#,##0.00",N);case"###,###":case"##,###":case"#,###":const t=M(u(y,0));return"0"!==t?T+t:"";case"###,###.00":return d(E,"###,##0.00",N).replace(/^0\./,".");case"#,###.00":return d(E,"#,##0.00",N).replace(/^0\./,".")}throw new Error("unsupported format |"+g+"|")}function E(u,h,p){if(40===u.charCodeAt(0)&&!h.match(s)){const t=h.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return p>=0?E("n",t,p):"("+E("n",t,-p)+")"}if(44===h.charCodeAt(h.length-1))return function(t,e,n){let r=e.length-1;for(;44===e.charCodeAt(r-1);)--r;return b(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}(u,h,p);if(-1!==h.indexOf("%"))return function(e,n,r){const i=n.replace(t,""),a=n.length-i.length;return b(e,i,r*Math.pow(10,2*a))+o("%",a)}(u,h,p);if(-1!==h.indexOf("E"))return function t(e,n){let r,o=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0===n)return"0.0E+0";if(n<0)return"-"+t(e,-n);let i=e.indexOf(".");-1===i&&(i=e.indexOf("E"));let a=Math.floor(Math.log(n)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(n/Math.pow(10,a)).toPrecision(o+1+(i+a)%i),!r.match(/[Ee]/)){const t=Math.floor(Math.log(n)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(t-r.length+a):r+="E+"+(t-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,(function(t,e,n,r){return e+n+r.substr(0,(i+a)%i)+"."+r.substr(a)+"E"}))}else r=n.toExponential(o);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}(h,p);if(36===h.charCodeAt(0))return"$"+E(u,h.substr(" "==h.charAt(1)?2:1),p);let d,g,N,v,O=Math.abs(p),R=p<0?"-":"";if(h.match(/^00+$/))return R+i(O,h.length);if(h.match(/^[#?]+$/))return d=""+p,0===p&&(d=""),d.length>h.length?d:f(h.substr(0,h.length-d.length))+d;if(g=h.match(e))return function(t,e,n){return n+(0===e?"":""+e)+o(" ",t[1].length+2+t[4].length)}(g,O,R);if(h.match(/^#+0+$/))return R+i(O,h.length-h.indexOf("0"));if(g=h.match(n))return d=(""+p).replace(/^([^\.]+)$/,"$1."+f(g[1])).replace(/\.$/,"."+f(g[1])),d=d.replace(/\.(\d*)$/,(function(t,e){return"."+e+o("0",f(g[1]).length-e.length)})),-1!==h.indexOf("0.")?d:d.replace(/^0\./,".");if(h=h.replace(/^#+([0.])/,"$1"),g=h.match(/^(0*)\.(#*)$/))return R+(""+O).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,g[1].length?"0.":".");if(g=h.match(/^#{1,3},##0(\.?)$/))return R+M(""+O);if(g=h.match(/^#,##0\.([#0]*0)$/))return p<0?"-"+E(u,h,-p):M(""+p)+"."+o("0",g[1].length);if(g=h.match(/^#,#*,#0/))return E(u,h.replace(/^#,#*,/,""),p);if(g=h.match(/^([0#]+)(\\?-([0#]+))+$/))return d=r(E(u,h.replace(/[\\-]/g,""),p)),N=0,r(r(h.replace(/\\/g,"")).replace(/[0#]/g,(function(t){return N<d.length?d.charAt(N++):"0"===t?"0":""})));if(h.match(l))return d=E(u,"##########",p),"("+d.substr(0,3)+") "+d.substr(3,3)+"-"+d.substr(6);let A="";if(g=h.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return N=Math.min(g[4].length,7),v=m(O,Math.pow(10,N)-1,!1),d=""+R,A=b("n",g[1],v[1])," "==A.charAt(A.length-1)&&(A=A.substr(0,A.length-1)+"0"),d+=A+g[2]+"/"+g[3],A=c(v[2],N),A.length<g[4].length&&(A=f(g[4].substr(g[4].length-A.length))+A),d+=A,d;if(g=h.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return N=Math.min(Math.max(g[1].length,g[4].length),7),v=m(O,Math.pow(10,N)-1,!0),R+(v[0]||(v[1]?"":"0"))+" "+(v[1]?a(v[1],N)+g[2]+"/"+g[3]+c(v[2],N):o(" ",2*N+1+g[2].length+g[3].length));if(g=h.match(/^[#0?]+$/))return d=""+p,h.length<=d.length?d:f(h.substr(0,h.length-d.length))+d;if(g=h.match(/^([#0]+)\.([#0]+)$/)){d=""+p.toFixed(Math.min(g[2].length,10)).replace(/([^0])0+$/,"$1"),N=d.indexOf(".");let t=h.indexOf(".")-N,e=h.length-d.length-t;return f(h.substr(0,t)+d+h.substr(h.length-e))}if(g=h.match(/^00,000\.([#0]*0)$/))return p<0?"-"+E(u,h,-p):M(""+p).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,(function(t){return"00,"+(t.length<3?i(0,3-t.length):"")+t}))+"."+i(0,g[1].length);switch(h){case"###,###":case"##,###":case"#,###":const t=M(""+O);return"0"!==t?R+t:"";default:if(h.match(/\.[0#?]*$/))return E(u,h.slice(0,h.lastIndexOf(".")),p)+f(h.slice(h.lastIndexOf(".")))}throw new Error("unsupported format |"+h+"|")}return function(t,e,n){return(0|n)===n?E(t,e,n):d(t,e,n)}}();function I(t){const e=[];let n=!1,r=0;for(let o=0;o<t.length;++o)switch(t.charCodeAt(o)){case 34:n=!n;break;case 95:case 42:case 92:++o;break;case 59:e[e.length]=t.substr(r,o-r),r=o+1}if(e[e.length]=t.substr(r),!0===n)throw new Error("Format |"+t+"| unterminated string ");return e}n._split=I;const C=/\[[HhMmSs]*\]/;function S(t){let e=0,n="",r="";for(;e<t.length;)switch(n=t.charAt(e)){case"G":l(t,e)&&(e+=6),e++;break;case'"':for(;34!==t.charCodeAt(++e)&&e<t.length;)++e;++e;break;case"\\":case"_":e+=2;break;case"@":++e;break;case"B":case"b":if("1"===t.charAt(e+1)||"2"===t.charAt(e+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===t.substr(e,3).toUpperCase())return!0;if("AM/PM"===t.substr(e,5).toUpperCase())return!0;++e;break;case"[":for(r=n;"]"!==t.charAt(e++)&&e<t.length;)r+=t.charAt(e);if(r.match(C))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||"\\"==n&&"-"==t.charAt(e+1)&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e," "!==t.charAt(e)&&"*"!==t.charAt(e)||++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":default:++e}return!1}function w(t,e,n,r){let o,i,a,c=[],s="",u=0,f="",h="t",p="H";for(;u<t.length;)switch(f=t.charAt(u)){case"G":if(!l(t,u))throw new Error("unrecognized character "+f+" in "+t);c[c.length]={t:"G",v:"General"},u+=7;break;case'"':for(s="";34!==(a=t.charCodeAt(++u))&&u<t.length;)s+=String.fromCharCode(a);c[c.length]={t:"t",v:s},++u;break;case"\\":const i=t.charAt(++u),d="("===i||")"===i?i:"t";c[c.length]={t:d,v:i},++u;break;case"_":c[c.length]={t:"t",v:" "},u+=2;break;case"@":c[c.length]={t:"T",v:e},++u;break;case"B":case"b":if("1"===t.charAt(u+1)||"2"===t.charAt(u+1)){if(null==o&&(o=E(e,n,"2"===t.charAt(u+1)),null==o))return"";c[c.length]={t:"X",v:t.substr(u,2)},h=f,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0)return"";if(null==o&&(o=E(e,n),null==o))return"";for(s=f;++u<t.length&&t.charAt(u).toLowerCase()===f;)s+=f;"m"===f&&"h"===h.toLowerCase()&&(f="M"),"h"===f&&(f=p),c[c.length]={t:f,v:s},h=f;break;case"A":case"a":const m={t:f,v:f};if(null==o&&(o=E(e,n)),"A/P"===t.substr(u,3).toUpperCase()?(null!=o&&(m.v=o.H>=12?"P":"A"),m.t="T",p="h",u+=3):"AM/PM"===t.substr(u,5).toUpperCase()?(null!=o&&(m.v=o.H>=12?"PM":"AM"),m.t="T",u+=5,p="h"):(m.t="t",++u),null==o&&"T"===m.t)return"";c[c.length]=m,h=f;break;case"[":for(s=f;"]"!==t.charAt(u++)&&u<t.length;)s+=t.charAt(u);if("]"!==s.slice(-1))throw'unterminated "[" block: |'+s+"|";if(s.match(C)){if(null==o&&(o=E(e,n),null==o))return"";c[c.length]={t:"Z",v:s.toLowerCase()},h=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",S(t)||(c[c.length]={t:"t",v:s}));break;case".":if(null!=o){for(s=f;++u<t.length&&"0"===(f=t.charAt(u));)s+=f;c[c.length]={t:"s",v:s};break}case"0":case"#":for(s=f;++u<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(u))>-1||"\\"==f&&"-"==t.charAt(u+1)&&u<t.length-2&&"0#".indexOf(t.charAt(u+2))>-1;)s+=f;c[c.length]={t:"n",v:s};break;case"?":for(s=f;t.charAt(++u)===f;)s+=f;c[c.length]={t:f,v:s},h=f;break;case"*":++u," "!==t.charAt(u)&&"*"!==t.charAt(u)||++u;break;case"(":case")":c[c.length]={t:1===r||"number"==typeof e&&e<0?"t":f,v:f},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=f;u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1;)s+=t.charAt(u);c[c.length]={t:"D",v:s};break;case" ":c[c.length]={t:f,v:f},++u;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(f))throw new Error("unrecognized character "+f+" in "+t);c[c.length]={t:"t",v:f},++u}let d,m=0,g=0;for(u=c.length-1,h="t";u>=0;--u)switch(c[u].t){case"h":case"H":c[u].t=p,h="h",m<1&&(m=1);break;case"s":(d=c[u].v.match(/\.0+$/))&&(g=Math.max(g,d[0].length-1)),m<3&&(m=3);case"d":case"y":case"M":case"e":h=c[u].t;break;case"m":"s"===h&&(c[u].t="M",m<2&&(m=2));break;case"X":break;case"Z":m<1&&c[u].v.match(/[Hh]/)&&(m=1),m<2&&c[u].v.match(/[Mm]/)&&(m=2),m<3&&c[u].v.match(/[Ss]/)&&(m=3)}switch(m){case 0:break;case 1:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M),o.M>=60&&(o.M=0,++o.H);break;case 2:o.u>=.5&&(o.u=0,++o.S),o.S>=60&&(o.S=0,++o.M)}let N,v="";for(u=0;u<c.length;++u)switch(c[u].t){case"t":case"T":case" ":case"D":break;case"X":c[u].v="",c[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":c[u].v=T(c[u].t.charCodeAt(0),c[u].v,o,g),c[u].t="t";break;case"n":case"(":case"?":for(N=u+1;null!=c[N]&&("?"===(f=c[N].t)||"D"===f||(" "===f||"t"===f)&&null!=c[N+1]&&("?"===c[N+1].t||"t"===c[N+1].t&&"/"===c[N+1].v)||"("===c[u].t&&(" "===f||"n"===f||")"===f)||"t"===f&&("/"===c[N].v||" "===c[N].v&&null!=c[N+1]&&"?"===c[N+1].t));)c[u].v+=c[N].v,c[N]={v:"",t:";"},++N;v+=c[u].v,u=N-1;break;case"G":c[u].t="t",c[u].v=y(e,n)}let O,R,A="";if(v.length>0){40===v.charCodeAt(0)?(O=e<0&&45===v.charCodeAt(0)?-e:e,R=b("(",v,O)):(O=e<0&&r>1?-e:e,R=b("n",v,O),O<0&&c[0]&&"t"===c[0].t&&(R=R.substr(1),c[0].v="-"+c[0].v)),N=R.length-1;let t=c.length;for(u=0;u<c.length;++u)if(null!=c[u]&&"t"!==c[u].t&&c[u].v.indexOf(".")>-1){t=u;break}let n=c.length;if(t===c.length&&-1===R.indexOf("E")){for(u=c.length-1;u>=0;--u)null!=c[u]&&-1!=="n?(".indexOf(c[u].t)&&(N>=c[u].v.length-1?(N-=c[u].v.length,c[u].v=R.substr(N+1,c[u].v.length)):N<0?c[u].v="":(c[u].v=R.substr(0,N+1),N=-1),c[u].t="t",n=u);N>=0&&n<c.length&&(c[n].v=R.substr(0,N+1)+c[n].v)}else if(t!==c.length&&-1===R.indexOf("E")){for(N=R.indexOf(".")-1,u=t;u>=0;--u)if(null!=c[u]&&-1!=="n?(".indexOf(c[u].t)){for(i=c[u].v.indexOf(".")>-1&&u===t?c[u].v.indexOf(".")-1:c[u].v.length-1,A=c[u].v.substr(i+1);i>=0;--i)N>=0&&("0"===c[u].v.charAt(i)||"#"===c[u].v.charAt(i))&&(A=R.charAt(N--)+A);c[u].v=A,c[u].t="t",n=u}for(N>=0&&n<c.length&&(c[n].v=R.substr(0,N+1)+c[n].v),N=R.indexOf(".")+1,u=t;u<c.length;++u)if(null!=c[u]&&(-1!=="n?(".indexOf(c[u].t)||u===t)){for(i=c[u].v.indexOf(".")>-1&&u===t?c[u].v.indexOf(".")+1:0,A=c[u].v.substr(0,i);i<c[u].v.length;++i)N<R.length&&(A+=R.charAt(N++));c[u].v=A,c[u].t="t",n=u}}}for(u=0;u<c.length;++u)null!=c[u]&&"n(?".indexOf(c[u].t)>-1&&(O=r>1&&e<0&&u>0&&"-"===c[u-1].v?-e:e,c[u].v=b(c[u].t,c[u].v,O),c[u].t="t");let M="";for(u=0;u!==c.length;++u)null!=c[u]&&(M+=c[u].v);return M}n.is_date=S,n._eval=w;const U=/\[[=<>]/,L=/\[([=<>]*)(-?\d+\.?\d*)\]/;function _(t,e){if(null==e)return!1;const n=parseFloat(e[2]);switch(e[1]){case"=":if(t===n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!==n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0}return!1}function x(t,e,n){null==n&&(n={});let r="";switch(typeof t){case"string":r="m/d/yy"===t&&n.dateNF?n.dateNF:t;break;case"number":r=14===t&&n.dateNF?n.dateNF:(null!=n.table?n.table:d)[t]}if(l(r,0))return y(e,n);e instanceof Date&&(e=O(e,n.date1904));const o=function(t,e){let n=I(t),r=n.length,o=n[r-1].indexOf("@");if(r<4&&o>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if("number"!=typeof e)return[4,4===n.length||o>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=o>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=o>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=o>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}const i=e>0?n[0]:e<0?n[1]:n[2];if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return[r,i];if(null!=n[0].match(U)||null!=n[1].match(U)){const t=n[0].match(L),o=n[1].match(L);return _(e,t)?[r,n[0]]:_(e,o)?[r,n[1]]:[r,n[null!=t&&null!=o?2:1]]}return[r,i]}(r,e);if(l(o[1]))return y(e,n);if(!0===e)e="TRUE";else if(!1===e)e="FALSE";else if(""===e||null==e)return"";return w(o[1],e,n,o[0])}function k(t,e){if("number"!=typeof e){e=+e||-1;for(let n=0;n<392;++n)if(void 0!==d[n]){if(d[n]===t){e=n;break}}else e<0&&(e=n);e<0&&(e=391)}return d[e]=t,e}n.load=k,n._table=d,n.get_table=function(){return d},n.load_table=function(t){for(let e=0;392!==e;++e)void 0!==t[e]&&k(t[e],e)},n.init_table=p,n.format=x,t.exports=n},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,Factorials:a,Criteria:c,Address:s}=(n(6),n(2)),{Infix:u}=n(4),l=o,f=[],h=[];function p(t){return t<=100?a[t]:f[t]>0?f[t]:f[t]=p(t-1)*t}const d={ABS:t=>(t=l.accept(t,i.NUMBER),Math.abs(t)),AGGREGATE:(t,e,n,...r)=>{},ARABIC:t=>{if(t=l.accept(t,i.STRING).toUpperCase(),!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(t))throw new r("#VALUE!","Invalid roman numeral in ARABIC evaluation.");let e=0;return t.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(function(t){e+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]})),e},BASE:(t,e,n)=>{if((t=l.accept(t,i.NUMBER))<0||t>=2**53)throw r.NUM;if((e=l.accept(e,i.NUMBER))<2||e>36)throw r.NUM;if((n=l.accept(n,i.NUMBER,0))<0)throw r.NUM;const o=t.toString(e).toUpperCase();return new Array(Math.max(n+1-o.length,0)).join("0")+o},CEILING:(t,e)=>{if(t=l.accept(t,i.NUMBER),0===(e=l.accept(e,i.NUMBER)))return 0;if(t/e%1==0)return t;const n=Math.abs(e),r=Math.floor(Math.abs(t)/n);if(t<0){return e<0?-n*(r+1):-n*r}return(r+1)*n},"CEILING.MATH":(t,e,n)=>{if(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER,t>0?1:-1),n=l.accept(n,i.NUMBER,0),t>=0)return d.CEILING(t,e);const r=n?e:0;return d.CEILING(t,e)-r},"CEILING.PRECISE":(t,e)=>(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER,1),d.CEILING(t,Math.abs(e))),COMBIN:(t,e)=>{if(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER),t<0||e<0||t<e)throw r.NUM;return d.FACT(t)/d.FACT(e)/d.FACT(t-e)},COMBINA:(t,e)=>{if(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER),(0===t||1===t)&&0===e)return 1;if(t<0||e<0)throw r.NUM;return d.COMBIN(t+e-1,t-1)},DECIMAL:(t,e)=>{if(t=l.accept(t,i.STRING),e=l.accept(e,i.NUMBER),(e=Math.trunc(e))<2||e>36)throw r.NUM;const n=parseInt(t,e);if(isNaN(n))throw r.NUM;return n},DEGREES:t=>(t=l.accept(t,i.NUMBER))*(180/Math.PI),EVEN:t=>d.CEILING(t,-2),EXP:t=>(t=l.accept(t,i.NUMBER),Math.exp(t)),FACT:t=>{if(t=l.accept(t,i.NUMBER),(t=Math.trunc(t))>170||t<0)throw r.NUM;return t<=100?a[t]:p(t)},FACTDOUBLE:t=>{if(t=l.accept(t,i.NUMBER),(t=Math.trunc(t))<-1)throw r.NUM;return-1===t?1:function t(e){return 1===e||0===e?1:2===e?2:h[e]>0?h[e]:h[e]=t(e-2)*e}(t)},FLOOR:(t,e)=>{if(t=l.accept(t,i.NUMBER),0===(e=l.accept(e,i.NUMBER)))return 0;if(t>0&&e<0)throw r.NUM;if(t/e%1==0)return t;const n=Math.abs(e),o=Math.floor(Math.abs(t)/n);if(t<0){return e<0?-n*o:-n*(o+1)}return o*n},"FLOOR.MATH":(t,e,n)=>(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER,t>0?1:-1),0===(n=l.accept(n,i.NUMBER,0))||t>=0?d.FLOOR(t,Math.abs(e)):d.FLOOR(t,e)+e),"FLOOR.PRECISE":(t,e)=>(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER,1),d.FLOOR(t,Math.abs(e))),GCD:(...t)=>{const e=[];l.flattenParams(t,null,!1,t=>{if(t="boolean"==typeof t?NaN:Number(t),isNaN(t))throw r.VALUE;if(t<0||t>9007199254740990)throw r.NUM;e.push(Math.trunc(t))},0);let n,o,i=t.length,a=Math.abs(e[0]);for(n=1;n<i;n++){for(o=Math.abs(e[n]);a&&o;)a>o?a%=o:o%=a;a+=o}return a},INT:t=>(t=l.accept(t,i.NUMBER),Math.floor(t)),"ISO.CEILING":(...t)=>d["CEILING.PRECISE"](...t),LCM:(...t)=>{const e=[];l.flattenParams(t,null,!1,t=>{if(t="boolean"==typeof t?NaN:Number(t),isNaN(t))throw r.VALUE;if(t<0||t>9007199254740990)throw r.NUM;e.push(Math.trunc(t))},1);let n=e.length,o=Math.abs(e[0]);for(let t=1;t<n;t++){let n=Math.abs(e[t]),r=o;for(;o&&n;)o>n?o%=n:n%=o;o=Math.abs(r*e[t])/(o+n)}return o},LN:t=>(t=l.accept(t,i.NUMBER),Math.log(t)),LOG:(t,e)=>(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER,10),Math.log(t)/Math.log(e)),LOG10:t=>(t=l.accept(t,i.NUMBER),Math.log10(t)),MDETERM:t=>{if((t=l.accept(t,i.ARRAY,void 0,!1,!0))[0].length!==t.length)throw r.VALUE;const e=t.length,n=t[0].length;let o,a,c=0;if(1===e)return t[0][0];if(2===e)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(let r=0;r<n;r++){o=t[0][r],a=t[0][r];for(let i=1;i<e;i++)a*=t[i][((r+i)%n+n)%n],o*=t[i][((r-i)%n+n)%n];c+=a-o}return c},MINVERSE:t=>{},MMULT:(t,e)=>{t=l.accept(t,i.ARRAY,void 0,!1,!0),e=l.accept(e,i.ARRAY,void 0,!1,!0);const n=t.length,o=t[0].length,a=e.length,c=e[0].length,s=new Array(n);if(o!==a)throw r.VALUE;for(let i=0;i<n;i++){s[i]=new Array(c);for(let n=0;n<c;n++){s[i][n]=0;for(let a=0;a<o;a++){const o=t[i][a],c=e[a][n];if("number"!=typeof o||"number"!=typeof c)throw r.VALUE;s[i][n]+=t[i][a]*e[a][n]}}}return s},MOD:(t,e)=>{if(t=l.accept(t,i.NUMBER),0===(e=l.accept(e,i.NUMBER)))throw r.DIV0;return t-e*d.INT(t/e)},MROUND:(t,e)=>{if(t=l.accept(t,i.NUMBER),0===(e=l.accept(e,i.NUMBER)))return 0;if(t>0&&e<0||t<0&&e>0)throw r.NUM;return t/e%1==0?t:Math.round(t/e)*e},MULTINOMIAL:(...t)=>{let e=0,n=1;return l.flattenParams(t,i.NUMBER,!1,t=>{if(t<0)throw r.NUM;e+=t,n*=p(t)}),p(e)/n},MUNIT:t=>{t=l.accept(t,i.NUMBER);const e=[];for(let n=0;n<t;n++){const r=[];for(let e=0;e<t;e++)n===e?r.push(1):r.push(0);e.push(r)}return e},ODD:t=>{if(0===(t=l.accept(t,i.NUMBER)))return 1;let e=Math.ceil(Math.abs(t));return e=1&e?e:e+1,t>0?e:-e},PI:()=>Math.PI,POWER:(t,e)=>(t=l.accept(t,i.NUMBER))**(e=l.accept(e,i.NUMBER)),PRODUCT:(...t)=>{let e=1;return l.flattenParams(t,null,!0,(t,n)=>{const r=Number(t);n.isLiteral&&!isNaN(r)?e*=r:"number"==typeof t&&(e*=t)},1),e},QUOTIENT:(t,e)=>(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER),Math.trunc(t/e)),RADIANS:t=>(t=l.accept(t,i.NUMBER))/180*Math.PI,RAND:()=>Math.random(),RANDBETWEEN:(t,e)=>(t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER),Math.floor(Math.random()*(e-t+1)+t)),ROMAN:(t,e)=>{if(t=l.accept(t,i.NUMBER),0!==(e=l.accept(e,i.NUMBER,0)))throw Error("ROMAN: only allows form=0 (classic form).");const n=String(t).split(""),r=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let o="",a=3;for(;a--;)o=(r[+n.pop()+10*a]||"")+o;return new Array(+n.join("")+1).join("M")+o},ROUND:(t,e)=>{t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER);const n=Math.pow(10,Math.abs(e)),r=t>0?1:-1;return e>0?r*Math.round(Math.abs(t)*n)/n:0===e?r*Math.round(Math.abs(t)):r*Math.round(Math.abs(t)/n)*n},ROUNDDOWN:(t,e)=>{t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER);const n=Math.pow(10,Math.abs(e)),r=t>0?1:-1;if(e>0){const e=1/n*.5;return r*Math.round((Math.abs(t)-e)*n)/n}if(0===e){const e=.5;return r*Math.round(Math.abs(t)-e)}{const e=.5*n;return r*Math.round((Math.abs(t)-e)/n)*n}},ROUNDUP:(t,e)=>{t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER);const n=Math.pow(10,Math.abs(e)),r=t>0?1:-1;if(e>0){const e=1/n*.5;return r*Math.round((Math.abs(t)+e)*n)/n}if(0===e){const e=.5;return r*Math.round(Math.abs(t)+e)}{const e=.5*n;return r*Math.round((Math.abs(t)+e)/n)*n}},SERIESSUM:(t,e,n,o)=>{t=l.accept(t,i.NUMBER),e=l.accept(e,i.NUMBER),n=l.accept(n,i.NUMBER);let a,c=0;return l.flattenParams([o],i.NUMBER,!1,o=>{if("number"!=typeof o)throw r.VALUE;0===c?a=o*Math.pow(t,e):a+=o*Math.pow(t,e+c*n),c++}),a},SIGN:t=>(t=l.accept(t,i.NUMBER))>0?1:0===t?0:-1,SQRT:t=>{if((t=l.accept(t,i.NUMBER))<0)throw r.NUM;return Math.sqrt(t)},SQRTPI:t=>{if((t=l.accept(t,i.NUMBER))<0)throw r.NUM;return Math.sqrt(t*Math.PI)},SUBTOTAL:()=>{},SUM:(...t)=>{let e=0;return l.flattenParams(t,i.NUMBER,!0,(t,n)=>{n.isLiteral?e+=t:"number"==typeof t&&(e+=t)}),e},SUMIF:(t,e,n,r)=>{const o=l.retrieveRanges(t,e,r);e=o[0],r=o[1];const i=(n=l.retrieveArg(t,n)).isArray;n=c.parse(l.accept(n));let a=0;return e.forEach((t,e)=>{t.forEach((t,o)=>{const c=r[e][o];"number"==typeof c&&("wc"===n.op?n.match===n.value.test(t)&&(a+=c):u.compareOp(t,n.op,n.value,Array.isArray(t),i)&&(a+=c))})}),a},SUMIFS:()=>{},SUMPRODUCT:(t,...e)=>{t=l.accept(t,i.ARRAY,void 0,!1,!0),e.forEach(e=>{if(e=l.accept(e,i.ARRAY,void 0,!1,!0),t[0].length!==e[0].length||t.length!==e.length)throw r.VALUE;for(let n=0;n<t.length;n++)for(let r=0;r<t[0].length;r++)"number"!=typeof t[n][r]&&(t[n][r]=0),"number"!=typeof e[n][r]&&(e[n][r]=0),t[n][r]*=e[n][r]});let n=0;return t.forEach(t=>{t.forEach(t=>{n+=t})}),n},SUMSQ:(...t)=>{let e=0;return l.flattenParams(t,i.NUMBER,!0,(t,n)=>{n.isLiteral?e+=t**2:"number"==typeof t&&(e+=t**2)}),e},SUMX2MY2:(t,e)=>{const n=[],o=[];let i=0;if(l.flattenParams([t],null,!1,(t,e)=>{n.push(t)}),l.flattenParams([e],null,!1,(t,e)=>{o.push(t)}),n.length!==o.length)throw r.NA;for(let t=0;t<n.length;t++)"number"==typeof n[t]&&"number"==typeof o[t]&&(i+=n[t]**2-o[t]**2);return i},SUMX2PY2:(t,e)=>{const n=[],o=[];let i=0;if(l.flattenParams([t],null,!1,(t,e)=>{n.push(t)}),l.flattenParams([e],null,!1,(t,e)=>{o.push(t)}),n.length!==o.length)throw r.NA;for(let t=0;t<n.length;t++)"number"==typeof n[t]&&"number"==typeof o[t]&&(i+=n[t]**2+o[t]**2);return i},SUMXMY2:(t,e)=>{const n=[],o=[];let i=0;if(l.flattenParams([t],null,!1,(t,e)=>{n.push(t)}),l.flattenParams([e],null,!1,(t,e)=>{o.push(t)}),n.length!==o.length)throw r.NA;for(let t=0;t<n.length;t++)"number"==typeof n[t]&&"number"==typeof o[t]&&(i+=(n[t]-o[t])**2);return i},TRUNC:t=>(t=l.accept(t,i.NUMBER),Math.trunc(t))};t.exports=d},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,Factorials:a}=n(2),c=o,s={AND:(...t)=>{let e=c.accept(t.shift(),i.BOOLEAN);return t.forEach(t=>{e=e&&c.accept(t,i.BOOLEAN)}),e},FALSE:()=>!1,IF:(t,e,n,r)=>(e=c.accept(e,i.BOOLEAN),n=c.accept(n),r=c.accept(r,null,!1),e?n:r),IFERROR:(t,e)=>t.value instanceof r?c.accept(e):c.accept(t),IFNA:(t,e)=>t.value===r.NA?c.accept(e):c.accept(t),IFS:(...t)=>{},NOT:t=>!(t=c.accept(t,i.BOOLEAN)),OR:(...t)=>{let e=c.accept(t.shift(),i.BOOLEAN);return t.forEach(t=>{e=e||c.accept(t,i.BOOLEAN)}),e},SWITCH:(...t)=>{},TRUE:()=>!0,XOR:(...t)=>{}};t.exports=s},function(t,e,n){var r;t.exports=(function(t,e){var n=t.utils.isFunction;function r(t,e){return t-e}function o(t,n,r){return e.max(n,e.min(t,r))}t.sum=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.sumsqrd=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n]*t[n];return e},t.sumsqerr=function(e){for(var n,r=t.mean(e),o=0,i=e.length;--i>=0;)o+=(n=e[i]-r)*n;return o},t.sumrow=function(t){for(var e=0,n=t.length;--n>=0;)e+=t[n];return e},t.product=function(t){for(var e=1,n=t.length;--n>=0;)e*=t[n];return e},t.min=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]<e&&(e=t[n]);return e},t.max=function(t){for(var e=t[0],n=0;++n<t.length;)t[n]>e&&(e=t[n]);return e},t.unique=function(t){for(var e={},n=[],r=0;r<t.length;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n},t.mean=function(e){return t.sum(e)/e.length},t.meansqerr=function(e){return t.sumsqerr(e)/e.length},t.geomean=function(n){return e.pow(t.product(n),1/n.length)},t.median=function(t){var e=t.length,n=t.slice().sort(r);return 1&e?n[e/2|0]:(n[e/2-1]+n[e/2])/2},t.cumsum=function(e){return t.cumreduce(e,(function(t,e){return t+e}))},t.cumprod=function(e){return t.cumreduce(e,(function(t,e){return t*e}))},t.diff=function(t){var e,n=[],r=t.length;for(e=1;e<r;e++)n.push(t[e]-t[e-1]);return n},t.rank=function(t){for(var e,n=t.length,o=t.slice().sort(r),i=new Array(n),a=0;a<n;a++){var c=o.indexOf(t[a]),s=o.lastIndexOf(t[a]);e=c===s?c:(c+s)/2,i[a]=e+1}return i},t.mode=function(t){var e,n=t.length,o=t.slice().sort(r),i=1,a=0,c=0,s=[];for(e=0;e<n;e++)o[e]===o[e+1]?i++:(i>a?(s=[o[e]],a=i,c=0):i===a&&(s.push(o[e]),c++),i=1);return 0===c?s[0]:s},t.range=function(e){return t.max(e)-t.min(e)},t.variance=function(e,n){return t.sumsqerr(e)/(e.length-(n?1:0))},t.pooledvariance=function(e){return e.reduce((function(e,n){return e+t.sumsqerr(n)}),0)/(e.reduce((function(t,e){return t+e.length}),0)-e.length)},t.deviation=function(e){for(var n=t.mean(e),r=e.length,o=new Array(r),i=0;i<r;i++)o[i]=e[i]-n;return o},t.stdev=function(n,r){return e.sqrt(t.variance(n,r))},t.pooledstdev=function(n){return e.sqrt(t.pooledvariance(n))},t.meandev=function(n){for(var r=t.mean(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.mean(o)},t.meddev=function(n){for(var r=t.median(n),o=[],i=n.length-1;i>=0;i--)o.push(e.abs(n[i]-r));return t.median(o)},t.coeffvar=function(e){return t.stdev(e)/t.mean(e)},t.quartiles=function(t){var n=t.length,o=t.slice().sort(r);return[o[e.round(n/4)-1],o[e.round(n/2)-1],o[e.round(3*n/4)-1]]},t.quantiles=function(t,n,i,a){var c,s,u,l,f,h=t.slice().sort(r),p=[n.length],d=t.length;for(void 0===i&&(i=3/8),void 0===a&&(a=3/8),c=0;c<n.length;c++)u=d*(s=n[c])+(i+s*(1-i-a)),l=e.floor(o(u,1,d-1)),f=o(u-l,0,1),p[c]=(1-f)*h[l-1]+f*h[l];return p},t.percentile=function(t,e,n){var o=t.slice().sort(r),i=e*(o.length+(n?1:-1))+(n?0:1),a=parseInt(i),c=i-a;return a+1<o.length?o[a-1]+c*(o[a]-o[a-1]):o[a-1]},t.percentileOfScore=function(t,e,n){var r,o,i=0,a=t.length,c=!1;for("strict"===n&&(c=!0),o=0;o<a;o++)r=t[o],(c&&r<e||!c&&r<=e)&&i++;return i/a},t.histogram=function(n,r){r=r||4;var o,i=t.min(n),a=(t.max(n)-i)/r,c=n.length,s=[];for(o=0;o<r;o++)s[o]=0;for(o=0;o<c;o++)s[e.min(e.floor((n[o]-i)/a),r-1)]+=1;return s},t.covariance=function(e,n){var r,o=t.mean(e),i=t.mean(n),a=e.length,c=new Array(a);for(r=0;r<a;r++)c[r]=(e[r]-o)*(n[r]-i);return t.sum(c)/(a-1)},t.corrcoeff=function(e,n){return t.covariance(e,n)/t.stdev(e,1)/t.stdev(n,1)},t.spearmancoeff=function(e,n){return e=t.rank(e),n=t.rank(n),t.corrcoeff(e,n)},t.stanMoment=function(n,r){for(var o=t.mean(n),i=t.stdev(n),a=n.length,c=0,s=0;s<a;s++)c+=e.pow((n[s]-o)/i,r);return c/n.length},t.skewness=function(e){return t.stanMoment(e,3)},t.kurtosis=function(e){return t.stanMoment(e,4)-3};var i=t.prototype;!function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(r,o){var a=[],c=0,s=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(s,i[e].call(s,r))})),this;if(this.length>1){for(s=!0===r?this:this.transpose();c<s.length;c++)a[c]=t[e](s[c]);return a}return t[e](this[0],r)}}(e[r])}("cumsum cumprod".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(r,o){var a=[],c=0,s=this;if(n(r)&&(o=r,r=!1),o)return setTimeout((function(){o.call(s,i[e].call(s,r))})),this;if(this.length>1){for("sumrow"!==e&&(s=!0===r?this:this.transpose());c<s.length;c++)a[c]=t[e](s[c]);return!0===r?t[e](t.utils.toVector(a)):a}return t[e](this[0],r)}}(e[r])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(e){for(var r=0;r<e.length;r++)!function(e){i[e]=function(){var r,o=[],a=0,c=this,s=Array.prototype.slice.call(arguments);if(n(s[s.length-1])){r=s[s.length-1];var u=s.slice(0,s.length-1);return setTimeout((function(){r.call(c,i[e].apply(c,u))})),this}r=void 0;var l=function(n){return t[e].apply(c,[n].concat(s))};if(this.length>1){for(c=c.transpose();a<c.length;a++)o[a]=l(c[a]);return o}return l(this[0])}}(e[r])}("quantiles percentileOfScore".split(" "))}(r=function(t,e){var n=Array.prototype.concat,r=Array.prototype.slice,o=Object.prototype.toString;function i(e,n){var r=e>n?e:n;return t.pow(10,17-~~(t.log(r>0?r:-r)*t.LOG10E))}var a=Array.isArray||function(t){return"[object Array]"===o.call(t)};function c(t){return"[object Function]"===o.call(t)}function s(t){return"number"==typeof t&&t-t==0}function u(){return new u._init(arguments)}function l(){return 0}function f(){return 1}function h(t,e){return t===e?1:0}u.fn=u.prototype,u._init=function(t){if(a(t[0]))if(a(t[0][0])){c(t[1])&&(t[0]=u.map(t[0],t[1]));for(var e=0;e<t[0].length;e++)this[e]=t[0][e];this.length=t[0].length}else this[0]=c(t[1])?u.map(t[0],t[1]):t[0],this.length=1;else if(s(t[0]))this[0]=u.seq.apply(null,t),this.length=1;else{if(t[0]instanceof u)return u(t[0].toArray());this[0]=[],this.length=1}return this},u._init.prototype=u.prototype,u._init.constructor=u,u.utils={calcRdx:i,isArray:a,isFunction:c,isNumber:s,toVector:function(t){return n.apply([],t)}},u._random_fn=t.random,u.setRandom=function(t){if("function"!=typeof t)throw new TypeError("fn is not a function");u._random_fn=t},u.extend=function(t){var e,n;if(1===arguments.length){for(n in t)u[n]=t[n];return this}for(e=1;e<arguments.length;e++)for(n in arguments[e])t[n]=arguments[e][n];return t},u.rows=function(t){return t.length||1},u.cols=function(t){return t[0].length||1},u.dimensions=function(t){return{rows:u.rows(t),cols:u.cols(t)}},u.row=function(t,e){return a(e)?e.map((function(e){return u.row(t,e)})):t[e]},u.rowa=function(t,e){return u.row(t,e)},u.col=function(t,e){if(a(e)){var n=u.arange(t.length).map((function(){return new Array(e.length)}));return e.forEach((function(e,r){u.arange(t.length).forEach((function(o){n[o][r]=t[o][e]}))})),n}for(var r=new Array(t.length),o=0;o<t.length;o++)r[o]=[t[o][e]];return r},u.cola=function(t,e){return u.col(t,e).map((function(t){return t[0]}))},u.diag=function(t){for(var e=u.rows(t),n=new Array(e),r=0;r<e;r++)n[r]=[t[r][r]];return n},u.antidiag=function(t){for(var e=u.rows(t)-1,n=new Array(e),r=0;e>=0;e--,r++)n[r]=[t[r][e]];return n},u.transpose=function(t){var e,n,r,o,i,c=[];for(a(t[0])||(t=[t]),n=t.length,r=t[0].length,i=0;i<r;i++){for(e=new Array(n),o=0;o<n;o++)e[o]=t[o][i];c.push(e)}return 1===c.length?c[0]:c},u.map=function(t,e,n){var r,o,i,c,s;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,c=n?t:new Array(o),r=0;r<o;r++)for(c[r]||(c[r]=new Array(i)),s=0;s<i;s++)c[r][s]=e(t[r][s],r,s);return 1===c.length?c[0]:c},u.cumreduce=function(t,e,n){var r,o,i,c,s;for(a(t[0])||(t=[t]),o=t.length,i=t[0].length,c=n?t:new Array(o),r=0;r<o;r++)for(c[r]||(c[r]=new Array(i)),i>0&&(c[r][0]=t[r][0]),s=1;s<i;s++)c[r][s]=e(c[r][s-1],t[r][s]);return 1===c.length?c[0]:c},u.alter=function(t,e){return u.map(t,e,!0)},u.create=function(t,e,n){var r,o,i=new Array(t);for(c(e)&&(n=e,e=t),r=0;r<t;r++)for(i[r]=new Array(e),o=0;o<e;o++)i[r][o]=n(r,o);return i},u.zeros=function(t,e){return s(e)||(e=t),u.create(t,e,l)},u.ones=function(t,e){return s(e)||(e=t),u.create(t,e,f)},u.rand=function(t,e){return s(e)||(e=t),u.create(t,e,u._random_fn)},u.identity=function(t,e){return s(e)||(e=t),u.create(t,e,h)},u.symmetric=function(t){var e,n,r=t.length;if(t.length!==t[0].length)return!1;for(e=0;e<r;e++)for(n=0;n<r;n++)if(t[n][e]!==t[e][n])return!1;return!0},u.clear=function(t){return u.alter(t,l)},u.seq=function(t,e,n,r){c(r)||(r=!1);var o,a=[],s=i(t,e),u=(e*s-t*s)/((n-1)*s),l=t;for(o=0;l<=e&&o<n;l=(t*s+u*s*++o)/s)a.push(r?r(l,o):l);return a},u.arange=function(t,e,n){var r,o=[];if(n=n||1,void 0===e&&(e=t,t=0),t===e||0===n)return[];if(t<e&&n<0)return[];if(t>e&&n>0)return[];if(n>0)for(r=t;r<e;r+=n)o.push(r);else for(r=t;r>e;r+=n)o.push(r);return o},u.slice=function(){function t(t,e,n,r){var o,i=[],a=t.length;if(void 0===e&&void 0===n&&void 0===r)return u.copy(t);if(r=r||1,(e=(e=e||0)>=0?e:a+e)===(n=(n=n||t.length)>=0?n:a+n)||0===r)return[];if(e<n&&r<0)return[];if(e>n&&r>0)return[];if(r>0)for(o=e;o<n;o+=r)i.push(t[o]);else for(o=e;o>n;o+=r)i.push(t[o]);return i}return function(e,n){var r,o;return s((n=n||{}).row)?s(n.col)?e[n.row][n.col]:t(u.rowa(e,n.row),(r=n.col||{}).start,r.end,r.step):s(n.col)?t(u.cola(e,n.col),(o=n.row||{}).start,o.end,o.step):(o=n.row||{},r=n.col||{},t(e,o.start,o.end,o.step).map((function(e){return t(e,r.start,r.end,r.step)})))}}(),u.sliceAssign=function(e,n,r){var o,i;if(s(n.row)){if(s(n.col))return e[n.row][n.col]=r;n.col=n.col||{},n.col.start=n.col.start||0,n.col.end=n.col.end||e[0].length,n.col.step=n.col.step||1,o=u.arange(n.col.start,t.min(e.length,n.col.end),n.col.step);var a=n.row;return o.forEach((function(t,n){e[a][t]=r[n]})),e}if(s(n.col)){n.row=n.row||{},n.row.start=n.row.start||0,n.row.end=n.row.end||e.length,n.row.step=n.row.step||1,i=u.arange(n.row.start,t.min(e[0].length,n.row.end),n.row.step);var c=n.col;return i.forEach((function(t,n){e[t][c]=r[n]})),e}return void 0===r[0].length&&(r=[r]),n.row.start=n.row.start||0,n.row.end=n.row.end||e.length,n.row.step=n.row.step||1,n.col.start=n.col.start||0,n.col.end=n.col.end||e[0].length,n.col.step=n.col.step||1,i=u.arange(n.row.start,t.min(e.length,n.row.end),n.row.step),o=u.arange(n.col.start,t.min(e[0].length,n.col.end),n.col.step),i.forEach((function(t,n){o.forEach((function(o,i){e[t][o]=r[n][i]}))})),e},u.diagonal=function(t){var e=u.zeros(t.length,t.length);return t.forEach((function(t,n){e[n][n]=t})),e},u.copy=function(t){return t.map((function(t){return s(t)?t:t.map((function(t){return t}))}))};var p=u.prototype;return p.length=0,p.push=Array.prototype.push,p.sort=Array.prototype.sort,p.splice=Array.prototype.splice,p.slice=Array.prototype.slice,p.toArray=function(){return this.length>1?r.call(this):r.call(this)[0]},p.map=function(t,e){return u(u.map(this,t,e))},p.cumreduce=function(t,e){return u(u.cumreduce(this,t,e))},p.alter=function(t){return u.alter(this,t),this},function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e){var n,r=this;return e?(setTimeout((function(){e.call(r,p[t].call(r))})),this):(n=u[t](this),a(n)?u(n):n)}}(t[e])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(e,n){var r=this;return n?(setTimeout((function(){n.call(r,p[t].call(r,e))})),this):u(u[t](this,e))}}(t[e])}("row col".split(" ")),function(t){for(var e=0;e<t.length;e++)!function(t){p[t]=function(){return u(u[t].apply(null,arguments))}}(t[e])}("create zeros ones rand identity".split(" ")),u}(Math),Math),function(t,e){t.gammaln=function(t){var n,r,o,i=0,a=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],c=1.000000000190015;for(o=(r=n=t)+5.5,o-=(n+.5)*e.log(o);i<6;i++)c+=a[i]/++r;return e.log(2.5066282746310007*c/n)-o},t.loggam=function(t){var n,r,o,i,a,c,s,u=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(n=t,s=0,1==t||2==t)return 0;for(t<=7&&(n=t+(s=e.floor(7-t))),r=1/(n*n),o=2*e.PI,a=u[9],c=8;c>=0;c--)a*=r,a+=u[c];if(i=a/n+.5*e.log(o)+(n-.5)*e.log(n)-n,t<=7)for(c=1;c<=s;c++)i-=e.log(n-1),n-=1;return i},t.gammafn=function(t){var n,r,o,i,a=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],c=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,u=0,l=0,f=0,h=t;if(h<=0){if(!(i=h%1+36e-17))return 1/0;s=(1&h?-1:1)*e.PI/e.sin(e.PI*i),h=1-h}for(o=h,r=h<1?h++:(h-=u=(0|h)-1)-1,n=0;n<8;++n)f=(f+a[n])*r,l=l*r+c[n];if(i=f/l+1,o<h)i/=o;else if(o>h)for(n=0;n<u;++n)i*=h,h++;return s&&(i=s/i),i},t.gammap=function(e,n){return t.lowRegGamma(e,n)*t.gammafn(e)},t.lowRegGamma=function(n,r){var o,i=t.gammaln(n),a=n,c=1/n,s=c,u=r+1-n,l=1/1e-30,f=1/u,h=f,p=1,d=-~(8.5*e.log(n>=1?n:1/n)+.4*n+17);if(r<0||n<=0)return NaN;if(r<n+1){for(;p<=d;p++)c+=s*=r/++a;return c*e.exp(-r+n*e.log(r)-i)}for(;p<=d;p++)h*=(f=1/(f=(o=-p*(p-n))*f+(u+=2)))*(l=u+o/l);return 1-h*e.exp(-r+n*e.log(r)-i)},t.factorialln=function(e){return e<0?NaN:t.gammaln(e+1)},t.factorial=function(e){return e<0?NaN:t.gammafn(e+1)},t.combination=function(n,r){return n>170||r>170?e.exp(t.combinationln(n,r)):t.factorial(n)/t.factorial(r)/t.factorial(n-r)},t.combinationln=function(e,n){return t.factorialln(e)-t.factorialln(n)-t.factorialln(e-n)},t.permutation=function(e,n){return t.factorial(e)/t.factorial(e-n)},t.betafn=function(n,r){if(!(n<=0||r<=0))return n+r>170?e.exp(t.betaln(n,r)):t.gammafn(n)*t.gammafn(r)/t.gammafn(n+r)},t.betaln=function(e,n){return t.gammaln(e)+t.gammaln(n)-t.gammaln(e+n)},t.betacf=function(t,n,r){var o,i,a,c,s=1,u=n+r,l=n+1,f=n-1,h=1,p=1-u*t/l;for(e.abs(p)<1e-30&&(p=1e-30),c=p=1/p;s<=100&&(p=1+(i=s*(r-s)*t/((f+(o=2*s))*(n+o)))*p,e.abs(p)<1e-30&&(p=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),c*=(p=1/p)*h,p=1+(i=-(n+s)*(u+s)*t/((n+o)*(l+o)))*p,e.abs(p)<1e-30&&(p=1e-30),h=1+i/h,e.abs(h)<1e-30&&(h=1e-30),c*=a=(p=1/p)*h,!(e.abs(a-1)<3e-7));s++);return c},t.gammapinv=function(n,r){var o,i,a,c,s,u,l=0,f=r-1,h=t.gammaln(r);if(n>=1)return e.max(100,r+100*e.sqrt(r));if(n<=0)return 0;for(r>1?(s=e.log(f),u=e.exp(f*(s-1)-h),c=n<.5?n:1-n,o=(2.30753+.27061*(i=e.sqrt(-2*e.log(c))))/(1+i*(.99229+.04481*i))-i,n<.5&&(o=-o),o=e.max(.001,r*e.pow(1-1/(9*r)-o/(3*e.sqrt(r)),3))):o=n<(i=1-r*(.253+.12*r))?e.pow(n/i,1/r):1-e.log(1-(n-i)/(1-i));l<12;l++){if(o<=0)return 0;if((o-=i=(a=(t.lowRegGamma(r,o)-n)/(i=r>1?u*e.exp(-(o-f)+f*(e.log(o)-s)):e.exp(-o+f*e.log(o)-h)))/(1-.5*e.min(1,a*((r-1)/o-1))))<=0&&(o=.5*(o+i)),e.abs(i)<1e-8*o)break}return o},t.erf=function(t){var n,r,o,i,a=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],c=a.length-1,s=!1,u=0,l=0;for(t<0&&(t=-t,s=!0),r=4*(n=2/(2+t))-2;c>0;c--)o=u,u=r*u-l+a[c],l=o;return i=n*e.exp(-t*t+.5*(a[0]+r*u)-l),s?i-1:1-i},t.erfc=function(e){return 1-t.erf(e)},t.erfcinv=function(n){var r,o,i,a,c=0;if(n>=2)return-100;if(n<=0)return 100;for(a=n<1?n:2-n,r=-.70711*((2.30753+.27061*(i=e.sqrt(-2*e.log(a/2))))/(1+i*(.99229+.04481*i))-i);c<2;c++)r+=(o=t.erfc(r)-a)/(1.1283791670955126*e.exp(-r*r)-r*o);return n<1?r:-r},t.ibetainv=function(n,r,o){var i,a,c,s,u,l,f,h,p,d,m=r-1,E=o-1,g=0;if(n<=0)return 0;if(n>=1)return 1;for(r>=1&&o>=1?(c=n<.5?n:1-n,l=(2.30753+.27061*(s=e.sqrt(-2*e.log(c))))/(1+s*(.99229+.04481*s))-s,n<.5&&(l=-l),f=(l*l-3)/6,h=2/(1/(2*r-1)+1/(2*o-1)),p=l*e.sqrt(f+h)/h-(1/(2*o-1)-1/(2*r-1))*(f+5/6-2/(3*h)),l=r/(r+o*e.exp(2*p))):(i=e.log(r/(r+o)),a=e.log(o/(r+o)),l=n<(s=e.exp(r*i)/r)/(p=s+(u=e.exp(o*a)/o))?e.pow(r*p*n,1/r):1-e.pow(o*p*(1-n),1/o)),d=-t.gammaln(r)-t.gammaln(o)+t.gammaln(r+o);g<10;g++){if(0===l||1===l)return l;if((l-=s=(u=(t.ibeta(l,r,o)-n)/(s=e.exp(m*e.log(l)+E*e.log(1-l)+d)))/(1-.5*e.min(1,u*(m/l-E/(1-l)))))<=0&&(l=.5*(l+s)),l>=1&&(l=.5*(l+s+1)),e.abs(s)<1e-8*l&&g>0)break}return l},t.ibeta=function(n,r,o){var i=0===n||1===n?0:e.exp(t.gammaln(r+o)-t.gammaln(r)-t.gammaln(o)+r*e.log(n)+o*e.log(1-n));return!(n<0||n>1)&&(n<(r+1)/(r+o+2)?i*t.betacf(n,r,o)/r:1-i*t.betacf(1-n,o,r)/o)},t.randn=function(n,r){var o,i,a,c,s;if(r||(r=n),n)return t.create(n,r,(function(){return t.randn()}));do{o=t._random_fn(),i=1.7156*(t._random_fn()-.5),s=(a=o-.449871)*a+(c=e.abs(i)+.386595)*(.196*c-.25472*a)}while(s>.27597&&(s>.27846||i*i>-4*e.log(o)*o*o));return i/o},t.randg=function(n,r,o){var i,a,c,s,u,l,f=n;if(o||(o=r),n||(n=1),r)return(l=t.zeros(r,o)).alter((function(){return t.randg(n)})),l;n<1&&(n+=1),i=n-1/3,a=1/e.sqrt(9*i);do{do{s=1+a*(u=t.randn())}while(s<=0);s*=s*s,c=t._random_fn()}while(c>1-.331*e.pow(u,4)&&e.log(c)>.5*u*u+i*(1-s+e.log(s)));if(n==f)return i*s;do{c=t._random_fn()}while(0===c);return e.pow(c,1/f)*i*s},function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t.map(this,(function(n){return t[e](n)})))}}(e[n])}("gammaln gammafn factorial factorialln".split(" ")),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(){return t(t[e].apply(null,arguments))}}(e[n])}("randn".split(" "))}(r,Math),function(t,e){function n(t,n,r,o){for(var i,a=0,c=1,s=1,u=1,l=0,f=0;e.abs((s-f)/s)>o;)f=s,c=u+(i=-(n+l)*(n+r+l)*t/(n+2*l)/(n+2*l+1))*c,s=(a=s+i*a)+(i=(l+=1)*(r-l)*t/(n+2*l-1)/(n+2*l))*s,a/=u=c+i*u,c/=u,s/=u,u=1;return s/n}function r(n,r,o){var i=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],a=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],c=.5*n;if(c>=8)return 1;var s,u=2*t.normal.cdf(c,0,1,1,0)-1;u=u>=e.exp(-50/o)?e.pow(u,o):0;for(var l=c,f=(8-c)/(s=n>3?2:3),h=l+f,p=0,d=o-1,m=1;m<=s;m++){for(var E=0,g=.5*(h+l),N=.5*(h-l),v=1;v<=12;v++){var O,R=g+N*(6<v?i[(O=12-v+1)-1]:-i[(O=v)-1]),A=R*R;if(A>60)break;var y=2*t.normal.cdf(R,0,1,1,0)*.5-2*t.normal.cdf(R,n,1,1,0)*.5;y>=e.exp(-30/d)&&(E+=y=a[O-1]*e.exp(-.5*A)*e.pow(y,d))}p+=E*=2*N*o/e.sqrt(2*e.PI),l=h,h+=f}return(u+=p)<=e.exp(-30/r)?0:(u=e.pow(u,r))>=1?1:u}!function(e){for(var n=0;n<e.length;n++)!function(e){t[e]=function(t,e,n){return this instanceof arguments.callee?(this._a=t,this._b=e,this._c=n,this):new arguments.callee(t,e,n)},t.fn[e]=function(n,r,o){var i=t[e](n,r,o);return i.data=this,i},t[e].prototype.sample=function(n){var r=this._a,o=this._b,i=this._c;return n?t.alter(n,(function(){return t[e].sample(r,o,i)})):t[e].sample(r,o,i)},function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(r){var o=this._a,i=this._b,a=this._c;return r||0===r||(r=this.data),"number"!=typeof r?t.fn.map.call(r,(function(r){return t[e][n](r,o,i,a)})):t[e][n](r,o,i,a)}}(n[r])}("pdf cdf inv".split(" ")),function(n){for(var r=0;r<n.length;r++)!function(n){t[e].prototype[n]=function(){return t[e][n](this._a,this._b,this._c)}}(n[r])}("mean median mode variance".split(" "))}(e[n])}("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),t.extend(t.beta,{pdf:function(n,r,o){return n>1||n<0?0:1==r&&1==o?1:r<512&&o<512?e.pow(n,r-1)*e.pow(1-n,o-1)/t.betafn(r,o):e.exp((r-1)*e.log(n)+(o-1)*e.log(1-n)-t.betaln(r,o))},cdf:function(e,n,r){return e>1||e<0?1*(e>1):t.ibeta(e,n,r)},inv:function(e,n,r){return t.ibetainv(e,n,r)},mean:function(t,e){return t/(t+e)},median:function(e,n){return t.ibetainv(.5,e,n)},mode:function(t,e){return(t-1)/(t+e-2)},sample:function(e,n){var r=t.randg(e);return r/(r+t.randg(n))},variance:function(t,n){return t*n/(e.pow(t+n,2)*(t+n+1))}}),t.extend(t.centralF,{pdf:function(n,r,o){var i;return n<0?0:r<=2?0===n&&r<2?1/0:0===n&&2===r?1:1/t.betafn(r/2,o/2)*e.pow(r/o,r/2)*e.pow(n,r/2-1)*e.pow(1+r/o*n,-(r+o)/2):(i=r*n/(o+n*r),r*(o/(o+n*r))/2*t.binomial.pdf((r-2)/2,(r+o-2)/2,i))},cdf:function(e,n,r){return e<0?0:t.ibeta(n*e/(n*e+r),n/2,r/2)},inv:function(e,n,r){return r/(n*(1/t.ibetainv(e,n/2,r/2)-1))},mean:function(t,e){return e>2?e/(e-2):void 0},mode:function(t,e){return t>2?e*(t-2)/(t*(e+2)):void 0},sample:function(e,n){return 2*t.randg(e/2)/e/(2*t.randg(n/2)/n)},variance:function(t,e){if(!(e<=4))return 2*e*e*(t+e-2)/(t*(e-2)*(e-2)*(e-4))}}),t.extend(t.cauchy,{pdf:function(t,n,r){return r<0?0:r/(e.pow(t-n,2)+e.pow(r,2))/e.PI},cdf:function(t,n,r){return e.atan((t-n)/r)/e.PI+.5},inv:function(t,n,r){return n+r*e.tan(e.PI*(t-.5))},median:function(t){return t},mode:function(t){return t},sample:function(n,r){return t.randn()*e.sqrt(1/(2*t.randg(.5)))*r+n}}),t.extend(t.chisquare,{pdf:function(n,r){return n<0?0:0===n&&2===r?.5:e.exp((r/2-1)*e.log(n)-n/2-r/2*e.log(2)-t.gammaln(r/2))},cdf:function(e,n){return e<0?0:t.lowRegGamma(n/2,e/2)},inv:function(e,n){return 2*t.gammapinv(e,.5*n)},mean:function(t){return t},median:function(t){return t*e.pow(1-2/(9*t),3)},mode:function(t){return t-2>0?t-2:0},sample:function(e){return 2*t.randg(e/2)},variance:function(t){return 2*t}}),t.extend(t.exponential,{pdf:function(t,n){return t<0?0:n*e.exp(-n*t)},cdf:function(t,n){return t<0?0:1-e.exp(-n*t)},inv:function(t,n){return-e.log(1-t)/n},mean:function(t){return 1/t},median:function(t){return 1/t*e.log(2)},mode:function(){return 0},sample:function(n){return-1/n*e.log(t._random_fn())},variance:function(t){return e.pow(t,-2)}}),t.extend(t.gamma,{pdf:function(n,r,o){return n<0?0:0===n&&1===r?1/o:e.exp((r-1)*e.log(n)-n/o-t.gammaln(r)-r*e.log(o))},cdf:function(e,n,r){return e<0?0:t.lowRegGamma(n,e/r)},inv:function(e,n,r){return t.gammapinv(e,n)*r},mean:function(t,e){return t*e},mode:function(t,e){if(t>1)return(t-1)*e},sample:function(e,n){return t.randg(e)*n},variance:function(t,e){return t*e*e}}),t.extend(t.invgamma,{pdf:function(n,r,o){return n<=0?0:e.exp(-(r+1)*e.log(n)-o/n-t.gammaln(r)+r*e.log(o))},cdf:function(e,n,r){return e<=0?0:1-t.lowRegGamma(n,r/e)},inv:function(e,n,r){return r/t.gammapinv(1-e,n)},mean:function(t,e){return t>1?e/(t-1):void 0},mode:function(t,e){return e/(t+1)},sample:function(e,n){return n/t.randg(e)},variance:function(t,e){if(!(t<=2))return e*e/((t-1)*(t-1)*(t-2))}}),t.extend(t.kumaraswamy,{pdf:function(t,n,r){return 0===t&&1===n?r:1===t&&1===r?n:e.exp(e.log(n)+e.log(r)+(n-1)*e.log(t)+(r-1)*e.log(1-e.pow(t,n)))},cdf:function(t,n,r){return t<0?0:t>1?1:1-e.pow(1-e.pow(t,n),r)},inv:function(t,n,r){return e.pow(1-e.pow(1-t,1/r),1/n)},mean:function(e,n){return n*t.gammafn(1+1/e)*t.gammafn(n)/t.gammafn(1+1/e+n)},median:function(t,n){return e.pow(1-e.pow(2,-1/n),1/t)},mode:function(t,n){if(t>=1&&n>=1&&1!==t&&1!==n)return e.pow((t-1)/(t*n-1),1/t)},variance:function(){throw new Error("variance not yet implemented")}}),t.extend(t.lognormal,{pdf:function(t,n,r){return t<=0?0:e.exp(-e.log(t)-.5*e.log(2*e.PI)-e.log(r)-e.pow(e.log(t)-n,2)/(2*r*r))},cdf:function(n,r,o){return n<0?0:.5+.5*t.erf((e.log(n)-r)/e.sqrt(2*o*o))},inv:function(n,r,o){return e.exp(-1.4142135623730951*o*t.erfcinv(2*n)+r)},mean:function(t,n){return e.exp(t+n*n/2)},median:function(t){return e.exp(t)},mode:function(t,n){return e.exp(t-n*n)},sample:function(n,r){return e.exp(t.randn()*r+n)},variance:function(t,n){return(e.exp(n*n)-1)*e.exp(2*t+n*n)}}),t.extend(t.noncentralt,{pdf:function(n,r,o){return e.abs(o)<1e-14?t.studentt.pdf(n,r):e.abs(n)<1e-14?e.exp(t.gammaln((r+1)/2)-o*o/2-.5*e.log(e.PI*r)-t.gammaln(r/2)):r/n*(t.noncentralt.cdf(n*e.sqrt(1+2/r),r+2,o)-t.noncentralt.cdf(n,r,o))},cdf:function(n,r,o){if(e.abs(o)<1e-14)return t.studentt.cdf(n,r);var i=!1;n<0&&(i=!0,o=-o);for(var a=t.normal.cdf(-o,0,1),c=1e-14+1,s=c,u=n*n/(n*n+r),l=0,f=e.exp(-o*o/2),h=e.exp(-o*o/2-.5*e.log(2)-t.gammaln(1.5))*o;l<200||s>1e-14||c>1e-14;)s=c,l>0&&(f*=o*o/(2*l),h*=o*o/(2*(l+.5))),a+=.5*(c=f*t.beta.cdf(u,l+.5,r/2)+h*t.beta.cdf(u,l+1,r/2)),l++;return i?1-a:a}}),t.extend(t.normal,{pdf:function(t,n,r){return e.exp(-.5*e.log(2*e.PI)-e.log(r)-e.pow(t-n,2)/(2*r*r))},cdf:function(n,r,o){return.5*(1+t.erf((n-r)/e.sqrt(2*o*o)))},inv:function(e,n,r){return-1.4142135623730951*r*t.erfcinv(2*e)+n},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},sample:function(e,n){return t.randn()*n+e},variance:function(t,e){return e*e}}),t.extend(t.pareto,{pdf:function(t,n,r){return t<n?0:r*e.pow(n,r)/e.pow(t,r+1)},cdf:function(t,n,r){return t<n?0:1-e.pow(n/t,r)},inv:function(t,n,r){return n/e.pow(1-t,1/r)},mean:function(t,n){if(!(n<=1))return n*e.pow(t,n)/(n-1)},median:function(t,n){return t*(n*e.SQRT2)},mode:function(t){return t},variance:function(t,n){if(!(n<=2))return t*t*n/(e.pow(n-1,2)*(n-2))}}),t.extend(t.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(e.sqrt(r)*t.betafn(.5,r/2))*e.pow(1+n*n/r,-(r+1)/2)},cdf:function(n,r){var o=r/2;return t.ibeta((n+e.sqrt(n*n+r))/(2*e.sqrt(n*n+r)),o,o)},inv:function(n,r){var o=t.ibetainv(2*e.min(n,1-n),.5*r,.5);return o=e.sqrt(r*(1-o)/o),n>.5?o:-o},mean:function(t){return t>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return t.randn()*e.sqrt(n/(2*t.randg(n/2)))},variance:function(t){return t>2?t/(t-2):t>1?1/0:void 0}}),t.extend(t.weibull,{pdf:function(t,n,r){return t<0||n<0||r<0?0:r/n*e.pow(t/n,r-1)*e.exp(-e.pow(t/n,r))},cdf:function(t,n,r){return t<0?0:1-e.exp(-e.pow(t/n,r))},inv:function(t,n,r){return n*e.pow(-e.log(1-t),1/r)},mean:function(e,n){return e*t.gammafn(1+1/n)},median:function(t,n){return t*e.pow(e.log(2),1/n)},mode:function(t,n){return n<=1?0:t*e.pow((n-1)/n,1/n)},sample:function(n,r){return n*e.pow(-e.log(t._random_fn()),1/r)},variance:function(n,r){return n*n*t.gammafn(1+2/r)-e.pow(t.weibull.mean(n,r),2)}}),t.extend(t.uniform,{pdf:function(t,e,n){return t<e||t>n?0:1/(n-e)},cdf:function(t,e,n){return t<e?0:t<n?(t-e)/(n-e):1},inv:function(t,e,n){return e+t*(n-e)},mean:function(t,e){return.5*(t+e)},median:function(e,n){return t.mean(e,n)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(e,n){return e/2+n/2+(n/2-e/2)*(2*t._random_fn()-1)},variance:function(t,n){return e.pow(n-t,2)/12}}),t.extend(t.binomial,{pdf:function(n,r,o){return 0===o||1===o?r*o===n?1:0:t.combination(r,n)*e.pow(o,n)*e.pow(1-o,r-n)},cdf:function(r,o,i){var a;if(r<0)return 0;if(r>=o)return 1;if(i<0||i>1||o<=0)return NaN;var c=i,s=(r=e.floor(r))+1,u=o-r,l=s+u,f=e.exp(t.gammaln(l)-t.gammaln(u)-t.gammaln(s)+s*e.log(c)+u*e.log(1-c));return a=c<(s+1)/(l+2)?f*n(c,s,u,1e-10):1-f*n(1-c,u,s,1e-10),e.round(1e10*(1-a))/1e10}}),t.extend(t.negbin,{pdf:function(n,r,o){return n===n>>>0&&(n<0?0:t.combination(n+r-1,r-1)*e.pow(1-o,n)*e.pow(o,r))},cdf:function(e,n,r){var o=0,i=0;if(e<0)return 0;for(;i<=e;i++)o+=t.negbin.pdf(i,n,r);return o}}),t.extend(t.hypgeom,{pdf:function(n,r,o,i){if(n!=n|0)return!1;if(n<0||n<o-(r-i))return 0;if(n>i||n>o)return 0;if(2*o>r)return 2*i>r?t.hypgeom.pdf(r-o-i+n,r,r-o,r-i):t.hypgeom.pdf(i-n,r,r-o,i);if(2*i>r)return t.hypgeom.pdf(o-n,r,o,r-i);if(o<i)return t.hypgeom.pdf(n,r,i,o);for(var a=1,c=0,s=0;s<n;s++){for(;a>1&&c<i;)a*=1-o/(r-c),c++;a*=(i-s)*(o-s)/((s+1)*(r-o-i+s+1))}for(;c<i;c++)a*=1-o/(r-c);return e.min(1,e.max(0,a))},cdf:function(n,r,o,i){if(n<0||n<o-(r-i))return 0;if(n>=i||n>=o)return 1;if(2*o>r)return 2*i>r?t.hypgeom.cdf(r-o-i+n,r,r-o,r-i):1-t.hypgeom.cdf(i-n-1,r,r-o,i);if(2*i>r)return 1-t.hypgeom.cdf(o-n-1,r,o,r-i);if(o<i)return t.hypgeom.cdf(n,r,i,o);for(var a=1,c=1,s=0,u=0;u<n;u++){for(;a>1&&s<i;){var l=1-o/(r-s);c*=l,a*=l,s++}a+=c*=(i-u)*(o-u)/((u+1)*(r-o-i+u+1))}for(;s<i;s++)a*=1-o/(r-s);return e.min(1,e.max(0,a))}}),t.extend(t.poisson,{pdf:function(n,r){return r<0||n%1!=0||n<0?0:e.pow(r,n)*e.exp(-r)/t.factorial(n)},cdf:function(e,n){var r=[],o=0;if(e<0)return 0;for(;o<=e;o++)r.push(t.poisson.pdf(o,n));return t.sum(r)},mean:function(t){return t},variance:function(t){return t},sampleSmall:function(n){var r=1,o=0,i=e.exp(-n);do{o++,r*=t._random_fn()}while(r>i);return o-1},sampleLarge:function(n){var r,o,i,a,c,s,u,l,f,h,p=n;for(a=e.sqrt(p),c=e.log(p),s=.02483*(u=.931+2.53*a)-.059,l=1.1239+1.1328/(u-3.4),f=.9277-3.6224/(u-2);;){if(o=e.random()-.5,i=e.random(),h=.5-e.abs(o),r=e.floor((2*s/h+u)*o+p+.43),h>=.07&&i<=f)return r;if(!(r<0||h<.013&&i>h)&&e.log(i)+e.log(l)-e.log(s/(h*h)+u)<=r*c-p-t.loggam(r+1))return r}},sample:function(t){return t<10?this.sampleSmall(t):this.sampleLarge(t)}}),t.extend(t.triangular,{pdf:function(t,e,n,r){return n<=e||r<e||r>n?NaN:t<e||t>n?0:t<r?2*(t-e)/((n-e)*(r-e)):t===r?2/(n-e):2*(n-t)/((n-e)*(n-r))},cdf:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=n?0:t>=r?1:t<=o?e.pow(t-n,2)/((r-n)*(o-n)):1-e.pow(r-t,2)/((r-n)*(r-o))},inv:function(t,n,r,o){return r<=n||o<n||o>r?NaN:t<=(o-n)/(r-n)?n+(r-n)*e.sqrt(t*((o-n)/(r-n))):n+(r-n)*(1-e.sqrt((1-t)*(1-(o-n)/(r-n))))},mean:function(t,e,n){return(t+e+n)/3},median:function(t,n,r){return r<=(t+n)/2?n-e.sqrt((n-t)*(n-r))/e.sqrt(2):r>(t+n)/2?t+e.sqrt((n-t)*(r-t))/e.sqrt(2):void 0},mode:function(t,e,n){return n},sample:function(n,r,o){var i=t._random_fn();return i<(o-n)/(r-n)?n+e.sqrt(i*(r-n)*(o-n)):r-e.sqrt((1-i)*(r-n)*(r-o))},variance:function(t,e,n){return(t*t+e*e+n*n-t*e-t*n-e*n)/18}}),t.extend(t.arcsine,{pdf:function(t,n,r){return r<=n?NaN:t<=n||t>=r?0:2/e.PI*e.pow(e.pow(r-n,2)-e.pow(2*t-n-r,2),-.5)},cdf:function(t,n,r){return t<n?0:t<r?2/e.PI*e.asin(e.sqrt((t-n)/(r-n))):1},inv:function(t,n,r){return n+(.5-.5*e.cos(e.PI*t))*(r-n)},mean:function(t,e){return e<=t?NaN:(t+e)/2},median:function(t,e){return e<=t?NaN:(t+e)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*e.sin(2*e.PI*t.uniform.sample(0,1))},variance:function(t,n){return n<=t?NaN:e.pow(n-t,2)/8}}),t.extend(t.laplace,{pdf:function(t,n,r){return r<=0?0:e.exp(-e.abs(t-n)/r)/(2*r)},cdf:function(t,n,r){return r<=0?0:t<n?.5*e.exp((t-n)/r):1-.5*e.exp(-(t-n)/r)},mean:function(t){return t},median:function(t){return t},mode:function(t){return t},variance:function(t,e){return 2*e*e},sample:function(n,r){var o,i=t._random_fn()-.5;return n-r*((o=i)/e.abs(o))*e.log(1-2*e.abs(i))}}),t.extend(t.tukey,{cdf:function(n,o,i){var a=o,c=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],s=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(i<2||a<2)return NaN;if(!Number.isFinite(n))return 1;if(i>25e3)return r(n,1,a);var u,l=.5*i,f=l*e.log(i)-i*e.log(2)-t.gammaln(l),h=l-1,p=.25*i;u=i<=100?1:i<=800?.5:i<=5e3?.25:.125,f+=e.log(u);for(var d=0,m=1;m<=50;m++){for(var E=0,g=(2*m-1)*u,N=1;N<=16;N++){var v,O;8<N?(v=N-8-1,O=f+h*e.log(g+c[v]*u)-(c[v]*u+g)*p):(v=N-1,O=f+h*e.log(g-c[v]*u)+(c[v]*u-g)*p),O>=-30&&(E+=r(8<N?n*e.sqrt(.5*(c[v]*u+g)):n*e.sqrt(.5*(-c[v]*u+g)),1,a)*s[v]*e.exp(O))}if(m*u>=1&&E<=1e-14)break;d+=E}if(E>1e-14)throw new Error("tukey.cdf failed to converge");return d>1&&(d=1),d},inv:function(n,r,o){if(o<2||r<2)return NaN;if(n<0||n>1)return NaN;if(0===n)return 0;if(1===n)return 1/0;var i,a=function(t,n,r){var o=.5-.5*t,i=e.sqrt(e.log(1/(o*o))),a=i+((((-453642210148e-16*i-.204231210125)*i-.342242088547)*i-1)*i+.322232421088)/((((.0038560700634*i+.10353775285)*i+.531103462366)*i+.588581570495)*i+.099348462606);r<120&&(a+=(a*a*a+a)/r/4);var c=.8832-.2368*a;return r<120&&(c+=-1.214/r+1.208*a/r),a*(c*e.log(n-1)+1.4142)}(n,r,o),c=t.tukey.cdf(a,r,o)-n;i=c>0?e.max(0,a-1):a+1;for(var s,u=t.tukey.cdf(i,r,o)-n,l=1;l<50;l++)if(s=i-u*(i-a)/(u-c),c=u,a=i,s<0&&(s=0,u=-n),u=t.tukey.cdf(s,r,o)-n,i=s,e.abs(i-a)<1e-4)return s;throw new Error("tukey.inv failed to converge")}})}(r,Math),function(t,e){var n,r,o=Array.prototype.push,i=t.utils.isArray;function a(e){return i(e)||e instanceof t}t.extend({add:function(e,n){return a(n)?(a(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t+n[e][r]}))):t.map(e,(function(t){return t+n}))},subtract:function(e,n){return a(n)?(a(n[0])||(n=[n]),t.map(e,(function(t,e,r){return t-n[e][r]||0}))):t.map(e,(function(t){return t-n}))},divide:function(e,n){return a(n)?(a(n[0])||(n=[n]),t.multiply(e,t.inv(n))):t.map(e,(function(t){return t/n}))},multiply:function(e,n){var r,o,i,c,s,u,l,f;if(void 0===e.length&&void 0===n.length)return e*n;if(s=e.length,u=e[0].length,l=t.zeros(s,i=a(n)?n[0].length:u),f=0,a(n)){for(;f<i;f++)for(r=0;r<s;r++){for(c=0,o=0;o<u;o++)c+=e[r][o]*n[o][f];l[r][f]=c}return 1===s&&1===f?l[0][0]:l}return t.map(e,(function(t){return t*n}))},outer:function(e,n){return t.multiply(e.map((function(t){return[t]})),[n])},dot:function(e,n){a(e[0])||(e=[e]),a(n[0])||(n=[n]);for(var r,o,i=1===e[0].length&&1!==e.length?t.transpose(e):e,c=1===n[0].length&&1!==n.length?t.transpose(n):n,s=[],u=0,l=i.length,f=i[0].length;u<l;u++){for(s[u]=[],r=0,o=0;o<f;o++)r+=i[u][o]*c[u][o];s[u]=r}return 1===s.length?s[0]:s},pow:function(n,r){return t.map(n,(function(t){return e.pow(t,r)}))},exp:function(n){return t.map(n,(function(t){return e.exp(t)}))},log:function(n){return t.map(n,(function(t){return e.log(t)}))},abs:function(n){return t.map(n,(function(t){return e.abs(t)}))},norm:function(t,n){var r=0,o=0;for(isNaN(n)&&(n=2),a(t[0])&&(t=t[0]);o<t.length;o++)r+=e.pow(e.abs(t[o]),n);return e.pow(r,1/n)},angle:function(n,r){return e.acos(t.dot(n,r)/(t.norm(n)*t.norm(r)))},aug:function(t,e){var n,r=[];for(n=0;n<t.length;n++)r.push(t[n].slice());for(n=0;n<r.length;n++)o.apply(r[n],e[n]);return r},inv:function(e){for(var n,r=e.length,o=e[0].length,i=t.identity(r,o),a=t.gauss_jordan(e,i),c=[],s=0;s<r;s++)for(c[s]=[],n=o;n<a[0].length;n++)c[s][n-o]=a[s][n];return c},det:function(t){var e,n=t.length,r=2*n,o=new Array(r),i=n-1,a=r-1,c=i-n+1,s=a,u=0,l=0;if(2===n)return t[0][0]*t[1][1]-t[0][1]*t[1][0];for(;u<r;u++)o[u]=1;for(u=0;u<n;u++){for(e=0;e<n;e++)o[c<0?c+n:c]*=t[u][e],o[s<n?s+n:s]*=t[u][e],c++,s--;c=--i-n+1,s=--a}for(u=0;u<n;u++)l+=o[u];for(;u<r;u++)l-=o[u];return l},gauss_elimination:function(n,r){var o,i,a,c,s=0,u=0,l=n.length,f=n[0].length,h=1,p=0,d=[];for(o=(n=t.aug(n,r))[0].length,s=0;s<l;s++){for(i=n[s][s],u=s,c=s+1;c<f;c++)i<e.abs(n[c][s])&&(i=n[c][s],u=c);if(u!=s)for(c=0;c<o;c++)a=n[s][c],n[s][c]=n[u][c],n[u][c]=a;for(u=s+1;u<l;u++)for(h=n[u][s]/n[s][s],c=s;c<o;c++)n[u][c]=n[u][c]-h*n[s][c]}for(s=l-1;s>=0;s--){for(p=0,u=s+1;u<=l-1;u++)p+=d[u]*n[s][u];d[s]=(n[s][o-1]-p)/n[s][s]}return d},gauss_jordan:function(n,r){var o,i,a,c=t.aug(n,r),s=c.length,u=c[0].length,l=0;for(i=0;i<s;i++){var f=i;for(a=i+1;a<s;a++)e.abs(c[a][i])>e.abs(c[f][i])&&(f=a);var h=c[i];for(c[i]=c[f],c[f]=h,a=i+1;a<s;a++)for(l=c[a][i]/c[i][i],o=i;o<u;o++)c[a][o]-=c[i][o]*l}for(i=s-1;i>=0;i--){for(l=c[i][i],a=0;a<i;a++)for(o=u-1;o>i-1;o--)c[a][o]-=c[i][o]*c[a][i]/l;for(c[i][i]/=l,o=s;o<u;o++)c[i][o]/=l}return c},triaUpSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map((function(t){return t[0]})),a=!0),t.arange(o-1,-1,-1).forEach((function(a){r=t.arange(a+1,o).map((function(t){return i[t]*e[a][t]})),i[a]=(n[a]-t.sum(r))/e[a][a]})),a?i.map((function(t){return[t]})):i},triaLowSolve:function(e,n){var r,o=e[0].length,i=t.zeros(1,o)[0],a=!1;return null!=n[0].length&&(n=n.map((function(t){return t[0]})),a=!0),t.arange(o).forEach((function(o){r=t.arange(o).map((function(t){return e[o][t]*i[t]})),i[o]=(n[o]-t.sum(r))/e[o][o]})),a?i.map((function(t){return[t]})):i},lu:function(e){var n,r=e.length,o=t.identity(r),i=t.zeros(e.length,e[0].length);return t.arange(r).forEach((function(t){i[0][t]=e[0][t]})),t.arange(1,r).forEach((function(a){t.arange(a).forEach((function(r){n=t.arange(r).map((function(t){return o[a][t]*i[t][r]})),o[a][r]=(e[a][r]-t.sum(n))/i[r][r]})),t.arange(a,r).forEach((function(r){n=t.arange(a).map((function(t){return o[a][t]*i[t][r]})),i[a][r]=e[n.length][r]-t.sum(n)}))})),[o,i]},cholesky:function(n){var r,o=n.length,i=t.zeros(n.length,n[0].length);return t.arange(o).forEach((function(a){r=t.arange(a).map((function(t){return e.pow(i[a][t],2)})),i[a][a]=e.sqrt(n[a][a]-t.sum(r)),t.arange(a+1,o).forEach((function(e){r=t.arange(a).map((function(t){return i[a][t]*i[e][t]})),i[e][a]=(n[a][e]-t.sum(r))/i[a][a]}))})),i},gauss_jacobi:function(n,r,o,i){for(var a,c,s,u,l=0,f=0,h=n.length,p=[],d=[],m=[];l<h;l++)for(p[l]=[],d[l]=[],m[l]=[],f=0;f<h;f++)l>f?(p[l][f]=n[l][f],d[l][f]=m[l][f]=0):l<f?(d[l][f]=n[l][f],p[l][f]=m[l][f]=0):(m[l][f]=n[l][f],p[l][f]=d[l][f]=0);for(s=t.multiply(t.multiply(t.inv(m),t.add(p,d)),-1),c=t.multiply(t.inv(m),r),a=o,u=t.add(t.multiply(s,o),c),l=2;e.abs(t.norm(t.subtract(u,a)))>i;)a=u,u=t.add(t.multiply(s,a),c),l++;return u},gauss_seidel:function(n,r,o,i){for(var a,c,s,u,l,f=0,h=n.length,p=[],d=[],m=[];f<h;f++)for(p[f]=[],d[f]=[],m[f]=[],a=0;a<h;a++)f>a?(p[f][a]=n[f][a],d[f][a]=m[f][a]=0):f<a?(d[f][a]=n[f][a],p[f][a]=m[f][a]=0):(m[f][a]=n[f][a],p[f][a]=d[f][a]=0);for(u=t.multiply(t.multiply(t.inv(t.add(m,p)),d),-1),s=t.multiply(t.inv(t.add(m,p)),r),c=o,l=t.add(t.multiply(u,o),s),f=2;e.abs(t.norm(t.subtract(l,c)))>i;)c=l,l=t.add(t.multiply(u,c),s),f+=1;return l},SOR:function(n,r,o,i,a){for(var c,s,u,l,f,h=0,p=n.length,d=[],m=[],E=[];h<p;h++)for(d[h]=[],m[h]=[],E[h]=[],c=0;c<p;c++)h>c?(d[h][c]=n[h][c],m[h][c]=E[h][c]=0):h<c?(m[h][c]=n[h][c],d[h][c]=E[h][c]=0):(E[h][c]=n[h][c],d[h][c]=m[h][c]=0);for(l=t.multiply(t.inv(t.add(E,t.multiply(d,a))),t.subtract(t.multiply(E,1-a),t.multiply(m,a))),u=t.multiply(t.multiply(t.inv(t.add(E,t.multiply(d,a))),r),a),s=o,f=t.add(t.multiply(l,o),u),h=2;e.abs(t.norm(t.subtract(f,s)))>i;)s=f,f=t.add(t.multiply(l,s),u),h++;return f},householder:function(n){for(var r,o,i,a,c=n.length,s=n[0].length,u=0,l=[],f=[];u<c-1;u++){for(r=0,a=u+1;a<s;a++)r+=n[a][u]*n[a][u];for(r=(n[u+1][u]>0?-1:1)*e.sqrt(r),o=e.sqrt((r*r-n[u+1][u]*r)/2),(l=t.zeros(c,1))[u+1][0]=(n[u+1][u]-r)/(2*o),i=u+2;i<c;i++)l[i][0]=n[i][u]/(2*o);f=t.subtract(t.identity(c,s),t.multiply(t.multiply(l,t.transpose(l)),2)),n=t.multiply(f,t.multiply(n,f))}return n},QR:(n=t.sum,r=t.arange,function(o){var i,a,c,s=o.length,u=o[0].length,l=t.zeros(u,u);for(o=t.copy(o),a=0;a<u;a++){for(l[a][a]=e.sqrt(n(r(s).map((function(t){return o[t][a]*o[t][a]})))),i=0;i<s;i++)o[i][a]=o[i][a]/l[a][a];for(c=a+1;c<u;c++)for(l[a][c]=n(r(s).map((function(t){return o[t][a]*o[t][c]}))),i=0;i<s;i++)o[i][c]=o[i][c]-o[i][a]*l[a][c]}return[o,l]}),lstsq:function(e,n){var r=!1;void 0===n[0].length&&(n=n.map((function(t){return[t]})),r=!0);var o=t.QR(e),i=o[0],a=o[1],c=e[0].length,s=t.slice(i,{col:{end:c}}),u=function(e){var n=(e=t.copy(e)).length,r=t.identity(n);return t.arange(n-1,-1,-1).forEach((function(n){t.sliceAssign(r,{row:n},t.divide(t.slice(r,{row:n}),e[n][n])),t.sliceAssign(e,{row:n},t.divide(t.slice(e,{row:n}),e[n][n])),t.arange(n).forEach((function(o){var i=t.multiply(e[o][n],-1),a=t.slice(e,{row:o}),c=t.multiply(t.slice(e,{row:n}),i);t.sliceAssign(e,{row:o},t.add(a,c));var s=t.slice(r,{row:o}),u=t.multiply(t.slice(r,{row:n}),i);t.sliceAssign(r,{row:o},t.add(s,u))}))})),r}(t.slice(a,{row:{end:c}})),l=t.transpose(s);void 0===l[0].length&&(l=[l]);var f=t.multiply(t.multiply(u,l),n);return void 0===f.length&&(f=[[f]]),r?f.map((function(t){return t[0]})):f},jacobi:function(n){for(var r,o,i,a,c,s,u,l=1,f=n.length,h=t.identity(f,f),p=[];1===l;){for(c=n[0][1],i=0,a=1,r=0;r<f;r++)for(o=0;o<f;o++)r!=o&&c<e.abs(n[r][o])&&(c=e.abs(n[r][o]),i=r,a=o);for(s=n[i][i]===n[a][a]?n[i][a]>0?e.PI/4:-e.PI/4:e.atan(2*n[i][a]/(n[i][i]-n[a][a]))/2,(u=t.identity(f,f))[i][i]=e.cos(s),u[i][a]=-e.sin(s),u[a][i]=e.sin(s),u[a][a]=e.cos(s),h=t.multiply(h,u),n=t.multiply(t.multiply(t.inv(u),n),u),l=0,r=1;r<f;r++)for(o=1;o<f;o++)r!=o&&e.abs(n[r][o])>.001&&(l=1)}for(r=0;r<f;r++)p.push(n[r][r]);return[h,p]},rungekutta:function(t,e,n,r,o,i){var a,c,s;if(2===i)for(;r<=n;)o+=((a=e*t(r,o))+(c=e*t(r+e,o+a)))/2,r+=e;if(4===i)for(;r<=n;)o+=((a=e*t(r,o))+2*(c=e*t(r+e/2,o+a/2))+2*(s=e*t(r+e/2,o+c/2))+e*t(r+e,o+s))/6,r+=e;return o},romberg:function(t,n,r,o){for(var i,a,c,s,u,l=0,f=(r-n)/2,h=[],p=[],d=[];l<o/2;){for(u=t(n),c=n,s=0;c<=r;c+=f,s++)h[s]=c;for(i=h.length,c=1;c<i-1;c++)u+=(c%2!=0?4:2)*t(h[c]);u=f/3*(u+t(r)),d[l]=u,f/=2,l++}for(a=d.length,i=1;1!==a;){for(c=0;c<a-1;c++)p[c]=(e.pow(4,i)*d[c+1]-d[c])/(e.pow(4,i)-1);a=p.length,d=p,p=[],i++}return d},richardson:function(t,n,r,o){function i(t,e){for(var n,r=0,o=t.length;r<o;r++)t[r]===e&&(n=r);return n}for(var a,c,s,u,l,f=e.abs(r-t[i(t,r)+1]),h=0,p=[],d=[];o>=f;)a=i(t,r+o),c=i(t,r),p[h]=(n[a]-2*n[c]+n[2*c-a])/(o*o),o/=2,h++;for(u=p.length,s=1;1!=u;){for(l=0;l<u-1;l++)d[l]=(e.pow(4,s)*p[l+1]-p[l])/(e.pow(4,s)-1);u=d.length,p=d,d=[],s++}return p},simpson:function(t,e,n,r){for(var o,i=(n-e)/r,a=t(e),c=[],s=e,u=0,l=1;s<=n;s+=i,u++)c[u]=s;for(o=c.length;l<o-1;l++)a+=(l%2!=0?4:2)*t(c[l]);return i/3*(a+t(n))},hermite:function(t,e,n,r){for(var o,i=t.length,a=0,c=0,s=[],u=[],l=[],f=[];c<i;c++){for(s[c]=1,o=0;o<i;o++)c!=o&&(s[c]*=(r-t[o])/(t[c]-t[o]));for(u[c]=0,o=0;o<i;o++)c!=o&&(u[c]+=1/(t[c]-t[o]));l[c]=(1-2*(r-t[c])*u[c])*(s[c]*s[c]),f[c]=(r-t[c])*(s[c]*s[c]),a+=l[c]*e[c]+f[c]*n[c]}return a},lagrange:function(t,e,n){for(var r,o,i=0,a=0,c=t.length;a<c;a++){for(o=e[a],r=0;r<c;r++)a!=r&&(o*=(n-t[r])/(t[a]-t[r]));i+=o}return i},cubic_spline:function(e,n,r){for(var o,i,a=e.length,c=0,s=[],u=[],l=[],f=[],h=[],p=[];c<a-1;c++)f[c]=e[c+1]-e[c];for(l[0]=0,c=1;c<a-1;c++)l[c]=3/f[c]*(n[c+1]-n[c])-3/f[c-1]*(n[c]-n[c-1]);for(c=1;c<a-1;c++)s[c]=[],u[c]=[],s[c][c-1]=f[c-1],s[c][c]=2*(f[c-1]+f[c]),s[c][c+1]=f[c],u[c][0]=l[c];for(i=t.multiply(t.inv(s),u),o=0;o<a-1;o++)h[o]=(n[o+1]-n[o])/f[o]-f[o]*(i[o+1][0]+2*i[o][0])/3,p[o]=(i[o+1][0]-i[o][0])/(3*f[o]);for(o=0;o<a&&!(e[o]>r);o++);return n[o-=1]+(r-e[o])*h[o]+t.sq(r-e[o])*i[o]+(r-e[o])*t.sq(r-e[o])*p[o]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(e){var n,r,o,i,a,c=e.length,s=e[0].length,u=0,l=[],f=[],h=[],p=[],d=[],m=[],E=[];for(u=0;u<c;u++)l[u]=t.sum(e[u])/s;for(u=0;u<s;u++)for(d[u]=[],n=0;n<c;n++)d[u][n]=e[n][u]-l[n];for(d=t.transpose(d),u=0;u<c;u++)for(m[u]=[],n=0;n<c;n++)m[u][n]=t.dot([d[u]],[d[n]])/(s-1);for(a=(o=t.jacobi(m))[0],f=o[1],E=t.transpose(a),u=0;u<f.length;u++)for(n=u;n<f.length;n++)f[u]<f[n]&&(r=f[u],f[u]=f[n],f[n]=r,h=E[u],E[u]=E[n],E[n]=h);for(i=t.transpose(d),u=0;u<c;u++)for(p[u]=[],n=0;n<i.length;n++)p[u][n]=t.dot([E[u]],[i[n]]);return[e,f,E,p]}}),function(e){for(var n=0;n<e.length;n++)!function(e){t.fn[e]=function(n,r){var o=this;return r?(setTimeout((function(){r.call(o,t.fn[e].call(o,n))}),15),this):"number"==typeof t[e](this,n)?t[e](this,n):t(t[e](this,n))}}(e[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(r,Math),function(t,e){var n=[].slice,r=t.utils.isNumber,o=t.utils.isArray;function i(t,n,r,o){if(t>1||r>1||t<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var i=(t*n+r*o)/(n+o);return(t-r)/e.sqrt(i*(1-i)*(1/n+1/o))}t.extend({zscore:function(){var e=n.call(arguments);return r(e[1])?(e[0]-e[1])/e[2]:(e[0]-t.mean(e[1]))/t.stdev(e[1],e[2])},ztest:function(){var r,i=n.call(arguments);return o(i[1])?(r=t.zscore(i[0],i[1],i[3]),1===i[2]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):i.length>2?(r=t.zscore(i[0],i[1],i[2]),1===i[3]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1)):(r=i[0],1===i[1]?t.normal.cdf(-e.abs(r),0,1):2*t.normal.cdf(-e.abs(r),0,1))}}),t.extend(t.fn,{zscore:function(t,e){return(t-this.mean())/this.stdev(e)},ztest:function(n,r,o){var i=e.abs(this.zscore(n,o));return 1===r?t.normal.cdf(-i,0,1):2*t.normal.cdf(-i,0,1)}}),t.extend({tscore:function(){var r=n.call(arguments);return 4===r.length?(r[0]-r[1])/(r[2]/e.sqrt(r[3])):(r[0]-t.mean(r[1]))/(t.stdev(r[1],!0)/e.sqrt(r[1].length))},ttest:function(){var o,i=n.call(arguments);return 5===i.length?(o=e.abs(t.tscore(i[0],i[1],i[2],i[3])),1===i[4]?t.studentt.cdf(-o,i[3]-1):2*t.studentt.cdf(-o,i[3]-1)):r(i[1])?(o=e.abs(i[0]),1==i[2]?t.studentt.cdf(-o,i[1]-1):2*t.studentt.cdf(-o,i[1]-1)):(o=e.abs(t.tscore(i[0],i[1])),1==i[2]?t.studentt.cdf(-o,i[1].length-1):2*t.studentt.cdf(-o,i[1].length-1))}}),t.extend(t.fn,{tscore:function(t){return(t-this.mean())/(this.stdev(!0)/e.sqrt(this.cols()))},ttest:function(n,r){return 1===r?1-t.studentt.cdf(e.abs(this.tscore(n)),this.cols()-1):2*t.studentt.cdf(-e.abs(this.tscore(n)),this.cols()-1)}}),t.extend({anovafscore:function(){var r,o,i,a,c,s,u,l,f=n.call(arguments);if(1===f.length){for(c=new Array(f[0].length),u=0;u<f[0].length;u++)c[u]=f[0][u];f=c}for(o=new Array,u=0;u<f.length;u++)o=o.concat(f[u]);for(i=t.mean(o),r=0,u=0;u<f.length;u++)r+=f[u].length*e.pow(t.mean(f[u])-i,2);for(r/=f.length-1,s=0,u=0;u<f.length;u++)for(a=t.mean(f[u]),l=0;l<f[u].length;l++)s+=e.pow(f[u][l]-a,2);return r/(s/=o.length-f.length)},anovaftest:function(){var e,o,i,a,c=n.call(arguments);if(r(c[0]))return 1-t.centralF.cdf(c[0],c[1],c[2]);var s=t.anovafscore(c);for(e=c.length-1,i=0,a=0;a<c.length;a++)i+=c[a].length;return o=i-e-1,1-t.centralF.cdf(s,e,o)},ftest:function(e,n,r){return 1-t.centralF.cdf(e,n,r)}}),t.extend(t.fn,{anovafscore:function(){return t.anovafscore(this.toArray())},anovaftes:function(){var e,n=0;for(e=0;e<this.length;e++)n+=this[e].length;return t.ftest(this.anovafscore(),this.length-1,n-this.length)}}),t.extend({qscore:function(){var o,i,a,c,s,u=n.call(arguments);return r(u[0])?(o=u[0],i=u[1],a=u[2],c=u[3],s=u[4]):(o=t.mean(u[0]),i=t.mean(u[1]),a=u[0].length,c=u[1].length,s=u[2]),e.abs(o-i)/(s*e.sqrt((1/a+1/c)/2))},qtest:function(){var e,r=n.call(arguments);3===r.length?(e=r[0],r=r.slice(1)):7===r.length?(e=t.qscore(r[0],r[1],r[2],r[3],r[4]),r=r.slice(5)):(e=t.qscore(r[0],r[1],r[2]),r=r.slice(3));var o=r[0],i=r[1];return 1-t.tukey.cdf(e,i,o-i)},tukeyhsd:function(e){for(var n=t.pooledstdev(e),r=e.map((function(e){return t.mean(e)})),o=e.reduce((function(t,e){return t+e.length}),0),i=[],a=0;a<e.length;++a)for(var c=a+1;c<e.length;++c){var s=t.qtest(r[a],r[c],e[a].length,e[c].length,n,o,e.length);i.push([[a,c],s])}return i}}),t.extend({normalci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.normal.inv(o[1]/2,0,1)*o[2]/e.sqrt(o[3])):e.abs(t.normal.inv(o[1]/2,0,1)*t.stdev(o[2])/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},tci:function(){var r,o=n.call(arguments),i=new Array(2);return r=4===o.length?e.abs(t.studentt.inv(o[1]/2,o[3]-1)*o[2]/e.sqrt(o[3])):e.abs(t.studentt.inv(o[1]/2,o[2].length-1)*t.stdev(o[2],!0)/e.sqrt(o[2].length)),i[0]=o[0]-r,i[1]=o[0]+r,i},significant:function(t,e){return t<e}}),t.extend(t.fn,{normalci:function(e,n){return t.normalci(e,n,this.toArray())},tci:function(e,n){return t.tci(e,n,this.toArray())}}),t.extend(t.fn,{oneSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,1)},twoSidedDifferenceOfProportions:function(e,n,r,o){var a=i(e,n,r,o);return t.ztest(a,2)}})}(r,Math),r.models=function(){function t(t,e){var n=t.length,o=e[0].length-1,i=n-o-1,a=r.lstsq(e,t),c=r.multiply(e,a.map((function(t){return[t]}))).map((function(t){return t[0]})),s=r.subtract(t,c),u=r.mean(t),l=r.sum(c.map((function(t){return Math.pow(t-u,2)}))),f=r.sum(t.map((function(t,e){return Math.pow(t-c[e],2)}))),h=l+f;return{exog:e,endog:t,nobs:n,df_model:o,df_resid:i,coef:a,predict:c,resid:s,ybar:u,SST:h,SSE:l,SSR:f,R2:l/h}}function e(e){var n,o,i=(n=e.exog,o=n[0].length,r.arange(o).map((function(e){var i=r.arange(o).filter((function(t){return t!==e}));return t(r.col(n,e).map((function(t){return t[0]})),r.col(n,i))}))),a=Math.sqrt(e.SSR/e.df_resid),c=i.map((function(t){var e=t.SST,n=t.R2;return a/Math.sqrt(e*(1-n))})),s=e.coef.map((function(t,e){return(t-0)/c[e]})),u=s.map((function(t){var n=r.studentt.cdf(t,e.df_resid);return 2*(n>.5?1-n:n)})),l=r.studentt.inv(.975,e.df_resid),f=e.coef.map((function(t,e){var n=l*c[e];return[t-n,t+n]}));return{se:c,t:s,p:u,sigmaHat:a,interval95:f}}return{ols:function(n,o){var i=t(n,o),a=e(i),c=function(t){var e,n,o,i=t.R2/t.df_model/((1-t.R2)/t.df_resid);return{F_statistic:i,pvalue:1-(e=i,n=t.df_model,o=t.df_resid,r.beta.cdf(e/(o/n+e),n/2,o/2))}}(i),s=1-(1-i.R2)*((i.nobs-1)/i.df_resid);return i.t=a,i.f=c,i.adjust_R2=s,i}}}(),r.extend({buildxmatrix:function(){for(var t=new Array(arguments.length),e=0;e<arguments.length;e++){var n=[1];t[e]=n.concat(arguments[e])}return r(t)},builddxmatrix:function(){for(var t=new Array(arguments[0].length),e=0;e<arguments[0].length;e++){var n=[1];t[e]=n.concat(arguments[0][e])}return r(t)},buildjxmatrix:function(t){for(var e=new Array(t.length),n=0;n<t.length;n++)e[n]=t[n];return r.builddxmatrix(e)},buildymatrix:function(t){return r(t).transpose()},buildjymatrix:function(t){return t.transpose()},matrixmult:function(t,e){var n,o,i,a,c;if(t.cols()==e.rows()){if(e.rows()>1){for(a=[],n=0;n<t.rows();n++)for(a[n]=[],o=0;o<e.cols();o++){for(c=0,i=0;i<t.cols();i++)c+=t.toArray()[n][i]*e.toArray()[i][o];a[n][o]=c}return r(a)}for(a=[],n=0;n<t.rows();n++)for(a[n]=[],o=0;o<e.cols();o++){for(c=0,i=0;i<t.cols();i++)c+=t.toArray()[n][i]*e.toArray()[o];a[n][o]=c}return r(a)}},regress:function(t,e){var n=r.xtranspxinv(t),o=t.transpose(),i=r.matrixmult(r(n),o);return r.matrixmult(i,e)},regresst:function(t,e,n){var o=r.regress(t,e),i={anova:{}},a=r.jMatYBar(t,o);i.yBar=a;var c=e.mean();i.anova.residuals=r.residuals(e,a),i.anova.ssr=r.ssr(a,c),i.anova.msr=i.anova.ssr/(t[0].length-1),i.anova.sse=r.sse(e,a),i.anova.mse=i.anova.sse/(e.length-(t[0].length-1)-1),i.anova.sst=r.sst(e,c),i.anova.mst=i.anova.sst/(e.length-1),i.anova.r2=1-i.anova.sse/i.anova.sst,i.anova.r2<0&&(i.anova.r2=0),i.anova.fratio=i.anova.msr/i.anova.mse,i.anova.pvalue=r.anovaftest(i.anova.fratio,t[0].length-1,e.length-(t[0].length-1)-1),i.anova.rmse=Math.sqrt(i.anova.mse),i.anova.r2adj=1-i.anova.mse/i.anova.mst,i.anova.r2adj<0&&(i.anova.r2adj=0),i.stats=new Array(t[0].length);for(var s,u,l,f=r.xtranspxinv(t),h=0;h<o.length;h++)s=Math.sqrt(i.anova.mse*Math.abs(f[h][h])),u=Math.abs(o[h]/s),l=r.ttest(u,e.length-t[0].length-1,n),i.stats[h]=[o[h],s,u,l];return i.regress=o,i},xtranspx:function(t){return r.matrixmult(t.transpose(),t)},xtranspxinv:function(t){var e=r.matrixmult(t.transpose(),t);return r.inv(e)},jMatYBar:function(t,e){var n=r.matrixmult(t,e);return new r(n)},residuals:function(t,e){return r.matrixsubtract(t,e)},ssr:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},sse:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e[r],2);return n},sst:function(t,e){for(var n=0,r=0;r<t.length;r++)n+=Math.pow(t[r]-e,2);return n},matrixsubtract:function(t,e){for(var n=new Array(t.length),o=0;o<t.length;o++){n[o]=new Array(t[o].length);for(var i=0;i<t[o].length;i++)n[o][i]=t[o][i]-e[o][i]}return r(n)}}),r.jStat=r,r)},function(t,e,n){const r=n(7),{EmbeddedActionsParser:o}=n(8),i=r.tokenVocabulary,{String:String,SheetQuoted:SheetQuoted,ExcelRefFunction:ExcelRefFunction,ExcelConditionalRefFunction:ExcelConditionalRefFunction,Function:Function,FormulaErrorT:FormulaErrorT,RefError:RefError,Cell:Cell,Sheet:Sheet,ReservedName:ReservedName,Name:Name,Number:Number,Boolean:Boolean,Column:Column,Comma:Comma,Colon:Colon,Semicolon:Semicolon,OpenParen:OpenParen,CloseParen:CloseParen,OpenCurlyParen:OpenCurlyParen,CloseCurlyParen:CloseCurlyParen,MulOp:MulOp,PlusOp:PlusOp,DivOp:DivOp,MinOp:MinOp,ConcatOp:ConcatOp,ExOp:ExOp,PercentOp:PercentOp,NeqOp:NeqOp,GteOp:GteOp,LteOp:LteOp,GtOp:GtOp,EqOp:EqOp,LtOp:LtOp}=r.tokenVocabulary;t.exports={allTokens:Object.values(i),Parser:class extends o{constructor(t,e){super(i,{outputCst:!1,maxLookahead:1,skipValidations:!0}),this.utils=e,this.binaryOperatorsPrecedence=[["^"],["*","/"],["+","-"],["&"],["<",">","=","<>","<=",">="]];const n=this;n.RULE("formulaWithBinaryOp",()=>{const t=[],e=[n.SUBRULE(n.formulaWithPercentOp)];return n.MANY(()=>{t.push(n.OR(n.c1||(n.c1=[{ALT:()=>n.CONSUME(GtOp).image},{ALT:()=>n.CONSUME(EqOp).image},{ALT:()=>n.CONSUME(LtOp).image},{ALT:()=>n.CONSUME(NeqOp).image},{ALT:()=>n.CONSUME(GteOp).image},{ALT:()=>n.CONSUME(LteOp).image},{ALT:()=>n.CONSUME(ConcatOp).image},{ALT:()=>n.CONSUME(PlusOp).image},{ALT:()=>n.CONSUME(MinOp).image},{ALT:()=>n.CONSUME(MulOp).image},{ALT:()=>n.CONSUME(DivOp).image},{ALT:()=>n.CONSUME(ExOp).image}]))),e.push(n.SUBRULE2(n.formulaWithPercentOp))}),n.ACTION(()=>{for(const n of this.binaryOperatorsPrecedence)for(let r=0,o=t.length;r<o;r++){const i=t[r];n.includes(i)&&(t.splice(r,1),e.splice(r,2,this.utils.applyInfix(e[r],i,e[r+1])),r--,o--)}}),e[0]}),n.RULE("plusMinusOp",()=>n.OR([{ALT:()=>n.CONSUME(PlusOp).image},{ALT:()=>n.CONSUME(MinOp).image}])),n.RULE("formulaWithPercentOp",()=>{let t=n.SUBRULE(n.formulaWithUnaryOp);return n.OPTION(()=>{const e=n.CONSUME(PercentOp).image;t=n.ACTION(()=>this.utils.applyPostfix(t,e))}),t}),n.RULE("formulaWithUnaryOp",()=>{const t=[];n.MANY(()=>{const e=n.OR([{ALT:()=>n.CONSUME(PlusOp).image},{ALT:()=>n.CONSUME(MinOp).image}]);t.push(e)});const e=n.SUBRULE(n.formulaWithIntersect);return t.length>0?n.ACTION(()=>this.utils.applyPrefix(t,e)):e}),n.RULE("formulaWithIntersect",()=>{let t=n.SUBRULE(n.formulaWithRange);const e=[t];return n.MANY({GATE:()=>{const t=n.LA(0);return n.LA(1).startOffset>t.endOffset+1},DEF:()=>{e.push(n.SUBRULE3(n.formulaWithRange))}}),e.length>1?n.ACTION(()=>n.ACTION(()=>this.utils.applyIntersect(e))):t}),n.RULE("formulaWithRange",()=>{const t=n.SUBRULE(n.formula),e=[t];return n.MANY(()=>{n.CONSUME(Colon),e.push(n.SUBRULE2(n.formula))}),e.length>1?n.ACTION(()=>n.ACTION(()=>this.utils.applyRange(e))):t}),n.RULE("formula",()=>n.OR9([{ALT:()=>n.SUBRULE(n.reservedName)},{ALT:()=>n.SUBRULE(n.referenceWithoutInfix)},{ALT:()=>n.SUBRULE(n.paren)},{ALT:()=>n.SUBRULE(n.constant)},{ALT:()=>n.SUBRULE(n.functionCall)},{ALT:()=>n.SUBRULE(n.constantArray)}])),n.RULE("paren",()=>{let t;n.CONSUME(OpenParen);const e=[];return e.push(n.SUBRULE(n.formulaWithBinaryOp)),n.MANY(()=>{n.CONSUME(Comma),e.push(n.SUBRULE2(n.formulaWithBinaryOp))}),t=e.length>1?n.ACTION(()=>this.utils.applyUnion(e)):e[0],n.CONSUME(CloseParen),t}),n.RULE("constantArray",()=>{const t=[[]];let e=0;return n.CONSUME(OpenCurlyParen),t[e].push(n.SUBRULE(n.constantForArray)),n.MANY(()=>{const r=n.OR([{ALT:()=>n.CONSUME(Comma).image},{ALT:()=>n.CONSUME(Semicolon).image}]),o=n.SUBRULE2(n.constantForArray);","===r?t[e].push(o):(e++,t[e]=[],t[e].push(o))}),n.CONSUME(CloseCurlyParen),n.ACTION(()=>this.utils.toArray(t))}),n.RULE("constantForArray",()=>n.OR([{ALT:()=>{const t=n.OPTION(()=>n.SUBRULE(n.plusMinusOp)),e=n.CONSUME(Number).image,r=n.ACTION(()=>this.utils.toNumber(e));return t?n.ACTION(()=>this.utils.applyPrefix([t],r)):r}},{ALT:()=>{const t=n.CONSUME(String).image;return n.ACTION(()=>this.utils.toString(t))}},{ALT:()=>{const t=n.CONSUME(Boolean).image;return n.ACTION(()=>this.utils.toBoolean(t))}},{ALT:()=>{const t=n.CONSUME(FormulaErrorT).image;return n.ACTION(()=>this.utils.toError(t))}},{ALT:()=>{const t=n.CONSUME(RefError).image;return n.ACTION(()=>this.utils.toError(t))}}])),n.RULE("reservedName",()=>{const e=n.CONSUME(ReservedName).image;return n.ACTION(()=>t.getVariable(e))}),n.RULE("constant",()=>n.OR([{ALT:()=>{const t=n.CONSUME(Number).image;return n.ACTION(()=>this.utils.toNumber(t))}},{ALT:()=>{const t=n.CONSUME(String).image;return n.ACTION(()=>this.utils.toString(t))}},{ALT:()=>{const t=n.CONSUME(Boolean).image;return n.ACTION(()=>this.utils.toBoolean(t))}},{ALT:()=>{const t=n.CONSUME(FormulaErrorT).image;return n.ACTION(()=>this.utils.toError(t))}}])),n.RULE("functionCall",()=>{const e=n.CONSUME(Function).image.slice(0,-1),r=n.SUBRULE(n.arguments);return n.CONSUME(CloseParen),n.ACTION(()=>t.callFunction(e,r))}),n.RULE("arguments",()=>{n.MANY2(()=>{n.CONSUME2(Comma)});const t=[];return n.OPTION(()=>{t.push(n.SUBRULE(n.formulaWithBinaryOp)),n.MANY(()=>{n.CONSUME1(Comma),t.push(null),n.OPTION3(()=>{t.pop(),t.push(n.SUBRULE2(n.formulaWithBinaryOp))})})}),t}),n.RULE("postfixOp",()=>n.CONSUME(PercentOp).image),n.RULE("referenceWithoutInfix",()=>n.OR([{ALT:()=>n.SUBRULE(n.referenceItem)},{ALT:()=>n.SUBRULE(n.referenceFunctionCall)},{ALT:()=>{const t=n.SUBRULE(n.prefixName),e=n.SUBRULE2(n.formulaWithRange);return n.ACTION(()=>{if(this.utils.isFormulaError(e))return e;e.ref.sheet=t}),e}}])),n.RULE("referenceFunctionCall",()=>{const e=n.SUBRULE(n.refFunctionName),r=n.SUBRULE(n.arguments);return n.CONSUME2(CloseParen),n.ACTION(()=>t.callRefFunction(e,r))}),n.RULE("refFunctionName",()=>n.OR([{ALT:()=>n.CONSUME(ExcelRefFunction).image.slice(0,-1)},{ALT:()=>n.CONSUME(ExcelConditionalRefFunction).image.slice(0,-1)}])),n.RULE("referenceItem",()=>n.OR([{ALT:()=>{const t=n.CONSUME(Cell).image;return n.ACTION(()=>this.utils.parseCellAddress(t))}},{ALT:()=>{const e=n.CONSUME(Name).image;return n.ACTION(()=>t.getVariable(e))}},{ALT:()=>{const t=n.CONSUME(Column).image;return n.ACTION(()=>this.utils.parseCol(t))}},{ALT:()=>{const t=n.CONSUME(RefError).image;return n.ACTION(()=>this.utils.toError(t))}}])),n.RULE("prefixName",()=>n.OR([{ALT:()=>n.CONSUME(Sheet).image.slice(0,-1)},{ALT:()=>n.CONSUME(SheetQuoted).image.slice(1,-2).replace(/''/g,"'")}])),this.performSelfAnalysis()}}}},function(t,e,n){const{FormulaParser:r}=n(16),{DepParser:o}=n(26),i=n(10),a=n(1);Object.assign(r,{MAX_ROW:1048576,MAX_COLUMN:16384,SSF:i,DepParser:o,FormulaError:a,...n(2)}),t.exports=r},function(t,e,n){const r=n(9),o=n(11),i=n(18),a=n(12),c=n(19),s=n(6),u=n(21),l=n(22),f=n(24),h=n(1),{FormulaHelpers:p}=n(2),{Parser:d,allTokens:m}=n(14),E=n(7),g=n(25);t.exports={FormulaParser:class{constructor(t,e=!1){this.logs=[],this.isTest=e,this.utils=new g(this),t=Object.assign({functions:{},onVariable:()=>null,onCell:()=>0,onRange:()=>[[0]]},t),this.onVariable=t.onVariable,this.functions=Object.assign({},f,l,u,s,c,a,r,o,i,t.functions),this.onRange=t.onRange,this.onCell=t.onCell,this.funsNullAs0=Object.keys(o).concat(Object.keys(i)).concat(Object.keys(a)).concat(Object.keys(c)).concat(Object.keys(s)).concat(Object.keys(l)).concat(Object.keys(f)),this.funsNeedContextAndNoDataRetrieve=["ROW","ROWS","COLUMN","COLUMNS","SUMIF","INDEX","AVERAGEIF"],this.funsNeedContext=[],this.funsPreserveRef=Object.keys(u),this.parser=new d(this,this.utils)}static get allTokens(){return m}getCell(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onCell(t)}getRange(t){return null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),this.onRange(t)}getVariable(t){const e={ref:this.onVariable(t,this.position.sheet)};return null==e.ref?h.NAME:e}retrieveRef(t){return p.isRangeRef(t)?this.getRange(t.ref):p.isCellRef(t)?this.getCell(t.ref):t}callRefFunction(t,e){if(t=t.toUpperCase(),this.functions[t]){let n;try{n=this.functions[t](this,...e)}catch(t){if(t instanceof h)return t;throw t}return void 0===n?{value:0,ref:{}}:p.checkFunctionResult(n)}return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}}}callFunction(t,e){0===t.indexOf("_xlfn.")&&(t=t.slice(6)),t=t.toUpperCase();const n=this.funsNullAs0.includes(t)?0:"";if(this.funsNeedContextAndNoDataRetrieve.includes(t)||(e=e.map(e=>{if(null===e)return{value:n,isArray:!1,omitted:!0};const r=this.utils.extractRefValue(e);return this.funsPreserveRef.includes(t)?{value:r.val,isArray:r.isArray,ref:e.ref}:{value:r.val,isArray:r.isArray,isRangeRef:!!p.isRangeRef(e),isCellRef:!!p.isCellRef(e)}})),this.functions[t]){let n;try{n=!this.funsNeedContextAndNoDataRetrieve.includes(t)||this.funsNeedContext.includes(t)?this.functions[t](...e):this.functions[t](this,...e)}catch(t){if(t instanceof h)return t;throw t}if(void 0===n){if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw h.NOT_IMPLEMENTED(t)}return p.checkFunctionResult(n)}if(this.isTest)return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}};throw h.NOT_IMPLEMENTED(t)}supportedFunctions(){const t=[];return Object.keys(this.functions).forEach(e=>{let n;try{if(n=this.functions[e](0,0,0,0,0,0,0,0,0,0,0),void 0===n)return;t.push(e)}catch(n){(n instanceof h||n instanceof TypeError)&&t.push(e)}}),t.sort()}checkFormulaResult(t,e=!1){const n=typeof t;if("number"===n){if(isNaN(t))return h.VALUE;if(!isFinite(t))return h.NUM;t+=0}else if("object"===n){if(t instanceof h)return t;if(e)return t.ref&&(t=this.retrieveRef(t)),Array.isArray(t)?t:h.VALUE;if(t.ref&&t.ref.row&&!t.ref.from)t=this.retrieveRef(t);else if(t.ref&&t.ref.from&&t.ref.from.col===t.ref.to.col)t=this.retrieveRef({ref:{row:t.ref.from.row,col:t.ref.from.col}});else{if(!Array.isArray(t))return h.VALUE;t=t[0][0]}}return t}parse(t,e,n=!1){if(0===t.length)throw Error("Input must not be empty.");this.position=e;const r=E.lex(t);let o;this.parser.input=r.tokens;try{if(o=this.parser.formulaWithBinaryOp(),o=this.checkFormulaResult(o,n),o instanceof h)return o}catch(t){throw t}if(this.parser.errors.length>0){const e=this.parser.errors[0],n=e.previousToken.startLine,r=e.previousToken.startColumn+1;let o="\n"+t.split("\n")[n-1]+"\n";throw o+=Array(r-1).fill(" ").join("")+"^\n",e.message=o+`Error at position ${n}:${r}\n`+e.message,e}return o}},FormulaHelpers:p}},function(t,e,n){const r=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],o=["","สิบ","ร้อย","พัน","หมื่น","แสน","ล้าน"];function i(t){let e="";const n=t.length;if(n>7){const e=n-7+1,r=t.slice(0,e),o=t.slice(e);return i(r)+"ล้าน"+i(o)}for(let i=0;i<n;i++){const a=t[i];a>0&&(e+=r[a]+o[n-i-1])}return e}function a(t){let e=t;e=e.replace("หนึ่งสิบ","สิบ"),e=e.replace("สองสิบ","ยี่สิบ");return e.length>5&&e.length-e.lastIndexOf("หนึ่ง")==5&&(e=e.substr(0,e.length-5)+"เอ็ด"),e}null!=t.exports&&(t.exports=function(t){let e="ศูนย์บาทถ้วน";if(isNaN(t))return e;if(t>=Number.MAX_SAFE_INTEGER)return e;const n=Math.floor(t).toString(),r=Math.round(t%1*100).toString(),o=Array.from(n).map(Number),c=Array.from(r).map(Number);let s=i(o),u=i(c);return s=a(s),u=a(u),e=function(t,e){let n="";return n=""===t&&""===e?"ศูนย์บาทถ้วน":""!==t&&""===e?t+"บาทถ้วน":""===t&&""!==e?e+"สตางค์":t+"บาท"+e+"สตางค์",n}(s,u),e})},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i}=n(2),a=o,c={ACOS:t=>{if((t=a.accept(t,i.NUMBER))>1||t<-1)throw r.NUM;return Math.acos(t)},ACOSH:t=>{if((t=a.accept(t,i.NUMBER))<1)throw r.NUM;return Math.acosh(t)},ACOT:t=>(t=a.accept(t,i.NUMBER),Math.PI/2-Math.atan(t)),ACOTH:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)<=1)throw r.NUM;return Math.atanh(1/t)},ASIN:t=>{if((t=a.accept(t,i.NUMBER))>1||t<-1)throw r.NUM;return Math.asin(t)},ASINH:t=>(t=a.accept(t,i.NUMBER),Math.asinh(t)),ATAN:t=>(t=a.accept(t,i.NUMBER),Math.atan(t)),ATAN2:(t,e)=>{if(t=a.accept(t,i.NUMBER),0===(e=a.accept(e,i.NUMBER))&&0===t)throw r.DIV0;return Math.atan2(e,t)},ATANH:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>1)throw r.NUM;return Math.atanh(t)},COS:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>2**27-1)throw r.NUM;return Math.cos(t)},COSH:t=>(t=a.accept(t,i.NUMBER),Math.cosh(t)),COT:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>2**27-1)throw r.NUM;if(0===t)throw r.DIV0;return 1/Math.tan(t)},COTH:t=>{if(0===(t=a.accept(t,i.NUMBER)))throw r.DIV0;return 1/Math.tanh(t)},CSC:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>2**27-1)throw r.NUM;return 1/Math.sin(t)},CSCH:t=>{if(0===(t=a.accept(t,i.NUMBER)))throw r.DIV0;return 1/Math.sinh(t)},SEC:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>2**27-1)throw r.NUM;return 1/Math.cos(t)},SECH:t=>(t=a.accept(t,i.NUMBER),1/Math.cosh(t)),SIN:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>2**27-1)throw r.NUM;return Math.sin(t)},SINH:t=>(t=a.accept(t,i.NUMBER),Math.sinh(t)),TAN:t=>{if(t=a.accept(t,i.NUMBER),Math.abs(t)>2**27-1)throw r.NUM;return Math.tan(t)},TANH:t=>(t=a.accept(t,i.NUMBER),Math.tanh(t))};t.exports=c},function(t,e,n){const r=n(1),o=n(9),{FormulaHelpers:i,Types:a}=n(2),c=i,s=n(20),u=n(13),l=(console.log,/^\s?[+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?\s?$/),f=/^\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/,h=/^\s?([+-]?\s?[0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)\s?([+-]?\s?([0-9]+[.]?[0-9]*([eE][+\-][0-9]+)?)?)\s?[ij]\s?$/;function p(t){let e=0,n=0,o="i";if("number"==typeof(t=c.accept(t)))return{real:t,im:n,unit:o};if("boolean"==typeof t)throw r.VALUE;let i=t.match(l);if(i)return e=Number(i[0]),{real:e,im:n,unit:o};if(i=t.match(f),i)return n=Number(/^\s?[+-]?\s?$/.test(i[1])?i[1]+"1":i[1]),o=i[0].slice(-1),{real:e,im:n,unit:o};if(i=t.match(h),i)return e=Number(i[1]),n=Number(/^\s?[+-]?\s?$/.test(i[3])?i[3]+"1":i[3]),o=i[0].slice(-1),{real:e,im:n,unit:o};throw r.NUM}const d={BESSELI:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw r.NUM;return s.besseli(t,e)},BESSELJ:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw r.NUM;return s.besselj(t,e)},BESSELK:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw r.NUM;return s.besselk(t,e)},BESSELY:(t,e)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),(e=Math.trunc(e))<0)throw r.NUM;return s.bessely(t,e)},BIN2DEC:t=>{let e=(t=c.accept(t,a.NUMBER_NO_BOOLEAN)).toString();if(e.length>10)throw r.NUM;return 10===e.length&&"1"===e.substring(0,1)?parseInt(e.substring(1),2)+-512:parseInt(e,2)},BIN2HEX:(t,e)=>{t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN,null);const n=t.toString();if(n.length>10)throw r.NUM;if(10===n.length&&"1"===n.substring(0,1))return(parseInt(n.substring(1),2)+0xfffffffe00).toString(16).toUpperCase();const i=parseInt(t,2).toString(16);if(null==e)return i.toUpperCase();if(e<0)throw r.NUM;if((e=Math.trunc(e))>=i.length)return(o.REPT("0",e-i.length)+i).toUpperCase();throw r.NUM},BIN2OCT:(t,e)=>{t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER,null);let n=t.toString();if(n.length>10)throw r.NUM;if(10===n.length&&"1"===n.substr(0,1))return(parseInt(n.substr(1),2)+1073741312).toString(8);let i=parseInt(t,2).toString(8);if(null==e)return i.toUpperCase();if(e<0)throw r.NUM;if((e=Math.trunc(e))>=i.length)return o.REPT("0",e-i.length)+i;throw r.NUM},BITAND:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),t<0||e<0)throw r.NUM;if(Math.floor(t)!==t||Math.floor(e)!==e)throw r.NUM;if(t>0xffffffffffff||e>0xffffffffffff)throw r.NUM;return t&e},BITLSHIFT:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),e=Math.trunc(e),Math.abs(e)>53)throw r.NUM;if(t<0||Math.floor(t)!==t||t>0xffffffffffff)throw r.NUM;const n=e>=0?t*2**e:Math.trunc(t/2**-e);if(n>0xffffffffffff)throw r.NUM;return n},BITOR:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),t<0||e<0)throw r.NUM;if(Math.floor(t)!==t||Math.floor(e)!==e)throw r.NUM;if(t>0xffffffffffff||e>0xffffffffffff)throw r.NUM;return t|e},BITRSHIFT:(t,e)=>(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),d.BITLSHIFT(t,-e)),BITXOR:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER),t<0||t>0xffffffffffff||Math.floor(t)!==t)throw r.NUM;if(e<0||e>0xffffffffffff||Math.floor(e)!==e)throw r.NUM;return t^e},COMPLEX:(t,e,n)=>{if(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN),"i"!==(n=c.accept(n,a.STRING,"i"))&&"j"!==n)throw r.VALUE;if(0===t&&0===e)return 0;if(0===t)return 1===e?n:-1===e?"-"+n:e.toString()+n;if(0===e)return t.toString();{let r=e>0?"+":"";return 1===e?t.toString()+r+n:-1===e?t.toString()+r+"-"+n:t.toString()+r+e.toString()+n}},DEC2BIN:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,null),t<-512||t>511)throw r.NUM;if(t<0)return"1"+o.REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);let n=parseInt(t,10).toString(2);if(null==e)return n;if((e=Math.trunc(e))<=0)throw r.NUM;if(e<n.length)throw r.NUM;return o.REPT("0",e-n.length)+n},DEC2HEX:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,null),t<-549755813888||t>549755813888)throw r.NUM;if(t<0)return(1099511627776+t).toString(16).toUpperCase();let n=parseInt(t,10).toString(16);if(null==e)return n.toUpperCase();if((e=Math.trunc(e))<=0)throw r.NUM;if(e<n.length)throw r.NUM;return o.REPT("0",e-n.length)+n.toUpperCase()},DEC2OCT:(t,e)=>{if(t=c.accept(t,a.NUMBER),e=c.accept(e,a.NUMBER,null),t<-536870912||t>536870912)throw r.NUM;if(t<0)return(t+1073741824).toString(8);let n=parseInt(t,10).toString(8);if(null==e)return n.toUpperCase();if((e=Math.trunc(e))<=0)throw r.NUM;if(e<n.length)throw r.NUM;return o.REPT("0",e-n.length)+n},DELTA:(t,e)=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN))===(e=c.accept(e,a.NUMBER_NO_BOOLEAN,0))?1:0,ERF:(t,e)=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN),e=c.accept(e,a.NUMBER_NO_BOOLEAN,0),u.erf(t)),ERFC:t=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN),u.erfc(t)),GESTEP:(t,e)=>(t=c.accept(t,a.NUMBER_NO_BOOLEAN))>=(e=c.accept(e,a.NUMBER_NO_BOOLEAN,0))?1:0,HEX2BIN:(t,e)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER,null),t.length>10||!/^[0-9a-fA-F]*$/.test(t))throw r.NUM;let n=10===t.length&&"f"===t.substr(0,1).toLowerCase(),i=n?parseInt(t,16)-1099511627776:parseInt(t,16);if(i<-512||i>511)throw r.NUM;if(n)return"1"+o.REPT("0",9-(i+512).toString(2).length)+(i+512).toString(2);let s=i.toString(2);if(null==e)return s;if((e=Math.trunc(e))<=0||e<s.length)throw r.NUM;return o.REPT("0",e-s.length)+s},HEX2DEC:t=>{if((t=c.accept(t,a.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw r.NUM;let e=parseInt(t,16);return e>=549755813888?e-1099511627776:e},HEX2OCT:(t,e)=>{if((t=c.accept(t,a.STRING)).length>10||!/^[0-9a-fA-F]*$/.test(t))throw r.NUM;let n=d.HEX2DEC(t);if(n>536870911||n<-536870912)throw r.NUM;return d.DEC2OCT(n,e)},IMABS:t=>{const{real:e,im:n}=p(t);return Math.sqrt(Math.pow(e,2)+Math.pow(n,2))},IMAGINARY:t=>p(t).im,IMARGUMENT:t=>{const{real:e,im:n}=p(t);if(0===e&&0===n)throw r.DIV0;return 0===e&&n>0?Math.PI/2:0===e&&n<0?-Math.PI/2:e<0&&0===n?Math.PI:e>0&&0===n?0:e>0?Math.atan(n/e):e<0&&n>0?Math.atan(n/e)+Math.PI:Math.atan(n/e)-Math.PI},IMCONJUGATE:t=>{const{real:e,im:n,unit:r}=p(t);return 0!==n?d.COMPLEX(e,-n,r):""+e},IMCOS:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.cos(e)*(Math.exp(n)+Math.exp(-n))/2,i=-Math.sin(e)*(Math.exp(n)-Math.exp(-n))/2;return d.COMPLEX(o,i,r)},IMCOSH:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.cos(n)*(Math.exp(e)+Math.exp(-e))/2,i=-Math.sin(n)*(Math.exp(e)-Math.exp(-e))/2;return d.COMPLEX(o,-i,r)},IMCOT:t=>{t=c.accept(t);let e=d.IMCOS(t),n=d.IMSIN(t);return d.IMDIV(e,n)},IMCSC:t=>(t=c.accept(t),d.IMDIV("1",d.IMSIN(t))),IMCSCH:t=>(t=c.accept(t),d.IMDIV("1",d.IMSINH(t))),IMDIV:(t,e)=>{const n=p(t),o=n.real,i=n.im,a=n.unit,c=p(e),s=c.real,u=c.im,l=c.unit;if(0===s&&0===u||a!==l)throw r.NUM;let f=a,h=Math.pow(s,2)+Math.pow(u,2);return d.COMPLEX((o*s+i*u)/h,(i*s-o*u)/h,f)},IMEXP:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.exp(e);return d.COMPLEX(o*Math.cos(n),o*Math.sin(n),r)},IMLN:t=>{const{real:e,im:n,unit:r}=p(t);return d.COMPLEX(Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(n,2))),Math.atan(n/e),r)},IMLOG10:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(n,2)))/Math.log(10),i=Math.atan(n/e)/Math.log(10);return d.COMPLEX(o,i,r)},IMLOG2:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.log(Math.sqrt(Math.pow(e,2)+Math.pow(n,2)))/Math.log(2),i=Math.atan(n/e)/Math.log(2);return d.COMPLEX(o,i,r)},IMPOWER:(t,e)=>{let{unit:n}=p(t);e=c.accept(e,a.NUMBER_NO_BOOLEAN);let r=Math.pow(d.IMABS(t),e),o=d.IMARGUMENT(t),i=r*Math.cos(e*o),s=r*Math.sin(e*o);return d.COMPLEX(i,s,n)},IMPRODUCT:(...t)=>{let e,n=0;return c.flattenParams(t,null,!1,t=>{if(0===n)e=c.accept(t),p(e);else{const n=p(e),o=n.real,i=n.im,a=n.unit,c=p(t),s=c.real,u=c.im;if(a!==c.unit)throw r.VALUE;e=d.COMPLEX(o*s-i*u,o*u+i*s)}n++},1),e},IMREAL:t=>p(t).real,IMSEC:t=>d.IMDIV("1",d.IMCOS(t)),IMSECH:t=>d.IMDIV("1",d.IMCOSH(t)),IMSIN:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.sin(e)*(Math.exp(n)+Math.exp(-n))/2,i=Math.cos(e)*(Math.exp(n)-Math.exp(-n))/2;return d.COMPLEX(o,i,r)},IMSINH:t=>{const{real:e,im:n,unit:r}=p(t);let o=Math.cos(n)*(Math.exp(e)-Math.exp(-e))/2,i=Math.sin(n)*(Math.exp(e)+Math.exp(-e))/2;return d.COMPLEX(o,i,r)},IMSQRT:t=>{const{unit:e}=p(t);let n=Math.sqrt(d.IMABS(t)),r=d.IMARGUMENT(t);return d.COMPLEX(n*Math.cos(r/2),n*Math.sin(r/2),e)},IMSUB:(t,e)=>{const n=p(t),o=n.real,i=n.im,a=n.unit,c=p(e),s=c.real,u=c.im;if(a!==c.unit)throw r.VALUE;return d.COMPLEX(o-s,i-u,a)},IMSUM:(...t)=>{let e,n=0,o=0;return c.flattenParams(t,null,!1,t=>{const{real:i,im:a,unit:c}=p(t);if(e||(e=c),e!==c)throw r.VALUE;n+=i,o+=a}),d.COMPLEX(n,o,e)},IMTAN:t=>{const{unit:e}=p(t);return d.IMDIV(d.IMSIN(t),d.IMCOS(t),e)},OCT2BIN:(t,e)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER,null),t.length>10)throw r.NUM;if(e>10)throw r.NUM;if(null!==e&&e<0)throw r.NUM;e=Math.trunc(e);let n=10===t.length&&"7"===t.substring(0,1),i=d.OCT2DEC(t);if(i<-512||i>511)return r.NUM;if(n)return"1"+o.REPT("0",9-(512+i).toString(2).length)+(512+i).toString(2);let s=i.toString(2);if(0===e)return s;if(e<s.length)throw r.NUM;return o.REPT("0",e-s.length)+s},OCT2DEC:t=>{if((t=c.accept(t,a.STRING)).length>10)throw r.NUM;for(const e of t)if(e<"0"||e>"7")throw r.NUM;let e=parseInt(t,8);return e>=536870912?e-1073741824:e},OCT2HEX:(t,e)=>{if(t=c.accept(t,a.STRING),e=c.accept(e,a.NUMBER_NO_BOOLEAN,null),t.length>10)throw r.NUM;for(const e of t)if(e<"0"||e>"7")throw r.NUM;if((e=Math.trunc(e))<0||e>10)throw r.NUM;let n=d.OCT2DEC(t),i=d.DEC2HEX(n);if(0===e)return i;if(e<i.length)throw r.NUM;return o.REPT("0",e-i.length)+i}};t.exports=d},function(t,e,n){var r;r=function(t){t.version="1.0.2";var e=Math;function n(t,e){for(var n=0,r=0;n<t.length;++n)r=e*r+t[n];return r}function r(t,e,n,r,o){if(0===e)return n;if(1===e)return r;for(var i=2/t,a=r,c=1;c<e;++c)a=r*c*i+o*n,n=r,r=a;return a}function o(t,e,n,o,i){return function(n,a){if(o){if(0===n)return 1==o?-1/0:1/0;if(n<0)return NaN}return 0===a?t(n):1===a?e(n):a<0?NaN:r(n,a|=0,t(n),e(n),i)}}var i,a,c,s,u,l,f,h,p,d,m,E,g,N=function(){var t=.636619772,o=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),i=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),a=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),c=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function s(r){var s=0,u=0,l=0,f=r*r;if(r<8)s=(u=n(o,f))/(l=n(i,f));else{var h=r-.785398164;u=n(a,f=64/f),l=n(c,f),s=e.sqrt(t/r)*(e.cos(h)*u-e.sin(h)*l*8/r)}return s}var u=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),l=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),f=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),h=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function p(r){var o=0,i=0,a=0,c=r*r,s=e.abs(r)-2.356194491;return Math.abs(r)<8?o=(i=r*n(u,c))/(a=n(l,c)):(i=n(f,c=64/c),a=n(h,c),o=e.sqrt(t/e.abs(r))*(e.cos(s)*i-e.sin(s)*a*8/e.abs(r)),r<0&&(o=-o)),o}return function t(n,o){if(o=Math.round(o),!isFinite(n))return isNaN(n)?n:0;if(o<0)return(o%2?-1:1)*t(n,-o);if(n<0)return(o%2?-1:1)*t(-n,o);if(0===o)return s(n);if(1===o)return p(n);if(0===n)return 0;var i=0;if(n>o)i=r(n,o,s(n),p(n),-1);else{for(var a=!1,c=0,u=0,l=1,f=0,h=2/n,d=2*e.floor((o+e.floor(e.sqrt(40*o)))/2);d>0;d--)f=d*h*l-c,c=l,l=f,e.abs(l)>1e10&&(l*=1e-10,c*=1e-10,i*=1e-10,u*=1e-10),a&&(u+=l),a=!a,d==o&&(i=c);i/=u=2*u-l}return i}}(),v=(i=.636619772,a=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),c=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),s=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),u=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),l=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),h=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),p=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),o((function(t){var r=0,o=0,l=0,f=t*t,h=t-.785398164;return t<8?r=(o=n(a,f))/(l=n(c,f))+i*N(t,0)*e.log(t):(o=n(s,f=64/f),l=n(u,f),r=e.sqrt(i/t)*(e.sin(h)*o+e.cos(h)*l*8/t)),r}),(function(t){var r=0,o=0,a=0,c=t*t,s=t-2.356194491;return t<8?r=(o=t*n(l,c))/(a=n(f,c))+i*(N(t,1)*e.log(t)-1/t):(o=n(h,c=64/c),a=n(p,c),r=e.sqrt(i/t)*(e.sin(s)*o+e.cos(s)*a*8/t)),r}),0,1,-1)),O=(d=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),m=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),E=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),g=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function t(r,o){if(0===(o=Math.round(o)))return function(t){return t<=3.75?n(d,t*t/14.0625):e.exp(e.abs(t))/e.sqrt(e.abs(t))*n(m,3.75/e.abs(t))}(r);if(1===o)return function(t){return t<3.75?t*n(E,t*t/14.0625):(t<0?-1:1)*e.exp(e.abs(t))/e.sqrt(e.abs(t))*n(g,3.75/e.abs(t))}(r);if(o<0)return NaN;if(0===e.abs(r))return 0;if(r==1/0)return 1/0;var i,a=0,c=2/e.abs(r),s=0,u=1,l=0;for(i=2*e.round((o+e.round(e.sqrt(40*o)))/2);i>0;i--)l=i*c*u+s,s=u,u=l,e.abs(u)>1e10&&(u*=1e-10,s*=1e-10,a*=1e-10),i==o&&(a=s);return a*=t(r,0)/u,r<0&&o%2?-a:a}),R=function(){var t=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),r=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),i=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),a=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return o((function(o){return o<=2?-e.log(o/2)*O(o,0)+n(t,o*o/4):e.exp(-o)/e.sqrt(o)*n(r,2/o)}),(function(t){return t<=2?e.log(t/2)*O(t,1)+1/t*n(i,t*t/4):e.exp(-t)/e.sqrt(t)*n(a,2/t)}),0,2,1)}();t.besselj=N,t.bessely=v,t.besseli=O,t.besselk=R},"undefined"==typeof DO_NOT_EXPORT_BESSEL?r(e):r({})},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i}=n(2),a=o,c={"#NULL!":1,"#DIV/0!":2,"#VALUE!":3,"#REF!":4,"#NAME?":5,"#NUM!":6,"#N/A":7},s={CELL:(t,e)=>{},"ERROR.TYPE":t=>{if((t=a.accept(t))instanceof r)return c[t.toString()];throw r.NA},INFO:()=>{throw r.NOT_IMPLEMENTED("INFO")},ISBLANK:t=>!!t.ref&&("string"==typeof(t=a.accept(t))&&0===t.length),ISERR:t=>(t=a.accept(t))instanceof r&&"#N/A"!==t.toString(),ISERROR:t=>(t=a.accept(t))instanceof r,ISEVEN:t=>(t=a.accept(t,i.NUMBER),(t=Math.trunc(t))%2==0),ISLOGICAL:t=>"boolean"==typeof(t=a.accept(t)),ISNA:t=>(t=a.accept(t))instanceof r&&"#N/A"===t.toString(),ISNONTEXT:t=>"string"!=typeof(t=a.accept(t)),ISNUMBER:t=>"number"==typeof(t=a.accept(t)),ISREF:t=>!!t.ref&&((!a.isCellRef(t)||!(t.ref.row>1048576||t.ref.col>16384))&&((!a.isRangeRef(t)||!(t.ref.from.row>1048576||t.ref.from.col>16384||t.ref.to.row>1048576||t.ref.to.col>16384))&&!((t=a.accept(t))instanceof r&&"#REF!"===t.toString()))),ISTEXT:t=>"string"==typeof(t=a.accept(t)),N:t=>{const e=typeof(t=a.accept(t));if("number"===e)return t;if("boolean"===e)return Number(t);if(t instanceof r)throw t;return 0},NA:()=>{throw r.NA},TYPE:t=>{if(t.ref){if(a.isRangeRef(t))return 16;if(a.isCellRef(t)&&"string"==typeof(t=a.accept(t))&&0===t.length)return 1}const e=typeof(t=a.accept(t));return"number"===e?1:"string"===e?2:"boolean"===e?4:t instanceof r?16:Array.isArray(t)?64:void 0}};t.exports=s},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,Criteria:a,Address:c}=n(2),{Infix:s}=n(4),u=o,{DistributionFunctions:l}=n(23),f={AVEDEV:(...t)=>{let e=0;const n=[];u.flattenParams(t,i.NUMBER,!0,(t,r)=>{"number"==typeof t&&(e+=t,n.push(t))});const r=e/n.length;e=0;for(let t=0;t<n.length;t++)e+=Math.abs(n[t]-r);return e/n.length},AVERAGE:(...t)=>{let e=0,n=0;return u.flattenParams(t,i.NUMBER,!0,(t,r)=>{"number"==typeof t&&(e+=t,n++)}),e/n},AVERAGEA:(...t)=>{let e=0,n=0;return u.flattenParams(t,i.NUMBER,!0,(t,r)=>{const o=typeof t;"number"===o?(e+=t,n++):"string"===o&&n++}),e/n},AVERAGEIF:(t,e,n,o)=>{const i=u.retrieveRanges(t,e,o);e=i[0],o=i[1];const c=(n=u.retrieveArg(t,n)).isArray;n=a.parse(u.accept(n));let l=0,f=0;if(e.forEach((t,e)=>{t.forEach((t,r)=>{const i=o[e][r];"number"==typeof i&&("wc"===n.op?n.match===n.value.test(t)&&(l+=i,f++):s.compareOp(t,n.op,n.value,Array.isArray(t),c)&&(l+=i,f++))})}),0===f)throw r.DIV0;return l/f},AVERAGEIFS:()=>{},COUNT:(...t)=>{let e=0;return u.flattenParams(t,null,!0,(t,n)=>{n.isLiteral&&!isNaN(t)?e++:"number"==typeof t&&e++}),e},COUNTIF:(t,e)=>{t=u.accept(t,i.ARRAY,void 0,!1,!0);const n=e.isArray;e=u.accept(e);let r=0;return e=a.parse(e),t.forEach(t=>{t.forEach(t=>{"wc"===e.op?e.match===e.value.test(t)&&r++:s.compareOp(t,e.op,e.value,Array.isArray(t),n)&&r++})}),r},LARGE:()=>{},MAX:()=>{},MAXA:()=>{},MAXIFS:()=>{},MEDIAN:()=>{},MIN:()=>{},MINA:()=>{},MINIFS:()=>{},PERMUT:()=>{},PERMUTATIONA:()=>{},SMALL:()=>{}};t.exports=Object.assign(f,l)},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,Criteria:a,Address:c}=n(2),{Infix:s}=n(4),u=o,l=n(13),f=n(11),h={"BETA.DIST":(t,e,n,o,a,c)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),a=u.accept(a,i.NUMBER,0),c=u.accept(c,i.NUMBER,1),e<=0||n<=0||t<a||t>c||a===c)throw r.NUM;return t=(t-a)/(c-a),o?l.beta.cdf(t,e,n):l.beta.pdf(t,e,n)/(c-a)},"BETA.INV":(t,e,n,o,a)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.NUMBER,0),a=u.accept(a,i.NUMBER,1),e<=0||n<=0||t<=0||t>1)throw r.NUM;return l.beta.inv(t,e,n)*(a-o)+o},"BINOM.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),e<0||n<0||n>1||t<0||t>e)throw r.NUM;return o?l.binomial.cdf(t,e,n):l.binomial.pdf(t,e,n)},"BINOM.DIST.RANGE":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.NUMBER,n),t<0||e<0||e>1||n<0||n>t||o<n||o>t)throw r.NUM;let a=0;for(let r=n;r<=o;r++)a+=f.COMBIN(t,r)*Math.pow(e,r)*Math.pow(1-e,t-r);return a},"BINOM.INV":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<0||e<0||e>1||n<0||n>1)throw r.NUM;let o=0;for(;o<=t;){if(l.binomial.cdf(o,t,e)>=n)return o;o++}},"CHISQ.DIST":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),e=Math.trunc(e),t<0||e<1||e>1e10)throw r.NUM;return n?l.chisquare.cdf(t,e):l.chisquare.pdf(t,e)},"CHISQ.DIST.RT":(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),e=Math.trunc(e),t<0||e<1||e>1e10)throw r.NUM;return 1-l.chisquare.cdf(t,e)},"CHISQ.INV":(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>1e10)throw r.NUM;return l.chisquare.inv(t,e)},"CHISQ.INV.RT":(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),e=Math.trunc(e),t<0||t>1||e<1||e>1e10)throw r.NUM;return l.chisquare.inv(1-t,e)},"CHISQ.TEST":(t,e)=>{const n=u.accept(t,i.ARRAY,void 0,!1,!1),o=u.accept(e,i.ARRAY,void 0,!1,!1);if(n.length!==o.length||n[0].length!==o[0].length||1===n.length&&1===n[0].length)throw r.NA;const a=n.length,c=n[0].length;let s=(a-1)*(c-1);s=1===a?c-1:a-1;let l=0;for(let t=0;t<a;t++)for(let e=0;e<c;e++)if("number"==typeof n[t][e]&&"number"==typeof o[t][e]){if(0===o[t][e])throw r.DIV0;l+=Math.pow(n[t][e]-o[t][e],2)/o[t][e]}let f=Math.exp(-.5*l);s%2==1&&(f*=Math.sqrt(2*l/Math.PI));let h=s;for(;h>=2;)f=f*l/h,h-=2;let p=f,d=s;for(;p>1e-15*f;)d+=2,p=p*l/d,f+=p;return 1-f},"CONFIDENCE.NORM":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),n=Math.trunc(n),t<=0||t>=1||e<=0||n<1)throw r.NUM;return l.normalci(1,t,e,n)[1]-1},"CONFIDENCE.T":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),n=Math.trunc(n),t<=0||t>=1||e<=0||n<1)throw r.NUM;if(1===n)throw r.DIV0;return l.tci(1,t,e,n)[1]-1},CORREL:(t,e)=>{if(t=u.accept(t,i.ARRAY,void 0,!0,!0),e=u.accept(e,i.ARRAY,void 0,!0,!0),t.length!==e.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"==typeof t[r]&&"number"==typeof e[r]&&(n.push(t[r]),o.push(e[r]));if(n.length<=1)throw r.DIV0;return l.corrcoeff(n,o)},"COVARIANCE.P":(t,e)=>{if(t=u.accept(t,i.ARRAY,void 0,!0,!0),e=u.accept(e,i.ARRAY,void 0,!0,!0),t.length!==e.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"==typeof t[r]&&"number"==typeof e[r]&&(n.push(t[r]),o.push(e[r]));const a=l.mean(n),c=l.mean(o);let s=0;for(let t=0;t<n.length;t++)s+=(n[t]-a)*(o[t]-c);return s/n.length},"COVARIANCE.S":(t,e)=>{if(t=u.accept(t,i.ARRAY,void 0,!0,!0),e=u.accept(e,i.ARRAY,void 0,!0,!0),t.length!==e.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"==typeof t[r]&&"number"==typeof e[r]&&(n.push(t[r]),o.push(e[r]));if(n.length<=1)throw r.DIV0;return l.covariance(n,o)},DEVSQ:(...t)=>{let e=0,n=[];u.flattenParams(t,i.NUMBER,!0,(t,r)=>{"number"==typeof t&&(e+=t,n.push(t))});const r=e/n.length;e=0;for(let t=0;t<n.length;t++)e+=(n[t]-r)**2;return e},"EXPON.DIST":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.BOOLEAN),t<0||e<=0)throw r.NUM;return n?l.exponential.cdf(t,e):l.exponential.pdf(t,e)},"F.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),t<0||e<1||n<1)throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),o?l.centralF.cdf(t,e,n):l.centralF.pdf(t,e,n)},"F.DIST.RT":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<0||e<1||n<1)throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),1-l.centralF.cdf(t,e,n)},"F.INV":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<0||t>1)throw r.NUM;if(e<1||n<1)throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),l.centralF.inv(t,e,n)},"F.INV.RT":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<0||t>1)throw r.NUM;if(e<1||e>=Math.pow(10,10))throw r.NUM;if(n<1||n>=Math.pow(10,10))throw r.NUM;return e=Math.trunc(e),n=Math.trunc(n),l.centralF.inv(1-t,e,n)},"F.TEST":(t,e)=>{t=u.accept(t,i.ARRAY,void 0,!0,!0),e=u.accept(e,i.ARRAY,void 0,!0,!0);const n=[],o=[];let a=0,c=0;for(let r=0;r<Math.max(t.length,e.length);r++)"number"==typeof t[r]&&(n.push(t[r]),a+=t[r]),"number"==typeof e[r]&&(o.push(e[r]),c+=e[r]);if(n.length<=1||o.length<=1)throw r.DIV0;a/=n.length,c/=o.length;let s=0,f=0;for(let t=0;t<n.length;t++)s+=(a-n[t])**2;s/=n.length-1;for(let t=0;t<o.length;t++)f+=(c-o[t])**2;return f/=o.length-1,2*l.centralF.cdf(s/f,n.length-1,o.length-1)},FISHER:t=>{if((t=u.accept(t,i.NUMBER))<=-1||t>=1)throw r.NUM;return Math.log((1+t)/(1-t))/2},FISHERINV:t=>{t=u.accept(t,i.NUMBER);let e=Math.exp(2*t);return(e-1)/(e+1)},FORECAST:(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.ARRAY,void 0,!0,!0),(n=u.accept(n,i.ARRAY,void 0,!0,!0)).length!==e.length)throw r.NA;const o=[],a=[];let c=!0;for(let t=0;t<e.length;t++)"number"==typeof e[t]&&"number"==typeof n[t]&&(o.push(e[t]),a.push(n[t]),n[t]!==n[0]&&(c=!1));if(c)throw r.DIV0;const s=l.mean(o),f=l.mean(a);let h=0,p=0;for(let t=0;t<o.length;t++)h+=(a[t]-f)*(o[t]-s),p+=(a[t]-f)**2;const d=h/p;return s-d*f+d*t},"FORECAST.ETS":()=>{},"FORECAST.ETS.CONFINT":()=>{},"FORECAST.ETS.SEASONALITY":()=>{},"FORECAST.ETS.STAT":()=>{},"FORECAST.LINEAR":(...t)=>h.FORECAST(...t),FREQUENCY:(t,e)=>{t=u.accept(t,i.ARRAY,void 0,!0,!0),e=u.accept(e,i.ARRAY,void 0,!0,!0);const n=[];for(let t=0;t<e.length;t++)"number"==typeof e[t]&&n.push(e[t]);n.sort(),n.push(1/0);const r=[];for(let e=0;e<n.length;e++){r[e]=[],r[e][0]=0;for(let o=0;o<t.length;o++){if("number"!=typeof t[o])continue;t[o]<=n[e]&&(r[e][0]++,t[o]=null)}}return r},GAMMA:t=>{if(0===(t=u.accept(t,i.NUMBER))||t<0&&t===Math.trunc(t))throw r.NUM;return l.gammafn(t)},"GAMMA.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),t<0||e<=0||n<=0)throw r.NUM;return o?l.gamma.cdf(t,e,n,!0):l.gamma.pdf(t,e,n,!1)},"GAMMA.INV":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<0||t>1||e<=0||n<=0)throw r.NUM;return l.gamma.inv(t,e,n)},GAMMALN:t=>{if((t=u.accept(t,i.NUMBER))<=0)throw r.NUM;return l.gammaln(t)},"GAMMALN.PRECISE":t=>{if((t=u.accept(t,i.NUMBER))<=0)throw r.NUM;return l.gammaln(t)},GAUSS:t=>(t=u.accept(t,i.NUMBER),l.normal.cdf(t,0,1)-.5),GEOMEAN:(...t)=>{const e=[];return u.flattenParams(t,i.NUMBER,!0,(t,n)=>{"number"==typeof t&&e.push(t)}),l.geomean(e)},GROWTH:(t,e,n,o)=>{t=u.accept(t,i.ARRAY,void 0,!0,!0);for(let e=0;e<t.length;e++)if("number"!=typeof t[e])throw r.VALUE;const a=null==(e=u.accept(e,i.ARRAY,null,!0,!0));if(null==e){e=[];for(let n=1;n<=t.length;n++)e.push(n)}else{if(e.length!==t.length)throw r.REF;for(let t=0;t<e.length;t++)if("number"!=typeof e[t])throw r.VALUE}if(null==(n=u.accept(n,i.ARRAY,null,!1,!0))&&a){n=[];for(let e=1;e<=t.length;e++)n.push(e);n=[n]}else null==n&&(n=Array.isArray(e[0])?e:[e]);o=u.accept(o,i.BOOLEAN,!0);const c=t.length;let s,l,f=0,h=0,p=0,d=0;for(let n=0;n<c;n++){const r=e[n],o=Math.log(t[n]);f+=r,h+=o,p+=r*o,d+=r*r}f/=c,h/=c,p/=c,d/=c,o?(s=(p-f*h)/(d-f*f),l=h-s*f):(s=p/d,l=0);const m=[];for(let t=0;t<n.length;t++){m[t]=[];for(let e=0;e<n[0].length;e++){if("number"!=typeof n[t][e])throw r.VALUE;m[t][e]=Math.exp(l+s*n[t][e])}}return m},HARMEAN:(...t)=>{let e=0,n=0;return u.flattenParams(t,i.NUMBER,!0,(t,r)=>{"number"==typeof t&&(n+=1/t,e++)}),e/n},"HYPGEOM.DIST":(t,e,n,o,a)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.NUMBER),a=u.accept(a,i.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),n=Math.trunc(n),(o=Math.trunc(o))<=0||t<0||e<=0||n<=0)throw r.NUM;if(e>o)throw r.NUM;if(n>o)throw r.NUM;if(e<t||n<t)throw r.NUM;if(t<e-o+n)throw r.NUM;function c(t,e,n,r){return f.COMBIN(n,t)*f.COMBIN(r-n,e-t)/f.COMBIN(r,e)}return a?function(t,e,n,r){let o=0;for(let i=0;i<=t;i++)o+=c(i,e,n,r);return o}(t,e,n,o):c(t,e,n,o)},INTERCEPT:(t,e)=>{if(t=u.accept(t,i.ARRAY,void 0,!0,!0),(e=u.accept(e,i.ARRAY,void 0,!0,!0)).length!==t.length)throw r.NA;const n=[],o=[];for(let r=0;r<t.length;r++)"number"==typeof t[r]&&"number"==typeof e[r]&&(n.push(t[r]),o.push(e[r]));if(n.length<=1)throw r.DIV0;const a=l.mean(n),c=l.mean(o);let s=0,f=0;for(let t=0;t<n.length;t++)s+=(o[t]-c)*(n[t]-a),f+=(o[t]-c)**2;return a-s/f*c},KURT:(...t)=>{let e=0,n=[];u.flattenParams(t,i.NUMBER,!0,(t,r)=>{"number"==typeof t&&(e+=t,n.push(t))});const r=n.length;e/=r;let o=0;for(let t=0;t<r;t++)o+=Math.pow(n[t]-e,4);return o/=Math.pow(l.stdev(n,!0),4),r*(r+1)/((r-1)*(r-2)*(r-3))*o-3*(r-1)*(r-1)/((r-2)*(r-3))},LINEST:()=>{},LOGEST:()=>{},"LOGNORM.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),t<=0||n<=0)throw r.NUM;return o?l.lognormal.cdf(t,e,n):l.lognormal.pdf(t,e,n)},"LOGNORM.INV":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<=0||t>=1)throw r.NUM;if(n<=0)throw r.NUM;return l.lognormal.inv(t,e,n)},"MODE.MULT":()=>{},"MODE.SNGL":()=>{},"NEGBINOM.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),t=Math.trunc(t),e=Math.trunc(e),n<0||n>1)throw r.NUM;if(t<0||e<1)throw r.NUM;return o?l.negbin.cdf(t,e,n):l.negbin.pdf(t,e,n)},"NORM.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),n<=0)throw r.NUM;return o?l.normal.cdf(t,e,n):l.normal.pdf(t,e,n)},"NORM.INV":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),t<=0||t>=1)throw r.NUM;if(n<=0)throw r.NUM;return l.normal.inv(t,e,n)},"NORM.S.DIST":(t,e)=>(t=u.accept(t,i.NUMBER),(e=u.accept(e,i.BOOLEAN))?l.normal.cdf(t,0,1):l.normal.pdf(t,0,1)),"NORM.S.INV":t=>{if((t=u.accept(t,i.NUMBER))<=0||t>=1)throw r.NUM;return l.normal.inv(t,0,1)},PEARSON:()=>{},"PERCENTILE.EXC":()=>{},"PERCENTILE.INC":()=>{},"PERCENTRANK.EXC":()=>{},"PERCENTRANK.INC":()=>{},PERMUTATIONA:()=>{},PHI:t=>(t=u.accept(t,i.NUMBER),Math.exp(-.5*t*t)/2.5066282746310002),"POISSON.DIST":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.BOOLEAN),t<0||e<0)throw r.NUM;return t=Math.trunc(t),n?l.poisson.cdf(t,e):l.poisson.pdf(t,e)},PROB:()=>{},"QUARTILE.EXC":()=>{},"QUARTILE.INC":()=>{},"RANK.AVG":()=>{},"RANK.EQ":()=>{},RSQ:()=>{},SKEW:()=>{},"SKEW.P":()=>{},SLOPE:()=>{},STANDARDIZE:(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),(n=u.accept(n,i.NUMBER))<=0)throw r.NUM;return(t-e)/n},"STDEV.P":()=>{},"STDEV.S":()=>{},STDEVA:()=>{},STDEVPA:()=>{},STEYX:()=>{},"T.DIST":(t,e,n)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.BOOLEAN),e<1)throw r.NUM;return n?l.studentt.cdf(t,e):l.studentt.pdf(t,e)},"T.DIST.2T":(t,e)=>{if(t=u.accept(t,i.NUMBER),(e=u.accept(e,i.NUMBER))<1||t<0)throw r.NUM;return 2*(1-l.studentt.cdf(t,e))},"T.DIST.RT":(t,e)=>{if(t=u.accept(t,i.NUMBER),(e=u.accept(e,i.NUMBER))<1)throw r.NUM;return 1-l.studentt.cdf(t,e)},"T.INV":(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),t<=0||t>1||e<1)throw r.NUM;return e=e%1==0?e:Math.trunc(e),l.studentt.inv(t,e)},"T.INV.2T":(t,e)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),t<=0||t>1||e<1)throw r.NUM;return e=e%1==0?e:Math.trunc(e),Math.abs(l.studentt.inv(t/2,e))},"T.TEST":()=>{},TREND:()=>{},TRIMMEAN:()=>{},"VAR.P":()=>{},"VAR.S":()=>{},VARA:()=>{},VARPA:()=>{},"WEIBULL.DIST":(t,e,n,o)=>{if(t=u.accept(t,i.NUMBER),e=u.accept(e,i.NUMBER),n=u.accept(n,i.NUMBER),o=u.accept(o,i.BOOLEAN),t<0||e<=0||n<=0)throw r.NUM;return o?1-Math.exp(-Math.pow(t/n,e)):Math.pow(t,e-1)*Math.exp(-Math.pow(t/n,e))*e/Math.pow(n,e)},"Z.TEST":()=>{}};t.exports={DistributionFunctions:h}},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i}=n(2),a=o,c=new Date(Date.UTC(1900,0,1)),s=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],u=[void 0,[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],void 0,void 0,void 0,void 0,void 0,void 0,void 0,[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],l=[void 0,[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0],[1],[2],[3],[4],[5],[6]],f=/^\s*(\d\d?)\s*(:\s*\d\d?)?\s*(:\s*\d\d?)?\s*(pm|am)?\s*$/i,h=/^\s*((\d\d?)\s*([-\/])\s*(\d\d?))([\d:.apm\s]*)$/i,p=/^\s*((\d\d?)\s*([-/])\s*(jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*))([\d:.apm\s]*)$/i,d=/^\s*((jan\w*|feb\w*|mar\w*|apr\w*|may\w*|jun\w*|jul\w*|aug\w*|sep\w*|oct\w*|nov\w*|dec\w*)\s*([-/])\s*(\d\d?))([\d:.apm\s]*)$/i;function m(t){const e=t>-22038912e5?2:1;return Math.floor((t-c)/864e5)+e}function E(t){if(t instanceof Date)return{date:t};t=a.accept(t);let e,n=!0;return isNaN(t)?(e=function(t){const e=t.match(f);if(!e)return;const n=e[2]?e[2]:":00",r=e[3]?e[3]:":00",o=e[4]?" "+e[4]:"",i=new Date(Date.parse(`1/1/1900 ${e[1]+n+r+o} UTC`));let a=new Date;return a=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds())),new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()))}(t),e?n=!1:e=function(t){const e=t.match(h),n=t.match(p),r=t.match(d);return e?t=e[1]+e[3]+(new Date).getFullYear()+e[5]:n?t=n[1]+n[3]+(new Date).getFullYear()+n[5]:r&&(t=r[1]+r[3]+(new Date).getFullYear()+r[5]),new Date(Date.parse(`${t} UTC`))}(t)):e=function(t){if(t<0)throw r.VALUE;return t<=60?new Date(c.getTime()+864e5*(t-1)):new Date(c.getTime()+864e5*(t-2))}(t=Number(t)),{date:e,isDateGiven:n}}function g(t){return E(t).date}function N(t,e){return t.getUTCFullYear()===e.getUTCFullYear()&&t.getUTCMonth()===e.getUTCMonth()&&t.getUTCDate()===e.getUTCDate()}const v={DATE:(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>=1e4)throw r.NUM;return t<1900&&(t+=1900),m(Date.UTC(t,e-1,n))},DATEDIF:(t,e,n)=>{if(t=g(t),e=g(e),n=a.accept(n,i.STRING).toLowerCase(),t>e)throw r.NUM;const o=e.getUTCFullYear()-t.getUTCFullYear(),c=e.getUTCMonth()-t.getUTCMonth(),s=e.getUTCDate()-t.getUTCDate();let u;switch(n){case"y":return u=c<0||0===c&&s<0?-1:0,u+o;case"m":return u=s<0?-1:0,12*o+c+u;case"d":return Math.floor(e-t)/864e5;case"md":return t.setUTCFullYear(e.getUTCFullYear()),s<0?t.setUTCMonth(e.getUTCMonth()-1):t.setUTCMonth(e.getUTCMonth()),Math.floor(e-t)/864e5;case"ym":return u=s<0?-1:0,(u+12*o+c)%12;case"yd":return c<0||0===c&&s<0?t.setUTCFullYear(e.getUTCFullYear()-1):t.setUTCFullYear(e.getUTCFullYear()),Math.floor(e-t)/864e5}},DATEVALUE:t=>{t=a.accept(t,i.STRING);const{date:e,isDateGiven:n}=E(t);if(!n)return 0;const o=m(e);if(o<0||o>2958465)throw r.VALUE;return o},DAY:t=>g(t).getUTCDate(),DAYS:(t,e)=>{t=g(t);let n=0;return(e=g(e))<-22038912e5&&-22038912e5<t&&(n=1),Math.floor(t-e)/864e5+n},DAYS360:(t,e,n)=>{t=g(t),e=g(e),n=a.accept(n,i.BOOLEAN,!1),31===t.getUTCDate()&&t.setUTCDate(30),!n&&t.getUTCDate()<30&&e.getUTCDate()>30?e.setUTCMonth(e.getUTCMonth()+1,1):31===e.getUTCDate()&&e.setUTCDate(30);const r=e.getUTCFullYear()-t.getUTCFullYear();return 30*(e.getUTCMonth()-t.getUTCMonth())+(e.getUTCDate()-t.getUTCDate())+12*r*30},EDATE:(t,e)=>(t=g(t),e=a.accept(e,i.NUMBER),t.setUTCMonth(t.getUTCMonth()+e),m(t)),EOMONTH:(t,e)=>(t=g(t),e=a.accept(e,i.NUMBER),t.setUTCMonth(t.getUTCMonth()+e+1,0),m(t)),HOUR:t=>g(t).getUTCHours(),ISOWEEKNUM:t=>{const e=g(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=n.getUTCDay();n.setUTCDate(n.getUTCDate()+4-r);const o=new Date(Date.UTC(n.getUTCFullYear(),0,1));return Math.ceil(((n-o)/864e5+1)/7)},MINUTE:t=>g(t).getUTCMinutes(),MONTH:t=>g(t).getUTCMonth()+1,NETWORKDAYS:(t,e,n)=>{let r=1;if((t=g(t))>(e=g(e))){r=-1;const n=t;t=e,e=n}const o=[];null!=n&&a.flattenParams([n],i.NUMBER,!1,t=>{o.push(g(t))});let c=0;for(;t<=e;){if(0!==t.getUTCDay()&&6!==t.getUTCDay()){let e=!1;for(let n=0;n<o.length;n++)if(N(t,o[n])){e=!0;break}e||c++}t.setUTCDate(t.getUTCDate()+1)}return r*c},"NETWORKDAYS.INTL":(t,e,n,o)=>{let c=1;if((t=g(t))>(e=g(e))){c=-1;const n=t;t=e,e=n}if("1111111"===(n=a.accept(n,null,1)))return 0;if("string"==typeof n&&Number(n).toString()!==n){if(7!==n.length)throw r.VALUE;n=n.charAt(6)+n.slice(0,6);const t=[];for(let e=0;e<n.length;e++)"1"===n.charAt(e)&&t.push(e);n=t}else{if("number"!=typeof n)throw r.VALUE;n=l[n]}const s=[];null!=o&&a.flattenParams([o],i.NUMBER,!1,t=>{s.push(g(t))});let u=0;for(;t<=e;){let e=!1;for(let r=0;r<n.length;r++)if(n[r]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let n=0;n<s.length;n++)if(N(t,s[n])){e=!0;break}e||u++}t.setUTCDate(t.getUTCDate()+1)}return c*u},NOW:()=>{const t=new Date;return m(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()))+(3600*t.getHours()+60*t.getMinutes()+t.getSeconds())/86400},SECOND:t=>g(t).getUTCSeconds(),TIME:(t,e,n)=>{if(t=a.accept(t,i.NUMBER),e=a.accept(e,i.NUMBER),n=a.accept(n,i.NUMBER),t<0||t>32767||e<0||e>32767||n<0||n>32767)throw r.NUM;return(3600*t+60*e+n)/86400},TIMEVALUE:t=>(3600*(t=g(t)).getUTCHours()+60*t.getUTCMinutes()+t.getUTCSeconds())/86400,TODAY:()=>{const t=new Date;return m(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate()))},WEEKDAY:(t,e)=>{const n=g(t);e=a.accept(e,i.NUMBER,1);const o=n.getUTCDay(),c=u[e];if(!c)throw r.NUM;return c[o]},WEEKNUM:(t,e)=>{const n=g(t);if(21===(e=a.accept(e,i.NUMBER,1)))return v.ISOWEEKNUM(t);const r=s[e],o=new Date(Date.UTC(n.getUTCFullYear(),0,1)),c=o.getUTCDay()<r?1:0;return Math.ceil(((n-o)/864e5+1)/7)+c},WORKDAY:(t,e,n)=>v["WORKDAY.INTL"](t,e,1,n),"WORKDAY.INTL":(t,e,n,o)=>{if(t=g(t),e=a.accept(e,i.NUMBER),"1111111"===(n=a.accept(n,null,1)))throw r.VALUE;if("string"==typeof n&&Number(n).toString()!==n){if(7!==n.length)throw r.VALUE;n=n.charAt(6)+n.slice(0,6);const t=[];for(let e=0;e<n.length;e++)"1"===n.charAt(e)&&t.push(e);n=t}else{if("number"!=typeof n)throw r.VALUE;if(null==(n=l[n]))throw r.NUM}const c=[];null!=o&&a.flattenParams([o],i.NUMBER,!1,t=>{c.push(g(t))}),t.setUTCDate(t.getUTCDate()+1);let s=0;for(;s<e;){let e=!1;for(let r=0;r<n.length;r++)if(n[r]===t.getUTCDay()){e=!0;break}if(!e){let e=!1;for(let n=0;n<c.length;n++)if(N(t,c[n])){e=!0;break}e||s++}t.setUTCDate(t.getUTCDate()+1)}return m(t)-1},YEAR:t=>g(t).getUTCFullYear(),YEARFRAC:(t,e,n)=>{if((t=g(t))>(e=g(e))){const n=t;t=e,e=n}if(n=a.accept(n,i.NUMBER,0),(n=Math.trunc(n))<0||n>4)throw r.VALUE;let o=t.getUTCDate();const c=t.getUTCMonth()+1,s=t.getUTCFullYear();let u=e.getUTCDate();const l=e.getUTCMonth()+1,f=e.getUTCFullYear();switch(n){case 0:return 31===o&&31===u?(o=30,u=30):31===o?o=30:30===o&&31===u&&(u=30),Math.abs(u+30*l+360*f-(o+30*c+360*s))/360;case 1:if(f-s<2){const n=1900!==(h=s)&&1!==new Date(h,1,29).getMonth()||1900===s?365:366;return v.DAYS(e,t)/n}{const n=f-s+1,r=(new Date(f+1,0,1)-new Date(s,0,1))/1e3/60/60/24/n;return v.DAYS(e,t)/r}case 2:return Math.abs(v.DAYS(e,t)/360);case 3:return Math.abs(v.DAYS(e,t)/365);case 4:return Math.abs(u+30*l+360*f-(o+30*c+360*s))/360}var h}};t.exports=v},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,Address:a}=n(2),{Prefix:c,Postfix:s,Infix:u,Operators:l}=n(4),f=n(5);t.exports=class{constructor(t){this.context=t}columnNameToNumber(t){return a.columnNameToNumber(t)}parseCellAddress(t){const e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:e[0],col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){const e=+t;if(!Number.isInteger(e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}parseColRange(t,e){return t=this.columnNameToNumber(t),e=this.columnNameToNumber(e),{ref:{from:{col:Math.min(t,e),row:null},to:{col:Math.max(t,e),row:null}}}}parseRowRange(t,e){return{ref:{from:{col:null,row:Math.min(t,e)},to:{col:null,row:Math.max(t,e)}}}}applyPrefix(t,e){const{val:n,isArray:r}=this.extractRefValue(e);return this.isFormulaError(n)?n:c.unaryOp(t,n,r)}applyPostfix(t,e){const{val:n,isArray:r}=this.extractRefValue(t);return this.isFormulaError(n)?n:s.percentOp(n,e,r)}applyInfix(t,e,n){const r=this.extractRefValue(t),o=r.val,i=r.isArray,a=this.extractRefValue(n),c=a.val,s=a.isArray;if(this.isFormulaError(o))return o;if(this.isFormulaError(c))return c;if(l.compareOp.includes(e))return u.compareOp(o,e,c,i,s);if(l.concatOp.includes(e))return u.concatOp(o,e,c,i,s);if(l.mathOp.includes(e))return u.mathOp(o,e,c,i,s);throw new Error(`Unrecognized infix: ${e}`)}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let e,n,o,i,a,c;const s=t.shift().ref;if(a=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),n=Math.max(s.from.col,s.to.col),i=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,n=i=s.col}let u;return t.forEach(t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){const c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(s>e||c<o||f>n||l<i||a!==t.sheet)&&(u=r.NULL),e=Math.min(e,c),o=Math.max(o,s),n=Math.min(n,l),i=Math.max(i,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>n||t.col<i||a!==t.sheet)&&(u=r.NULL),e=o=t.row,n=i=t.col}}),u||(c=e===o&&n===i?{ref:{sheet:a,row:e,col:n}}:{ref:{sheet:a,from:{row:o,col:i},to:{row:e,col:n}}},c.ref.sheet||delete c.ref.sheet,c)}applyUnion(t){const e=new f;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];e.add(this.extractRefValue(t[n]).val,t[n])}return e}applyRange(t){let e,n=-1,r=-1,o=1048577,i=16385;return t.forEach(t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(o=1,n=1048576),void 0===t.col&&(i=1,r=16384),t.row>n&&(n=t.row),t.row<o&&(o=t.row),t.col>r&&(r=t.col),t.col<i&&(i=t.col)}),e=n===o&&r===i?{ref:{row:n,col:r}}:{ref:{from:{row:o,col:i},to:{row:n,col:r}}},e}extractRefValue(t){let e=t,n=!1;return Array.isArray(e)&&(n=!0),t.ref?{val:this.context.retrieveRef(t),isArray:n}:{val:e,isArray:n}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new r(t.toUpperCase())}isFormulaError(t){return t instanceof r}}},function(t,e,n){const r=n(12),o=n(6),i=n(1),{FormulaHelpers:a}=n(2),{Parser:c}=n(14),s=n(7),u=n(27);t.exports={DepParser:class{constructor(t){this.logs=[],this.data=[],this.utils=new u(this),t=Object.assign({onVariable:()=>null},t),this.utils=new u(this),this.onVariable=t.onVariable,this.functions=Object.assign({},o,r),this.parser=new c(this,this.utils)}getCell(t){if(null!=t.row){null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(e=>e.from&&e.from.row<=t.row&&e.to.row>=t.row&&e.from.col<=t.col&&e.to.col>=t.col||e.row===t.row&&e.col===t.col&&e.sheet===t.sheet)&&this.data.push(t)}return 0}getRange(t){if(null!=t.from.row){null==t.sheet&&(t.sheet=this.position?this.position.sheet:void 0),-1===this.data.findIndex(e=>e.from&&e.from.row===t.from.row&&e.from.col===t.from.col&&e.to.row===t.to.row&&e.to.col===t.to.col)&&this.data.push(t)}return[[0]]}getVariable(t){const e={ref:this.onVariable(t,this.position.sheet)};return null==e.ref?i.NAME:(a.isCellRef(e)?this.getCell(e.ref):this.getRange(e.ref),0)}retrieveRef(t){return a.isRangeRef(t)?this.getRange(t.ref):a.isCellRef(t)?this.getCell(t.ref):t}callRefFunction(t,e){if(e.forEach(t=>{this.retrieveRef(t)}),t=t.toUpperCase(),this.functions[t]){let n;try{n=this.functions[t](this,...e)}catch(t){if(t instanceof i)return t;throw t}return void 0===n?{value:0,ref:{}}:a.checkFunctionResult(n)}return this.logs.includes(t)||this.logs.push(t),{value:0,ref:{}}}callFunction(t,e){return e.forEach(t=>{null!==t&&this.utils.extractRefValue(t)}),{value:0,ref:{}}}checkFormulaResult(t){this.retrieveRef(t)}parse(t,e){if(0===t.length)throw Error("Input must not be empty.");this.data=[],this.position=e;const n=s.lex(t);this.parser.input=n.tokens;let r=this.parser.formulaWithBinaryOp();if(this.checkFormulaResult(r),this.parser.errors.length>0){const e=this.parser.errors[0],n=e.previousToken.startLine,r=e.previousToken.startColumn+1;let o="\n"+t.split("\n")[n-1]+"\n";o+=Array(r-1).fill(" ").join("")+"^\n",e.message=o+`Error at position ${n}:${r}\n`+e.message,console.error(e.toString())}return this.data}}}},function(t,e,n){const r=n(1),{FormulaHelpers:o,Types:i,Address:a}=n(2),{Prefix:c,Postfix:s,Infix:u,Operators:l}=n(4),f=n(5);t.exports=class{constructor(t){this.context=t}columnNameToNumber(t){return a.columnNameToNumber(t)}parseCellAddress(t){const e=t.match(/([$]?)([A-Za-z]{1,3})([$]?)([1-9][0-9]*)/);return{ref:{address:e[0],col:this.columnNameToNumber(e[2]),row:+e[4]}}}parseRow(t){const e=+t;if(!Number.isInteger(e))throw Error("Row number must be integer.");return{ref:{col:void 0,row:+t}}}parseCol(t){return{ref:{col:this.columnNameToNumber(t),row:void 0}}}applyPrefix(t,e){return this.extractRefValue(e),0}applyPostfix(t,e){return this.extractRefValue(t),0}applyInfix(t,e,n){return this.extractRefValue(t),this.extractRefValue(n),0}applyIntersect(t){if(this.isFormulaError(t[0]))return t[0];if(!t[0].ref)throw Error(`Expecting a reference, but got ${t[0]}.`);let e,n,o,i,a,c;const s=t.shift().ref;if(a=s.sheet,s.from)e=Math.max(s.from.row,s.to.row),o=Math.min(s.from.row,s.to.row),n=Math.max(s.from.col,s.to.col),i=Math.min(s.from.col,s.to.col);else{if(void 0===s.row||void 0===s.col)throw Error("Cannot intersect the whole row or column.");e=o=s.row,n=i=s.col}let u;return t.forEach(t=>{if(this.isFormulaError(t))return t;if(!(t=t.ref))throw Error(`Expecting a reference, but got ${t}.`);if(t.from){const c=Math.max(t.from.row,t.to.row),s=Math.min(t.from.row,t.to.row),l=Math.max(t.from.col,t.to.col),f=Math.min(t.from.col,t.to.col);(s>e||c<o||f>n||l<i||a!==t.sheet)&&(u=r.NULL),e=Math.min(e,c),o=Math.max(o,s),n=Math.min(n,l),i=Math.max(i,f)}else{if(void 0===t.row||void 0===t.col)throw Error("Cannot intersect the whole row or column.");(t.row>e||t.row<o||t.col>n||t.col<i||a!==t.sheet)&&(u=r.NULL),e=o=t.row,n=i=t.col}}),u||(c=e===o&&n===i?{ref:{sheet:a,row:e,col:n}}:{ref:{sheet:a,from:{row:o,col:i},to:{row:e,col:n}}},c.ref.sheet||delete c.ref.sheet,c)}applyUnion(t){const e=new f;for(let n=0;n<t.length;n++){if(this.isFormulaError(t[n]))return t[n];e.add(this.extractRefValue(t[n]).val,t[n])}return e}applyRange(t){let e,n=-1,r=-1,o=1048577,i=16385;return t.forEach(t=>{if(this.isFormulaError(t))return t;"number"==typeof t&&(t=this.parseRow(t)),void 0===(t=t.ref).row&&(o=1,n=1048576),void 0===t.col&&(i=1,r=16384),t.row>n&&(n=t.row),t.row<o&&(o=t.row),t.col>r&&(r=t.col),t.col<i&&(i=t.col)}),e=n===o&&r===i?{ref:{row:n,col:r}}:{ref:{from:{row:o,col:i},to:{row:n,col:r}}},e}extractRefValue(t){const e=Array.isArray(t);return t.ref?{val:this.context.retrieveRef(t),isArray:e}:{val:t,isArray:e}}toArray(t){return t}toNumber(t){return Number(t)}toString(t){return t.substring(1,t.length-1).replace(/""/g,'"')}toBoolean(t){return"TRUE"===t}toError(t){return new r(t.toUpperCase())}isFormulaError(t){return t instanceof r}}}])}));